(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[826],{67:e=>{"use strict";e.exports=require("node:async_hooks")},195:e=>{"use strict";e.exports=require("node:buffer")},803:(e,t,r)=>{"use strict";let n,i,a,s,o,l;r.r(t),r.d(t,{default:()=>lJ});var c,u,d,h,p,f,g,y,m,w,b,v,_,S={};async function k(){if("_ENTRIES"in globalThis&&_ENTRIES.middleware_instrumentation&&_ENTRIES.middleware_instrumentation.register)try{await _ENTRIES.middleware_instrumentation.register()}catch(e){throw e.message=`An error occurred while loading instrumentation hook: ${e.message}`,e}}r.r(S),r.d(S,{config:()=>lK,middleware:()=>lH});let E=null;function T(){return E||(E=k()),E}function x(e){return`The edge runtime does not support Node.js '${e}' module.
Learn More: https://nextjs.org/docs/messages/node-module-in-edge-runtime`}process!==r.g.process&&(process.env=r.g.process.env,r.g.process=process),Object.defineProperty(globalThis,"__import_unsupported",{value:function(e){let t=new Proxy(function(){},{get(t,r){if("then"===r)return{};throw Error(x(e))},construct(){throw Error(x(e))},apply(r,n,i){if("function"==typeof i[0])return i[0](t);throw Error(x(e))}});return new Proxy({},{get:()=>t})},enumerable:!1,configurable:!1}),T();class A extends Error{constructor({page:e}){super(`The middleware "${e}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class P extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class C extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}function O(e){let t={},r=[];if(e)for(let[n,i]of e.entries())"set-cookie"===n.toLowerCase()?(r.push(...function(e){var t,r,n,i,a,s=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,a=!1;l();)if(","===(r=e.charAt(o))){for(n=o,o+=1,l(),i=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(a=!0,o=i,s.push(e.substring(t,n)),t=o):o=n+1}else o+=1;(!a||o>=e.length)&&s.push(e.substring(t,e.length))}return s}(i)),t[n]=1===r.length?r[0]:r):t[n]=i;return t}function R(e){try{return String(new URL(String(e)))}catch(t){throw Error(`URL is malformed "${String(e)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:t})}}let I=Symbol("response"),j=Symbol("passThrough"),U=Symbol("waitUntil");class ${constructor(e){this[U]=[],this[j]=!1}respondWith(e){this[I]||(this[I]=Promise.resolve(e))}passThroughOnException(){this[j]=!0}waitUntil(e){this[U].push(e)}}class N extends ${constructor(e){super(e.request),this.sourcePage=e.page}get request(){throw new A({page:this.sourcePage})}respondWith(){throw new A({page:this.sourcePage})}}function L(e){return e.replace(/\/$/,"")||"/"}function D(e){let t=e.indexOf("#"),r=e.indexOf("?"),n=r>-1&&(t<0||r<t);return n||t>-1?{pathname:e.substring(0,n?r:t),query:n?e.substring(r,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}function M(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:i}=D(e);return""+t+r+n+i}function H(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:i}=D(e);return""+r+t+n+i}function K(e,t){if("string"!=typeof e)return!1;let{pathname:r}=D(e);return r===t||r.startsWith(t+"/")}function W(e,t){let r;let n=e.split("/");return(t||[]).some(t=>!!n[1]&&n[1].toLowerCase()===t.toLowerCase()&&(r=t,n.splice(1,1),e=n.join("/")||"/",!0)),{pathname:e,detectedLocale:r}}let B=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function q(e,t){return new URL(String(e).replace(B,"localhost"),t&&String(t).replace(B,"localhost"))}let J=Symbol("NextURLInternal");class V{constructor(e,t,r){let n,i;"object"==typeof t&&"pathname"in t||"string"==typeof t?(n=t,i=r||{}):i=r||t||{},this[J]={url:q(e,n??i.base),options:i,basePath:""},this.analyze()}analyze(){var e,t,r,n,i;let a=function(e,t){var r,n;let{basePath:i,i18n:a,trailingSlash:s}=null!=(r=t.nextConfig)?r:{},o={pathname:e,trailingSlash:"/"!==e?e.endsWith("/"):s};i&&K(o.pathname,i)&&(o.pathname=function(e,t){if(!K(e,t))return e;let r=e.slice(t.length);return r.startsWith("/")?r:"/"+r}(o.pathname,i),o.basePath=i);let l=o.pathname;if(o.pathname.startsWith("/_next/data/")&&o.pathname.endsWith(".json")){let e=o.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),r=e[0];o.buildId=r,l="index"!==e[1]?"/"+e.slice(1).join("/"):"/",!0===t.parseData&&(o.pathname=l)}if(a){let e=t.i18nProvider?t.i18nProvider.analyze(o.pathname):W(o.pathname,a.locales);o.locale=e.detectedLocale,o.pathname=null!=(n=e.pathname)?n:o.pathname,!e.detectedLocale&&o.buildId&&(e=t.i18nProvider?t.i18nProvider.analyze(l):W(l,a.locales)).detectedLocale&&(o.locale=e.detectedLocale)}return o}(this[J].url.pathname,{nextConfig:this[J].options.nextConfig,parseData:!0,i18nProvider:this[J].options.i18nProvider}),s=function(e,t){let r;if((null==t?void 0:t.host)&&!Array.isArray(t.host))r=t.host.toString().split(":",1)[0];else{if(!e.hostname)return;r=e.hostname}return r.toLowerCase()}(this[J].url,this[J].options.headers);this[J].domainLocale=this[J].options.i18nProvider?this[J].options.i18nProvider.detectDomainLocale(s):function(e,t,r){if(e)for(let a of(r&&(r=r.toLowerCase()),e)){var n,i;if(t===(null==(n=a.domain)?void 0:n.split(":",1)[0].toLowerCase())||r===a.defaultLocale.toLowerCase()||(null==(i=a.locales)?void 0:i.some(e=>e.toLowerCase()===r)))return a}}(null==(t=this[J].options.nextConfig)?void 0:null==(e=t.i18n)?void 0:e.domains,s);let o=(null==(r=this[J].domainLocale)?void 0:r.defaultLocale)||(null==(i=this[J].options.nextConfig)?void 0:null==(n=i.i18n)?void 0:n.defaultLocale);this[J].url.pathname=a.pathname,this[J].defaultLocale=o,this[J].basePath=a.basePath??"",this[J].buildId=a.buildId,this[J].locale=a.locale??o,this[J].trailingSlash=a.trailingSlash}formatPathname(){var e;let t;return t=function(e,t,r,n){if(!t||t===r)return e;let i=e.toLowerCase();return!n&&(K(i,"/api")||K(i,"/"+t.toLowerCase()))?e:M(e,"/"+t)}((e={basePath:this[J].basePath,buildId:this[J].buildId,defaultLocale:this[J].options.forceLocale?void 0:this[J].defaultLocale,locale:this[J].locale,pathname:this[J].url.pathname,trailingSlash:this[J].trailingSlash}).pathname,e.locale,e.buildId?void 0:e.defaultLocale,e.ignorePrefix),(e.buildId||!e.trailingSlash)&&(t=L(t)),e.buildId&&(t=H(M(t,"/_next/data/"+e.buildId),"/"===e.pathname?"index.json":".json")),t=M(t,e.basePath),!e.buildId&&e.trailingSlash?t.endsWith("/")?t:H(t,"/"):L(t)}formatSearch(){return this[J].url.search}get buildId(){return this[J].buildId}set buildId(e){this[J].buildId=e}get locale(){return this[J].locale??""}set locale(e){var t,r;if(!this[J].locale||!(null==(r=this[J].options.nextConfig)?void 0:null==(t=r.i18n)?void 0:t.locales.includes(e)))throw TypeError(`The NextURL configuration includes no locale "${e}"`);this[J].locale=e}get defaultLocale(){return this[J].defaultLocale}get domainLocale(){return this[J].domainLocale}get searchParams(){return this[J].url.searchParams}get host(){return this[J].url.host}set host(e){this[J].url.host=e}get hostname(){return this[J].url.hostname}set hostname(e){this[J].url.hostname=e}get port(){return this[J].url.port}set port(e){this[J].url.port=e}get protocol(){return this[J].url.protocol}set protocol(e){this[J].url.protocol=e}get href(){let e=this.formatPathname(),t=this.formatSearch();return`${this.protocol}//${this.host}${e}${t}${this.hash}`}set href(e){this[J].url=q(e),this.analyze()}get origin(){return this[J].url.origin}get pathname(){return this[J].url.pathname}set pathname(e){this[J].url.pathname=e}get hash(){return this[J].url.hash}set hash(e){this[J].url.hash=e}get search(){return this[J].url.search}set search(e){this[J].url.search=e}get password(){return this[J].url.password}set password(e){this[J].url.password=e}get username(){return this[J].url.username}set username(e){this[J].url.username=e}get basePath(){return this[J].basePath}set basePath(e){this[J].basePath=e.startsWith("/")?e:`/${e}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new V(String(this),this[J].options)}}var F=r(283);let z=Symbol("internal request");class G extends Request{constructor(e,t={}){let r="string"!=typeof e&&"url"in e?e.url:String(e);R(r),e instanceof Request?super(e,t):super(r,t);let n=new V(r,{headers:O(this.headers),nextConfig:t.nextConfig});this[z]={cookies:new F.RequestCookies(this.headers),geo:t.geo||{},ip:t.ip,nextUrl:n,url:n.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,geo:this.geo,ip:this.ip,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[z].cookies}get geo(){return this[z].geo}get ip(){return this[z].ip}get nextUrl(){return this[z].nextUrl}get page(){throw new P}get ua(){throw new C}get url(){return this[z].url}}let X=Symbol("internal response"),Y=new Set([301,302,303,307,308]);function Z(e,t){var r;if(null==e?void 0:null==(r=e.request)?void 0:r.headers){if(!(e.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let r=[];for(let[n,i]of e.request.headers)t.set("x-middleware-request-"+n,i),r.push(n);t.set("x-middleware-override-headers",r.join(","))}}class Q extends Response{constructor(e,t={}){super(e,t),this[X]={cookies:new F.ResponseCookies(this.headers),url:t.url?new V(t.url,{headers:O(this.headers),nextConfig:t.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[X].cookies}static json(e,t){let r=Response.json(e,t);return new Q(r.body,r)}static redirect(e,t){let r="number"==typeof t?t:(null==t?void 0:t.status)??307;if(!Y.has(r))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let n="object"==typeof t?t:{},i=new Headers(null==n?void 0:n.headers);return i.set("Location",R(e)),new Q(null,{...n,headers:i,status:r})}static rewrite(e,t){let r=new Headers(null==t?void 0:t.headers);return r.set("x-middleware-rewrite",R(e)),Z(t,r),new Q(null,{...t,headers:r})}static next(e){let t=new Headers(null==e?void 0:e.headers);return t.set("x-middleware-next","1"),Z(e,t),new Q(null,{...e,headers:t})}}function ee(e,t){let r="string"==typeof t?new URL(t):t,n=new URL(e,t),i=r.protocol+"//"+r.host;return n.protocol+"//"+n.host===i?n.toString().replace(i,""):n.toString()}let et=[["RSC"],["Next-Router-State-Tree"],["Next-Router-Prefetch"]];r(253);let er={client:"client",server:"server",edgeServer:"edge-server"};er.client,er.server,er.edgeServer,Symbol("polyfills");let en=["__nextFallback","__nextLocale","__nextInferredLocaleFromDefault","__nextDefaultLocale","__nextIsNotFound","_rsc"],ei=["__nextDataReq"],ea="nxtP",es={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",api:"api",middleware:"middleware",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",appMetadataRoute:"app-metadata-route",appRouteHandler:"app-route-handler"};({...es,GROUP:{server:[es.reactServerComponents,es.actionBrowser,es.appMetadataRoute,es.appRouteHandler],nonClientServerTarget:[es.middleware,es.api],app:[es.reactServerComponents,es.actionBrowser,es.appMetadataRoute,es.appRouteHandler,es.serverSideRendering,es.appPagesBrowser,es.shared]}});class eo{static get(e,t,r){let n=Reflect.get(e,t,r);return"function"==typeof n?n.bind(e):n}static set(e,t,r,n){return Reflect.set(e,t,r,n)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}class el extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new el}}class ec extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,n){if("symbol"==typeof r)return eo.get(t,r,n);let i=r.toLowerCase(),a=Object.keys(e).find(e=>e.toLowerCase()===i);if(void 0!==a)return eo.get(t,a,n)},set(t,r,n,i){if("symbol"==typeof r)return eo.set(t,r,n,i);let a=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===a);return eo.set(t,s??r,n,i)},has(t,r){if("symbol"==typeof r)return eo.has(t,r);let n=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0!==i&&eo.has(t,i)},deleteProperty(t,r){if("symbol"==typeof r)return eo.deleteProperty(t,r);let n=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0===i||eo.deleteProperty(t,i)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return el.callable;default:return eo.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new ec(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,n]of this.entries())e.call(t,n,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}class eu extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new eu}}class ed{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return eu.callable;default:return eo.get(e,t,r)}}})}}let eh=Symbol.for("next.mutated.cookies");class ep{static wrap(e,t){let r=new F.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let n=[],i=new Set,a=()=>{var e;let a=null==fetch.__nextGetStaticStore?void 0:null==(e=fetch.__nextGetStaticStore.call(fetch))?void 0:e.getStore();if(a&&(a.pathWasRevalidated=!0),n=r.getAll().filter(e=>i.has(e.name)),t){let e=[];for(let t of n){let r=new F.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}};return new Proxy(r,{get(e,t,r){switch(t){case eh:return n;case"delete":return function(...t){i.add("string"==typeof t[0]?t[0]:t[0].name);try{e.delete(...t)}finally{a()}};case"set":return function(...t){i.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t)}finally{a()}};default:return eo.get(e,t,r)}}})}}let ef="__prerender_bypass";Symbol("__next_preview_data"),Symbol(ef);class eg{constructor(e,t,r,n){var i;let a=e&&function(e,t){let r=ec.from(e.headers);return{isOnDemandRevalidate:r.get("x-prerender-revalidate")===t.previewModeId,revalidateOnlyGenerated:r.has("x-prerender-revalidate-if-generated")}}(t,e).isOnDemandRevalidate,s=null==(i=r.get(ef))?void 0:i.value;this.isEnabled=!!(!a&&s&&e&&s===e.previewModeId),this._previewModeId=null==e?void 0:e.previewModeId,this._mutableCookies=n}enable(){if(!this._previewModeId)throw Error("Invariant: previewProps missing previewModeId this should never happen");this._mutableCookies.set({name:ef,value:this._previewModeId,httpOnly:!0,sameSite:"none",secure:!0,path:"/"})}disable(){this._mutableCookies.set({name:ef,value:"",httpOnly:!0,sameSite:"none",secure:!0,path:"/",expires:new Date(0)})}}let ey={wrap(e,{req:t,res:r,renderOpts:n},i){let a;function s(e){r&&r.setHeader("Set-Cookie",e)}n&&"previewProps"in n&&(a=n.previewProps);let o={},l={get headers(){return o.headers||(o.headers=function(e){let t=ec.from(e);for(let e of et)t.delete(e.toString().toLowerCase());return ec.seal(t)}(t.headers)),o.headers},get cookies(){return o.cookies||(o.cookies=function(e){let t=new F.RequestCookies(ec.from(e));return ed.seal(t)}(t.headers)),o.cookies},get mutableCookies(){return o.mutableCookies||(o.mutableCookies=function(e,t){let r=new F.RequestCookies(ec.from(e));return ep.wrap(r,t)}(t.headers,(null==n?void 0:n.onUpdateCookies)||(r?s:void 0))),o.mutableCookies},get draftMode(){return o.draftMode||(o.draftMode=new eg(a,t,this.cookies,this.mutableCookies)),o.draftMode}};return e.run(l,i,l)}};var em=r(151);let ew=(0,em.P)();!function(e){e.handleRequest="BaseServer.handleRequest",e.run="BaseServer.run",e.pipe="BaseServer.pipe",e.getStaticHTML="BaseServer.getStaticHTML",e.render="BaseServer.render",e.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",e.renderToResponse="BaseServer.renderToResponse",e.renderToHTML="BaseServer.renderToHTML",e.renderError="BaseServer.renderError",e.renderErrorToResponse="BaseServer.renderErrorToResponse",e.renderErrorToHTML="BaseServer.renderErrorToHTML",e.render404="BaseServer.render404"}(nS||(nS={})),function(e){e.loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",e.loadComponents="LoadComponents.loadComponents"}(nk||(nk={})),function(e){e.getRequestHandler="NextServer.getRequestHandler",e.getServer="NextServer.getServer",e.getServerRequestHandler="NextServer.getServerRequestHandler",e.createServer="createServer.createServer"}(nE||(nE={})),function(e){e.compression="NextNodeServer.compression",e.getBuildId="NextNodeServer.getBuildId",e.getLayoutOrPageModule="NextNodeServer.getLayoutOrPageModule",e.generateStaticRoutes="NextNodeServer.generateStaticRoutes",e.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",e.generatePublicRoutes="NextNodeServer.generatePublicRoutes",e.generateImageRoutes="NextNodeServer.generateImageRoutes.route",e.sendRenderResult="NextNodeServer.sendRenderResult",e.proxyRequest="NextNodeServer.proxyRequest",e.runApi="NextNodeServer.runApi",e.render="NextNodeServer.render",e.renderHTML="NextNodeServer.renderHTML",e.imageOptimizer="NextNodeServer.imageOptimizer",e.getPagePath="NextNodeServer.getPagePath",e.getRoutesManifest="NextNodeServer.getRoutesManifest",e.findPageComponents="NextNodeServer.findPageComponents",e.getFontManifest="NextNodeServer.getFontManifest",e.getServerComponentManifest="NextNodeServer.getServerComponentManifest",e.getRequestHandler="NextNodeServer.getRequestHandler",e.renderToHTML="NextNodeServer.renderToHTML",e.renderError="NextNodeServer.renderError",e.renderErrorToHTML="NextNodeServer.renderErrorToHTML",e.render404="NextNodeServer.render404",e.route="route",e.onProxyReq="onProxyReq",e.apiResolver="apiResolver",e.internalFetch="internalFetch"}(nT||(nT={})),(nx||(nx={})).startServer="startServer.startServer",function(e){e.getServerSideProps="Render.getServerSideProps",e.getStaticProps="Render.getStaticProps",e.renderToString="Render.renderToString",e.renderDocument="Render.renderDocument",e.createBodyResult="Render.createBodyResult"}(nA||(nA={})),function(e){e.renderToString="AppRender.renderToString",e.renderToReadableStream="AppRender.renderToReadableStream",e.getBodyResult="AppRender.getBodyResult",e.fetch="AppRender.fetch"}(nP||(nP={})),(nC||(nC={})).executeRoute="Router.executeRoute",(nO||(nO={})).runHandler="Node.runHandler",(nR||(nR={})).runHandler="AppRouteRouteHandlers.runHandler",function(e){e.generateMetadata="ResolveMetadata.generateMetadata",e.generateViewport="ResolveMetadata.generateViewport"}(nI||(nI={}));let eb=["BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport","NextNodeServer.findPageComponents","NextNodeServer.getLayoutOrPageModule"],{context:ev,propagation:e_,trace:eS,SpanStatusCode:ek,SpanKind:eE,ROOT_CONTEXT:eT}=n=r(38),ex=e=>null!==e&&"object"==typeof e&&"function"==typeof e.then,eA=(e,t)=>{(null==t?void 0:t.bubble)===!0?e.setAttribute("next.bubble",!0):(t&&e.recordException(t),e.setStatus({code:ek.ERROR,message:null==t?void 0:t.message})),e.end()},eP=new Map,eC=n.createContextKey("next.rootSpanId"),eO=0,eR=()=>eO++;class eI{getTracerInstance(){return eS.getTracer("next.js","0.0.1")}getContext(){return ev}getActiveScopeSpan(){return eS.getSpan(null==ev?void 0:ev.active())}withPropagatedContext(e,t,r){let n=ev.active();if(eS.getSpanContext(n))return t();let i=e_.extract(n,e,r);return ev.with(i,t)}trace(...e){var t;let[r,n,i]=e,{fn:a,options:s}="function"==typeof n?{fn:n,options:{}}:{fn:i,options:{...n}};if(!eb.includes(r)&&"1"!==process.env.NEXT_OTEL_VERBOSE||s.hideSpan)return a();let o=s.spanName??r,l=this.getSpanContext((null==s?void 0:s.parentSpan)??this.getActiveScopeSpan()),c=!1;l?(null==(t=eS.getSpanContext(l))?void 0:t.isRemote)&&(c=!0):(l=eT,c=!0);let u=eR();return s.attributes={"next.span_name":o,"next.span_type":r,...s.attributes},ev.with(l.setValue(eC,u),()=>this.getTracerInstance().startActiveSpan(o,s,e=>{let t=()=>{eP.delete(u)};c&&eP.set(u,new Map(Object.entries(s.attributes??{})));try{if(a.length>1)return a(e,t=>eA(e,t));let r=a(e);if(ex(r))return r.then(t=>(e.end(),t)).catch(t=>{throw eA(e,t),t}).finally(t);return e.end(),t(),r}catch(r){throw eA(e,r),t(),r}}))}wrap(...e){let t=this,[r,n,i]=3===e.length?e:[e[0],{},e[1]];return eb.includes(r)||"1"===process.env.NEXT_OTEL_VERBOSE?function(){let e=n;"function"==typeof e&&"function"==typeof i&&(e=e.apply(this,arguments));let a=arguments.length-1,s=arguments[a];if("function"!=typeof s)return t.trace(r,e,()=>i.apply(this,arguments));{let n=t.getContext().bind(ev.active(),s);return t.trace(r,e,(e,t)=>(arguments[a]=function(e){return null==t||t(e),n.apply(this,arguments)},i.apply(this,arguments)))}}:i}startSpan(...e){let[t,r]=e,n=this.getSpanContext((null==r?void 0:r.parentSpan)??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(t,r,n)}getSpanContext(e){return e?eS.setSpan(ev.active(),e):void 0}getRootSpanAttributes(){let e=ev.active().getValue(eC);return eP.get(e)}}let ej=(()=>{let e=new eI;return()=>e})();class eU extends G{constructor(e){super(e.input,e.init),this.sourcePage=e.page}get request(){throw new A({page:this.sourcePage})}respondWith(){throw new A({page:this.sourcePage})}waitUntil(){throw new A({page:this.sourcePage})}}let e$={keys:e=>Array.from(e.keys()),get:(e,t)=>e.get(t)??void 0},eN=(e,t)=>ej().withPropagatedContext(e.headers,t,e$),eL=!1;async function eD(e){let t,n;!function(){if(!eL&&(eL=!0,"true"===process.env.NEXT_PRIVATE_TEST_PROXY)){let{interceptTestApis:e,wrapRequestHandler:t}=r(895);e(),eN=t(eN)}}(),await T();let i=void 0!==self.__BUILD_MANIFEST,a="string"==typeof self.__PRERENDER_MANIFEST?JSON.parse(self.__PRERENDER_MANIFEST):void 0;e.request.url=e.request.url.replace(/\.rsc($|\?)/,"$1");let s=new V(e.request.url,{headers:e.request.headers,nextConfig:e.request.nextConfig});for(let e of[...s.searchParams.keys()]){let t=s.searchParams.getAll(e);if(e!==ea&&e.startsWith(ea)){let r=e.substring(ea.length);for(let e of(s.searchParams.delete(r),t))s.searchParams.append(r,e);s.searchParams.delete(e)}}let o=s.buildId;s.buildId="";let l=e.request.headers["x-nextjs-data"];l&&"/index"===s.pathname&&(s.pathname="/");let c=function(e){let t=new Headers;for(let[r,n]of Object.entries(e))for(let e of Array.isArray(n)?n:[n])void 0!==e&&("number"==typeof e&&(e=e.toString()),t.append(r,e));return t}(e.request.headers),u=new Map;if(!i)for(let e of et){let t=e.toString().toLowerCase();c.get(t)&&(u.set(t,c.get(t)),c.delete(t))}let d=new eU({page:e.page,input:(function(e,t){let r="string"==typeof e,n=r?new URL(e):e;for(let e of en)n.searchParams.delete(e);if(t)for(let e of ei)n.searchParams.delete(e);return r?n.toString():n})(s,!0).toString(),init:{body:e.request.body,geo:e.request.geo,headers:c,ip:e.request.ip,method:e.request.method,nextConfig:e.request.nextConfig,signal:e.request.signal}});l&&Object.defineProperty(d,"__isData",{enumerable:!1,value:!0}),!globalThis.__incrementalCache&&e.IncrementalCache&&(globalThis.__incrementalCache=new e.IncrementalCache({appDir:!0,fetchCache:!0,minimalMode:!0,fetchCacheKeyPrefix:void 0,dev:!1,requestHeaders:e.request.headers,requestProtocol:"https",getPrerenderManifest:()=>({version:-1,routes:{},dynamicRoutes:{},notFoundRoutes:[],preview:{previewModeId:"development-id"}})}));let h=new N({request:d,page:e.page});if((t=await eN(d,()=>"/middleware"===e.page||"/src/middleware"===e.page?ey.wrap(ew,{req:d,renderOpts:{onUpdateCookies:e=>{n=e},previewProps:(null==a?void 0:a.preview)||{previewModeId:"development-id",previewModeEncryptionKey:"",previewModeSigningKey:""}}},()=>e.handler(d,h)):e.handler(d,h)))&&!(t instanceof Response))throw TypeError("Expected an instance of Response to be returned");t&&n&&t.headers.set("set-cookie",n);let p=null==t?void 0:t.headers.get("x-middleware-rewrite");if(t&&p){let r=new V(p,{forceLocale:!0,headers:e.request.headers,nextConfig:e.request.nextConfig});r.host===d.nextUrl.host&&(r.buildId=o||r.buildId,t.headers.set("x-middleware-rewrite",String(r)));let n=ee(String(r),String(s));l&&t.headers.set("x-nextjs-rewrite",n)}let f=null==t?void 0:t.headers.get("Location");if(t&&f&&!i){let r=new V(f,{forceLocale:!1,headers:e.request.headers,nextConfig:e.request.nextConfig});t=new Response(t.body,t),r.host===d.nextUrl.host&&(r.buildId=o||r.buildId,t.headers.set("Location",String(r))),l&&(t.headers.delete("Location"),t.headers.set("x-nextjs-redirect",ee(String(r),String(s))))}let g=t||Q.next(),y=g.headers.get("x-middleware-override-headers"),m=[];if(y){for(let[e,t]of u)g.headers.set(`x-middleware-request-${e}`,t),m.push(e);m.length>0&&g.headers.set("x-middleware-override-headers",y+","+m.join(","))}return{response:g,waitUntil:Promise.all(h[U]),fetchMetrics:d.fetchMetrics}}var eM=function(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},eH=function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};function eK(e){let t=e?"__Secure-":"";return{sessionToken:{name:`${t}authjs.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},callbackUrl:{name:`${t}authjs.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},csrfToken:{name:`${e?"__Host-":""}authjs.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},pkceCodeVerifier:{name:`${t}authjs.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},state:{name:`${t}authjs.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},nonce:{name:`${t}authjs.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},webauthnChallenge:{name:`${t}authjs.challenge`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}}}}class eW{constructor(e,t,r){if(nj.add(this),nU.set(this,{}),n$.set(this,void 0),nN.set(this,void 0),eM(this,nN,r,"f"),eM(this,n$,e,"f"),!t)return;let{name:n}=e;for(let[e,r]of Object.entries(t))e.startsWith(n)&&r&&(eH(this,nU,"f")[e]=r)}get value(){return Object.keys(eH(this,nU,"f")).sort((e,t)=>parseInt(e.split(".").pop()||"0")-parseInt(t.split(".").pop()||"0")).map(e=>eH(this,nU,"f")[e]).join("")}chunk(e,t){let r=eH(this,nj,"m",nD).call(this);for(let n of eH(this,nj,"m",nL).call(this,{name:eH(this,n$,"f").name,value:e,options:{...eH(this,n$,"f").options,...t}}))r[n.name]=n;return Object.values(r)}clean(){return Object.values(eH(this,nj,"m",nD).call(this))}}nU=new WeakMap,n$=new WeakMap,nN=new WeakMap,nj=new WeakSet,nL=function(e){let t=Math.ceil(e.value.length/3936);if(1===t)return eH(this,nU,"f")[e.name]=e.value,[e];let r=[];for(let n=0;n<t;n++){let t=`${e.name}.${n}`,i=e.value.substr(3936*n,3936);r.push({...e,name:t,value:i}),eH(this,nU,"f")[t]=i}return eH(this,nN,"f").debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:160,valueSize:e.value.length,chunks:r.map(e=>e.value.length+160)}),r},nD=function(){let e={};for(let t in eH(this,nU,"f"))delete eH(this,nU,"f")?.[t],e[t]={name:t,value:"",options:{...eH(this,n$,"f").options,maxAge:0}};return e};class eB extends Error{constructor(e,t){e instanceof Error?super(void 0,{cause:{err:e,...e.cause,...t}}):"string"==typeof e?(t instanceof Error&&(t={err:t,...t.cause}),super(e,t)):super(void 0,e),this.name=this.constructor.name,this.type=this.constructor.type??"AuthError",this.kind=this.constructor.kind??"error",Error.captureStackTrace?.(this,this.constructor);let r=`https://errors.authjs.dev#${this.type.toLowerCase()}`;this.message+=`${this.message?". ":""}Read more at ${r}`}}class eq extends eB{}eq.kind="signIn";class eJ extends eB{}eJ.type="AdapterError";class eV extends eB{}eV.type="AccessDenied";class eF extends eB{}eF.type="CallbackRouteError";class ez extends eB{}ez.type="ErrorPageLoop";class eG extends eB{}eG.type="EventError";class eX extends eB{}eX.type="InvalidCallbackUrl";class eY extends eq{constructor(){super(...arguments),this.code="credentials"}}eY.type="CredentialsSignin";class eZ extends eB{}eZ.type="InvalidEndpoints";class eQ extends eB{}eQ.type="InvalidCheck";class e0 extends eB{}e0.type="JWTSessionError";class e1 extends eB{}e1.type="MissingAdapter";class e2 extends eB{}e2.type="MissingAdapterMethods";class e3 extends eB{}e3.type="MissingAuthorize";class e5 extends eB{}e5.type="MissingSecret";class e4 extends eq{}e4.type="OAuthAccountNotLinked";class e6 extends eq{}e6.type="OAuthCallbackError";class e8 extends eB{}e8.type="OAuthProfileParseError";class e9 extends eB{}e9.type="SessionTokenError";class e7 extends eq{}e7.type="OAuthSignInError";class te extends eq{}te.type="EmailSignInError";class tt extends eB{}tt.type="SignOutError";class tr extends eB{}tr.type="UnknownAction";class tn extends eB{}tn.type="UnsupportedStrategy";class ti extends eB{}ti.type="InvalidProvider";class ta extends eB{}ta.type="UntrustedHost";class ts extends eB{}ts.type="Verification";class to extends eq{}to.type="MissingCSRF";let tl=new Set(["CredentialsSignin","OAuthAccountNotLinked","OAuthCallbackError","AccessDenied","Verification","MissingCSRF","AccountNotLinked","WebAuthnVerificationError"]);class tc extends eB{}tc.type="DuplicateConditionalUI";class tu extends eB{}tu.type="MissingWebAuthnAutocomplete";class td extends eB{}td.type="WebAuthnVerificationError";class th extends eq{}th.type="AccountNotLinked";class tp extends eB{}tp.type="ExperimentalFeatureNotEnabled";let tf=!1;function tg(e,t){try{return/^https?:/.test(new URL(e,e.startsWith("/")?t:void 0).protocol)}catch{return!1}}let ty=!1,tm=!1,tw=!1,tb=["createVerificationToken","useVerificationToken","getUserByEmail"],tv=["createUser","getUser","getUserByEmail","getUserByAccount","updateUser","linkAccount","createSession","getSessionAndUser","updateSession","deleteSession"],t_=["createUser","getUser","linkAccount","getAccount","getAuthenticator","createAuthenticator","listAuthenticatorsByUserId","updateAuthenticatorCounter"],tS=()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;throw Error("unable to locate global object")},tk=async(e,t,r,n,i)=>{let{crypto:{subtle:a}}=tS();return new Uint8Array(await a.deriveBits({name:"HKDF",hash:`SHA-${e.substr(3)}`,salt:r,info:n},await a.importKey("raw",t,"HKDF",!1,["deriveBits"]),i<<3))};function tE(e,t){if("string"==typeof e)return new TextEncoder().encode(e);if(!(e instanceof Uint8Array))throw TypeError(`"${t}"" must be an instance of Uint8Array or a string`);return e}async function tT(e,t,r,n,i){return tk(function(e){switch(e){case"sha256":case"sha384":case"sha512":case"sha1":return e;default:throw TypeError('unsupported "digest" value')}}(e),function(e){let t=tE(e,"ikm");if(!t.byteLength)throw TypeError('"ikm" must be at least one byte in length');return t}(t),tE(r,"salt"),function(e){let t=tE(e,"info");if(t.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return t}(n),function(e,t){if("number"!=typeof e||!Number.isInteger(e)||e<1)throw TypeError('"keylen" must be a positive integer');if(e>255*(parseInt(t.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return e}(i,e))}let tx=crypto,tA=e=>e instanceof CryptoKey,tP=async(e,t)=>{let r=`SHA-${e.slice(-3)}`;return new Uint8Array(await tx.subtle.digest(r,t))},tC=new TextEncoder,tO=new TextDecoder;function tR(...e){let t=e.reduce((e,{length:t})=>e+t,0),r=new Uint8Array(t),n=0;for(let t of e)r.set(t,n),n+=t.length;return r}function tI(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function tj(e){let t=new Uint8Array(8);return tI(t,Math.floor(e/4294967296),0),tI(t,e%4294967296,4),t}function tU(e){let t=new Uint8Array(4);return tI(t,e),t}function t$(e){return tR(tU(e.length),e)}async function tN(e,t,r){let n=Math.ceil((t>>3)/32),i=new Uint8Array(32*n);for(let t=0;t<n;t++){let n=new Uint8Array(4+e.length+r.length);n.set(tU(t+1)),n.set(e,4),n.set(r,4+e.length),i.set(await tP("sha256",n),32*t)}return i.slice(0,t>>3)}let tL=e=>{let t=e;"string"==typeof t&&(t=tC.encode(t));let r=[];for(let e=0;e<t.length;e+=32768)r.push(String.fromCharCode.apply(null,t.subarray(e,e+32768)));return btoa(r.join(""))},tD=e=>tL(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),tM=e=>{let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r},tH=e=>{let t=e;t instanceof Uint8Array&&(t=tO.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return tM(t)}catch{throw TypeError("The input to be decoded is not correctly encoded.")}};class tK extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class tW extends tK{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(e,t,r="unspecified",n="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=r,this.reason=n,this.payload=t}}class tB extends tK{static get code(){return"ERR_JWT_EXPIRED"}constructor(e,t,r="unspecified",n="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=r,this.reason=n,this.payload=t}}class tq extends tK{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}}class tJ extends tK{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class tV extends tK{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}}class tF extends tK{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}}class tz extends tK{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}class tG extends tK{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}}function tX(e){if(!("object"==typeof e&&null!==e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}Symbol.asyncIterator;let tY=(e,t)=>{if("string"!=typeof e||!e)throw new tG(`${t} missing or invalid`)};async function tZ(e,t){let r;if(!tX(e))throw TypeError("JWK must be an object");if(t??(t="sha256"),"sha256"!==t&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(e.kty){case"EC":tY(e.crv,'"crv" (Curve) Parameter'),tY(e.x,'"x" (X Coordinate) Parameter'),tY(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":tY(e.crv,'"crv" (Subtype of Key Pair) Parameter'),tY(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":tY(e.e,'"e" (Exponent) Parameter'),tY(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":tY(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new tJ('"kty" (Key Type) Parameter missing or unsupported')}let n=tC.encode(JSON.stringify(r));return tD(await tP(t,n))}let tQ=tx.getRandomValues.bind(tx);function t0(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new tJ(`Unsupported JWE Algorithm: ${e}`)}}let t1=e=>tQ(new Uint8Array(t0(e)>>3)),t2=(e,t)=>{if(t.length<<3!==t0(e))throw new tF("Invalid Initialization Vector length")},t3=(e,t)=>{let r=e.byteLength<<3;if(r!==t)throw new tF(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)};function t5(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function t4(e,t){return e.name===t}function t6(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!t4(e.algorithm,"AES-GCM"))throw t5("AES-GCM");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw t5(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!t4(e.algorithm,"AES-KW"))throw t5("AES-KW");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw t5(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw t5("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!t4(e.algorithm,"PBKDF2"))throw t5("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!t4(e.algorithm,"RSA-OAEP"))throw t5("RSA-OAEP");let r=parseInt(t.slice(9),10)||1;if(parseInt(e.algorithm.hash.name.slice(4),10)!==r)throw t5(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}!function(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}}(e,r)}function t8(e,t,...r){if(r.length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}let t9=(e,...t)=>t8("Key must be ",e,...t);function t7(e,t,...r){return t8(`Key for the ${e} algorithm must be `,t,...r)}let re=e=>!!tA(e)||e?.[Symbol.toStringTag]==="KeyObject",rt=["CryptoKey"];async function rr(e,t,r,n,i){if(!(r instanceof Uint8Array))throw TypeError(t9(r,"Uint8Array"));let a=parseInt(e.slice(1,4),10),s=await tx.subtle.importKey("raw",r.subarray(a>>3),"AES-CBC",!1,["encrypt"]),o=await tx.subtle.importKey("raw",r.subarray(0,a>>3),{hash:`SHA-${a<<1}`,name:"HMAC"},!1,["sign"]),l=new Uint8Array(await tx.subtle.encrypt({iv:n,name:"AES-CBC"},s,t)),c=tR(i,n,l,tj(i.length<<3));return{ciphertext:l,tag:new Uint8Array((await tx.subtle.sign("HMAC",o,c)).slice(0,a>>3)),iv:n}}async function rn(e,t,r,n,i){let a;r instanceof Uint8Array?a=await tx.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(t6(r,e,"encrypt"),a=r);let s=new Uint8Array(await tx.subtle.encrypt({additionalData:i,iv:n,name:"AES-GCM",tagLength:128},a,t)),o=s.slice(-16);return{ciphertext:s.slice(0,-16),tag:o,iv:n}}let ri=async(e,t,r,n,i)=>{if(!tA(r)&&!(r instanceof Uint8Array))throw TypeError(t9(r,...rt,"Uint8Array"));switch(n?t2(e,n):n=t1(e),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&t3(r,parseInt(e.slice(-3),10)),rr(e,t,r,n,i);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&t3(r,parseInt(e.slice(1,4),10)),rn(e,t,r,n,i);default:throw new tJ("Unsupported JWE Content Encryption Algorithm")}},ra=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]];function rs(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function ro(e,t,r){if(tA(e))return t6(e,t,r),e;if(e instanceof Uint8Array)return tx.subtle.importKey("raw",e,"AES-KW",!0,[r]);throw TypeError(t9(e,...rt,"Uint8Array"))}let rl=async(e,t,r)=>{let n=await ro(t,e,"wrapKey");rs(n,e);let i=await tx.subtle.importKey("raw",r,...ra);return new Uint8Array(await tx.subtle.wrapKey("raw",i,n,"AES-KW"))},rc=async(e,t,r)=>{let n=await ro(t,e,"unwrapKey");rs(n,e);let i=await tx.subtle.unwrapKey("raw",r,n,"AES-KW",...ra);return new Uint8Array(await tx.subtle.exportKey("raw",i))};async function ru(e,t,r,n,i=new Uint8Array(0),a=new Uint8Array(0)){let s;if(!tA(e))throw TypeError(t9(e,...rt));if(t6(e,"ECDH"),!tA(t))throw TypeError(t9(t,...rt));t6(t,"ECDH","deriveBits");let o=tR(t$(tC.encode(r)),t$(i),t$(a),tU(n));return s="X25519"===e.algorithm.name?256:"X448"===e.algorithm.name?448:Math.ceil(parseInt(e.algorithm.namedCurve.substr(-3),10)/8)<<3,tN(new Uint8Array(await tx.subtle.deriveBits({name:e.algorithm.name,public:e},t,s)),n,o)}async function rd(e){if(!tA(e))throw TypeError(t9(e,...rt));return tx.subtle.generateKey(e.algorithm,!0,["deriveBits"])}function rh(e){if(!tA(e))throw TypeError(t9(e,...rt));return["P-256","P-384","P-521"].includes(e.algorithm.namedCurve)||"X25519"===e.algorithm.name||"X448"===e.algorithm.name}async function rp(e,t,r,n){!function(e){if(!(e instanceof Uint8Array)||e.length<8)throw new tF("PBES2 Salt Input must be 8 or more octets")}(e);let i=tR(tC.encode(t),new Uint8Array([0]),e),a=parseInt(t.slice(13,16),10),s={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:i},o=await function(e,t){if(e instanceof Uint8Array)return tx.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]);if(tA(e))return t6(e,t,"deriveBits","deriveKey"),e;throw TypeError(t9(e,...rt,"Uint8Array"))}(n,t);if(o.usages.includes("deriveBits"))return new Uint8Array(await tx.subtle.deriveBits(s,o,a));if(o.usages.includes("deriveKey"))return tx.subtle.deriveKey(s,o,{length:a,name:"AES-KW"},!1,["wrapKey","unwrapKey"]);throw TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"')}let rf=async(e,t,r,n=2048,i=tQ(new Uint8Array(16)))=>{let a=await rp(i,e,n,t);return{encryptedKey:await rl(e.slice(-6),a,r),p2c:n,p2s:tD(i)}},rg=async(e,t,r,n,i)=>{let a=await rp(i,e,n,t);return rc(e.slice(-6),a,r)};function ry(e){switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new tJ(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}let rm=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}},rw=async(e,t,r)=>{if(!tA(t))throw TypeError(t9(t,...rt));if(t6(t,e,"encrypt","wrapKey"),rm(e,t),t.usages.includes("encrypt"))return new Uint8Array(await tx.subtle.encrypt(ry(e),t,r));if(t.usages.includes("wrapKey")){let n=await tx.subtle.importKey("raw",r,...ra);return new Uint8Array(await tx.subtle.wrapKey("raw",n,t,ry(e)))}throw TypeError('RSA-OAEP key "usages" must include "encrypt" or "wrapKey" for this operation')},rb=async(e,t,r)=>{if(!tA(t))throw TypeError(t9(t,...rt));if(t6(t,e,"decrypt","unwrapKey"),rm(e,t),t.usages.includes("decrypt"))return new Uint8Array(await tx.subtle.decrypt(ry(e),t,r));if(t.usages.includes("unwrapKey")){let n=await tx.subtle.unwrapKey("raw",r,t,ry(e),...ra);return new Uint8Array(await tx.subtle.exportKey("raw",n))}throw TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation')},rv=async e=>{if(!e.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:t,keyUsages:r}=function(e){let t,r;switch(e.kty){case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new tJ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new tJ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new tJ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new tJ('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e),n=[t,e.ext??!1,e.key_ops??r],i={...e};return delete i.alg,delete i.use,tx.subtle.importKey("jwk",i,...n)},r_=e=>tH(e),rS=e=>e?.[Symbol.toStringTag]==="KeyObject",rk=async(e,t,r,n)=>{let i=e.get(t);if(i?.[n])return i[n];let a=await rv({...r,alg:n});return i?i[n]=a:e.set(t,{[n]:a}),a},rE={normalizePublicKey:(e,t)=>{if(rS(e)){let r=e.export({format:"jwk"});return(delete r.d,delete r.dp,delete r.dq,delete r.p,delete r.q,delete r.qi,r.k)?r_(r.k):(a||(a=new WeakMap),rk(a,e,r,t))}return e},normalizePrivateKey:(e,t)=>{if(rS(e)){let r=e.export({format:"jwk"});return r.k?r_(r.k):(i||(i=new WeakMap),rk(i,e,r,t))}return e}};function rT(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new tJ(`Unsupported JWE Algorithm: ${e}`)}}let rx=e=>tQ(new Uint8Array(rT(e)>>3)),rA=async e=>{if(e instanceof Uint8Array)return{kty:"oct",k:tD(e)};if(!tA(e))throw TypeError(t9(e,...rt,"Uint8Array"));if(!e.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:n,use:i,...a}=await tx.subtle.exportKey("jwk",e);return a};async function rP(e){return rA(e)}let rC=e=>e?.[Symbol.toStringTag],rO=(e,t)=>{if(!(t instanceof Uint8Array)){if(!re(t))throw TypeError(t7(e,t,...rt,"Uint8Array"));if("secret"!==t.type)throw TypeError(`${rC(t)} instances for symmetric algorithms must be of type "secret"`)}},rR=(e,t,r)=>{if(!re(t))throw TypeError(t7(e,t,...rt));if("secret"===t.type)throw TypeError(`${rC(t)} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${rC(t)} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${rC(t)} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${rC(t)} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${rC(t)} instances for asymmetric algorithm encryption must be of type "public"`)},rI=(e,t,r)=>{e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?rO(e,t):rR(e,t,r)},rj=(e,t)=>{if(!(e instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw TypeError("Second argument must be a buffer");if(e.length!==t.length)throw TypeError("Input buffers must have the same length");let r=e.length,n=0,i=-1;for(;++i<r;)n|=e[i]^t[i];return 0===n};async function rU(e,t,r,n,i,a){let s,o;if(!(t instanceof Uint8Array))throw TypeError(t9(t,"Uint8Array"));let l=parseInt(e.slice(1,4),10),c=await tx.subtle.importKey("raw",t.subarray(l>>3),"AES-CBC",!1,["decrypt"]),u=await tx.subtle.importKey("raw",t.subarray(0,l>>3),{hash:`SHA-${l<<1}`,name:"HMAC"},!1,["sign"]),d=tR(a,n,r,tj(a.length<<3)),h=new Uint8Array((await tx.subtle.sign("HMAC",u,d)).slice(0,l>>3));try{s=rj(i,h)}catch{}if(!s)throw new tV;try{o=new Uint8Array(await tx.subtle.decrypt({iv:n,name:"AES-CBC"},c,r))}catch{}if(!o)throw new tV;return o}async function r$(e,t,r,n,i,a){let s;t instanceof Uint8Array?s=await tx.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(t6(t,e,"decrypt"),s=t);try{return new Uint8Array(await tx.subtle.decrypt({additionalData:a,iv:n,name:"AES-GCM",tagLength:128},s,tR(r,i)))}catch{throw new tV}}let rN=async(e,t,r,n,i,a)=>{if(!tA(t)&&!(t instanceof Uint8Array))throw TypeError(t9(t,...rt,"Uint8Array"));if(!n)throw new tF("JWE Initialization Vector missing");if(!i)throw new tF("JWE Authentication Tag missing");switch(t2(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&t3(t,parseInt(e.slice(-3),10)),rU(e,t,r,n,i,a);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&t3(t,parseInt(e.slice(1,4),10)),r$(e,t,r,n,i,a);default:throw new tJ("Unsupported JWE Content Encryption Algorithm")}};async function rL(e,t,r,n){let i=e.slice(0,7),a=await ri(i,r,t,n,new Uint8Array(0));return{encryptedKey:a.ciphertext,iv:tD(a.iv),tag:tD(a.tag)}}async function rD(e,t,r,n,i){return rN(e.slice(0,7),t,r,n,i,new Uint8Array(0))}async function rM(e,t,r,n,i={}){let a,s,o;switch(rI(e,r,"encrypt"),r=await rE.normalizePublicKey?.(r,e)||r,e){case"dir":o=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!rh(r))throw new tJ("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:l,apv:c}=i,{epk:u}=i;u||(u=(await rd(r)).privateKey);let{x:d,y:h,crv:p,kty:f}=await rP(u),g=await ru(r,u,"ECDH-ES"===e?t:e,"ECDH-ES"===e?rT(t):parseInt(e.slice(-5,-2),10),l,c);if(s={epk:{x:d,crv:p,kty:f}},"EC"===f&&(s.epk.y=h),l&&(s.apu=tD(l)),c&&(s.apv=tD(c)),"ECDH-ES"===e){o=g;break}o=n||rx(t);let y=e.slice(-6);a=await rl(y,g,o);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":o=n||rx(t),a=await rw(e,r,o);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{o=n||rx(t);let{p2c:l,p2s:c}=i;({encryptedKey:a,...s}=await rf(e,r,o,l,c));break}case"A128KW":case"A192KW":case"A256KW":o=n||rx(t),a=await rl(e,r,o);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{o=n||rx(t);let{iv:l}=i;({encryptedKey:a,...s}=await rL(e,r,o,l));break}default:throw new tJ('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:o,encryptedKey:a,parameters:s}}let rH=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0},rK=function(e,t,r,n,i){let a;if(void 0!==i.crit&&n?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let s of(a=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,n.crit)){if(!a.has(s))throw new tJ(`Extension Header Parameter "${s}" is not recognized`);if(void 0===i[s])throw new e(`Extension Header Parameter "${s}" is missing`);if(a.get(s)&&void 0===n[s])throw new e(`Extension Header Parameter "${s}" MUST be integrity protected`)}return new Set(n.crit)},rW=Symbol();class rB{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,t){let r,n,i,a,s;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new tF("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!rH(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new tF("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let o={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(rK(tF,new Map,t?.crit,this._protectedHeader,o),void 0!==o.zip)throw new tJ('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:l,enc:c}=o;if("string"!=typeof l||!l)throw new tF('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof c||!c)throw new tF('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(this._cek&&("dir"===l||"ECDH-ES"===l))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${l}`);{let i;({cek:n,encryptedKey:r,parameters:i}=await rM(l,c,e,this._cek,this._keyManagementParameters)),i&&(t&&rW in t?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...i}:this.setUnprotectedHeader(i):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...i}:this.setProtectedHeader(i))}a=this._protectedHeader?tC.encode(tD(JSON.stringify(this._protectedHeader))):tC.encode(""),this._aad?(s=tD(this._aad),i=tR(a,tC.encode("."),tC.encode(s))):i=a;let{ciphertext:u,tag:d,iv:h}=await ri(c,this._plaintext,n,this._iv,i),p={ciphertext:tD(u)};return h&&(p.iv=tD(h)),d&&(p.tag=tD(d)),r&&(p.encrypted_key=tD(r)),s&&(p.aad=s),this._protectedHeader&&(p.protected=tO.decode(a)),this._sharedUnprotectedHeader&&(p.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(p.header=this._unprotectedHeader),p}}class rq{constructor(e){this._flattened=new rB(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this._flattened.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}let rJ=e=>Math.floor(e.getTime()/1e3),rV=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,rF=e=>{let t;let r=rV.exec(e);if(!r||r[4]&&r[1])throw TypeError("Invalid time period format");let n=parseFloat(r[2]);switch(r[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(n);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*n);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*n);break;case"day":case"days":case"d":t=Math.round(86400*n);break;case"week":case"weeks":case"w":t=Math.round(604800*n);break;default:t=Math.round(31557600*n)}return"-"===r[1]||"ago"===r[4]?-t:t};function rz(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t}class rG{constructor(e={}){if(!tX(e))throw TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:rz("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:rz("setNotBefore",rJ(e))}:this._payload={...this._payload,nbf:rJ(new Date)+rF(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:rz("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:rz("setExpirationTime",rJ(e))}:this._payload={...this._payload,exp:rJ(new Date)+rF(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:rJ(new Date)}:e instanceof Date?this._payload={...this._payload,iat:rz("setIssuedAt",rJ(e))}:"string"==typeof e?this._payload={...this._payload,iat:rz("setIssuedAt",rJ(new Date)+rF(e))}:this._payload={...this._payload,iat:rz("setIssuedAt",e)},this}}class rX extends rG{setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,t){let r=new rq(tC.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,t)}}async function rY(e,t){if(!tX(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');return tH(e.k);case"RSA":if(void 0!==e.oth)throw new tJ('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return rv({...e,alg:t});default:throw new tJ('Unsupported "kty" (Key Type) Parameter value')}}async function rZ(e,t,r,n,i){switch(rI(e,t,"decrypt"),t=await rE.normalizePrivateKey?.(t,e)||t,e){case"dir":if(void 0!==r)throw new tF("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new tF("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let i,a;if(!tX(n.epk))throw new tF('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!rh(t))throw new tJ("ECDH with the provided key is not allowed or not supported by your javascript runtime");let s=await rY(n.epk,e);if(void 0!==n.apu){if("string"!=typeof n.apu)throw new tF('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{i=tH(n.apu)}catch{throw new tF("Failed to base64url decode the apu")}}if(void 0!==n.apv){if("string"!=typeof n.apv)throw new tF('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{a=tH(n.apv)}catch{throw new tF("Failed to base64url decode the apv")}}let o=await ru(s,t,"ECDH-ES"===e?n.enc:e,"ECDH-ES"===e?rT(n.enc):parseInt(e.slice(-5,-2),10),i,a);if("ECDH-ES"===e)return o;if(void 0===r)throw new tF("JWE Encrypted Key missing");return rc(e.slice(-6),o,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new tF("JWE Encrypted Key missing");return rb(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let a;if(void 0===r)throw new tF("JWE Encrypted Key missing");if("number"!=typeof n.p2c)throw new tF('JOSE Header "p2c" (PBES2 Count) missing or invalid');let s=i?.maxPBES2Count||1e4;if(n.p2c>s)throw new tF('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof n.p2s)throw new tF('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{a=tH(n.p2s)}catch{throw new tF("Failed to base64url decode the p2s")}return rg(e,t,r,n.p2c,a)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new tF("JWE Encrypted Key missing");return rc(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let i,a;if(void 0===r)throw new tF("JWE Encrypted Key missing");if("string"!=typeof n.iv)throw new tF('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof n.tag)throw new tF('JOSE Header "tag" (Authentication Tag) missing or invalid');try{i=tH(n.iv)}catch{throw new tF("Failed to base64url decode the iv")}try{a=tH(n.tag)}catch{throw new tF("Failed to base64url decode the tag")}return rD(e,t,r,i,a)}default:throw new tJ('Invalid or unsupported "alg" (JWE Algorithm) header value')}}let rQ=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function r0(e,t,r){let n,i,a,s,o,l,c;if(!tX(e))throw new tF("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new tF("JOSE Header missing");if(void 0!==e.iv&&"string"!=typeof e.iv)throw new tF("JWE Initialization Vector incorrect type");if("string"!=typeof e.ciphertext)throw new tF("JWE Ciphertext missing or incorrect type");if(void 0!==e.tag&&"string"!=typeof e.tag)throw new tF("JWE Authentication Tag incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new tF("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new tF("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new tF("JWE AAD incorrect type");if(void 0!==e.header&&!tX(e.header))throw new tF("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!tX(e.unprotected))throw new tF("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=tH(e.protected);n=JSON.parse(tO.decode(t))}catch{throw new tF("JWE Protected Header is invalid")}if(!rH(n,e.header,e.unprotected))throw new tF("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let u={...n,...e.header,...e.unprotected};if(rK(tF,new Map,r?.crit,n,u),void 0!==u.zip)throw new tJ('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:d,enc:h}=u;if("string"!=typeof d||!d)throw new tF("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof h||!h)throw new tF("missing JWE Encryption Algorithm (enc) in JWE Header");let p=r&&rQ("keyManagementAlgorithms",r.keyManagementAlgorithms),f=r&&rQ("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(p&&!p.has(d)||!p&&d.startsWith("PBES2"))throw new tq('"alg" (Algorithm) Header Parameter value not allowed');if(f&&!f.has(h))throw new tq('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(void 0!==e.encrypted_key)try{i=tH(e.encrypted_key)}catch{throw new tF("Failed to base64url decode the encrypted_key")}let g=!1;"function"==typeof t&&(t=await t(n,e),g=!0);try{a=await rZ(d,t,i,u,r)}catch(e){if(e instanceof TypeError||e instanceof tF||e instanceof tJ)throw e;a=rx(h)}if(void 0!==e.iv)try{s=tH(e.iv)}catch{throw new tF("Failed to base64url decode the iv")}if(void 0!==e.tag)try{o=tH(e.tag)}catch{throw new tF("Failed to base64url decode the tag")}let y=tC.encode(e.protected??"");l=void 0!==e.aad?tR(y,tC.encode("."),tC.encode(e.aad)):y;try{c=tH(e.ciphertext)}catch{throw new tF("Failed to base64url decode the ciphertext")}let m={plaintext:await rN(h,a,c,s,o,l)};if(void 0!==e.protected&&(m.protectedHeader=n),void 0!==e.aad)try{m.additionalAuthenticatedData=tH(e.aad)}catch{throw new tF("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(m.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(m.unprotectedHeader=e.header),g)?{...m,key:t}:m}async function r1(e,t,r){if(e instanceof Uint8Array&&(e=tO.decode(e)),"string"!=typeof e)throw new tF("Compact JWE must be a string or Uint8Array");let{0:n,1:i,2:a,3:s,4:o,length:l}=e.split(".");if(5!==l)throw new tF("Invalid Compact JWE");let c=await r0({ciphertext:s,iv:a||void 0,protected:n,tag:o||void 0,encrypted_key:i||void 0},t,r),u={plaintext:c.plaintext,protectedHeader:c.protectedHeader};return"function"==typeof t?{...u,key:c.key}:u}let r2=e=>e.toLowerCase().replace(/^application\//,""),r3=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e))),r5=(e,t,r={})=>{let n,i;try{n=JSON.parse(tO.decode(t))}catch{}if(!tX(n))throw new tz("JWT Claims Set must be a top-level JSON object");let{typ:a}=r;if(a&&("string"!=typeof e.typ||r2(e.typ)!==r2(a)))throw new tW('unexpected "typ" JWT header value',n,"typ","check_failed");let{requiredClaims:s=[],issuer:o,subject:l,audience:c,maxTokenAge:u}=r,d=[...s];for(let e of(void 0!==u&&d.push("iat"),void 0!==c&&d.push("aud"),void 0!==l&&d.push("sub"),void 0!==o&&d.push("iss"),new Set(d.reverse())))if(!(e in n))throw new tW(`missing required "${e}" claim`,n,e,"missing");if(o&&!(Array.isArray(o)?o:[o]).includes(n.iss))throw new tW('unexpected "iss" claim value',n,"iss","check_failed");if(l&&n.sub!==l)throw new tW('unexpected "sub" claim value',n,"sub","check_failed");if(c&&!r3(n.aud,"string"==typeof c?[c]:c))throw new tW('unexpected "aud" claim value',n,"aud","check_failed");switch(typeof r.clockTolerance){case"string":i=rF(r.clockTolerance);break;case"number":i=r.clockTolerance;break;case"undefined":i=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:h}=r,p=rJ(h||new Date);if((void 0!==n.iat||u)&&"number"!=typeof n.iat)throw new tW('"iat" claim must be a number',n,"iat","invalid");if(void 0!==n.nbf){if("number"!=typeof n.nbf)throw new tW('"nbf" claim must be a number',n,"nbf","invalid");if(n.nbf>p+i)throw new tW('"nbf" claim timestamp check failed',n,"nbf","check_failed")}if(void 0!==n.exp){if("number"!=typeof n.exp)throw new tW('"exp" claim must be a number',n,"exp","invalid");if(n.exp<=p-i)throw new tB('"exp" claim timestamp check failed',n,"exp","check_failed")}if(u){let e=p-n.iat;if(e-i>("number"==typeof u?u:rF(u)))throw new tB('"iat" claim timestamp check failed (too far in the past)',n,"iat","check_failed");if(e<0-i)throw new tW('"iat" claim timestamp check failed (it should be in the past)',n,"iat","check_failed")}return n};async function r4(e,t,r){let n=await r1(e,t,r),i=r5(n.protectedHeader,n.plaintext,r),{protectedHeader:a}=n;if(void 0!==a.iss&&a.iss!==i.iss)throw new tW('replicated "iss" claim header parameter mismatch',i,"iss","mismatch");if(void 0!==a.sub&&a.sub!==i.sub)throw new tW('replicated "sub" claim header parameter mismatch',i,"sub","mismatch");if(void 0!==a.aud&&JSON.stringify(a.aud)!==JSON.stringify(i.aud))throw new tW('replicated "aud" claim header parameter mismatch',i,"aud","mismatch");let s={payload:i,protectedHeader:a};return"function"==typeof t?{...s,key:n.key}:s}var r6=r(868);let r8=()=>Date.now()/1e3|0,r9="A256CBC-HS512";async function r7(e){let{token:t={},secret:r,maxAge:n=2592e3,salt:i}=e,a=Array.isArray(r)?r:[r],s=await nt(r9,a[0],i),o=await tZ({kty:"oct",k:tD(s)},`sha${s.byteLength<<3}`);return await new rX(t).setProtectedHeader({alg:"dir",enc:r9,kid:o}).setIssuedAt().setExpirationTime(r8()+n).setJti(crypto.randomUUID()).encrypt(s)}async function ne(e){let{token:t,secret:r,salt:n}=e,i=Array.isArray(r)?r:[r];if(!t)return null;let{payload:a}=await r4(t,async({kid:e,enc:t})=>{for(let r of i){let i=await nt(t,r,n);if(void 0===e||e===await tZ({kty:"oct",k:tD(i)},`sha${i.byteLength<<3}`))return i}throw Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:["dir"],contentEncryptionAlgorithms:[r9,"A256GCM"]});return a}async function nt(e,t,r){let n;switch(e){case"A256CBC-HS512":n=64;break;case"A256GCM":n=32;break;default:throw Error("Unsupported JWT Content Encryption Algorithm")}return await tT("sha256",t,r,`Auth.js Generated Encryption Key (${r})`,n)}async function nr({options:e,paramValue:t,cookieValue:r}){let{url:n,callbacks:i}=e,a=n.origin;return t?a=await i.redirect({url:t,baseUrl:n.origin}):r&&(a=await i.redirect({url:r,baseUrl:n.origin})),{callbackUrl:a,callbackUrlCookie:a!==r?a:void 0}}let nn="\x1b[31m",ni="\x1b[0m",na={error(e){let t=e instanceof eB?e.type:e.name;if(console.error(`${nn}[auth][error]${ni} ${t}: ${e.message}`),e.cause&&"object"==typeof e.cause&&"err"in e.cause&&e.cause.err instanceof Error){let{err:t,...r}=e.cause;console.error(`${nn}[auth][cause]${ni}:`,t.stack),r&&console.error(`${nn}[auth][details]${ni}:`,JSON.stringify(r,null,2))}else e.stack&&console.error(e.stack.replace(/.*/,"").substring(1))},warn(e){let t=`https://warnings.authjs.dev#${e}`;console.warn(`[33m[auth][warn][${e}]${ni}`,`Read more: ${t}`)},debug(e,t){console.log(`[90m[auth][debug]:${ni} ${e}`,JSON.stringify(t,null,2))}},ns=["providers","session","csrf","signin","signout","callback","verify-request","error","webauthn-options"];async function no(e){if(!("body"in e)||!e.body||"POST"!==e.method)return;let t=e.headers.get("content-type");return t?.includes("application/json")?await e.json():t?.includes("application/x-www-form-urlencoded")?Object.fromEntries(new URLSearchParams(await e.text())):void 0}async function nl(e,t){try{if("GET"!==e.method&&"POST"!==e.method)throw new tr("Only GET and POST requests are supported");t.basePath??(t.basePath="/auth");let r=new URL(e.url),{action:n,providerId:i}=function(e,t){let r=e.match(RegExp(`^${t}(.+)`));if(null===r)throw new tr(`Cannot parse action at ${e}`);let n=r.at(-1).replace(/^\//,"").split("/").filter(Boolean);if(1!==n.length&&2!==n.length)throw new tr(`Cannot parse action at ${e}`);let[i,a]=n;if(!ns.includes(i)||a&&!["signin","callback","webauthn-options"].includes(i))throw new tr(`Cannot parse action at ${e}`);return{action:i,providerId:a}}(r.pathname,t.basePath);return{url:r,action:n,providerId:i,method:e.method,headers:Object.fromEntries(e.headers),body:e.body?await no(e):void 0,cookies:(0,r6.Q)(e.headers.get("cookie")??"")??{},error:r.searchParams.get("error")??void 0,query:Object.fromEntries(r.searchParams)}}catch(t){na.error(t),na.debug("request",e)}}function nc(e){let t=new Headers(e.headers);e.cookies?.forEach(e=>{let{name:r,value:n,options:i}=e,a=r6.q(r,n,i);t.has("Set-Cookie")?t.append("Set-Cookie",a):t.set("Set-Cookie",a)});let r=e.body;"application/json"===t.get("content-type")?r=JSON.stringify(e.body):"application/x-www-form-urlencoded"===t.get("content-type")&&(r=new URLSearchParams(e.body).toString());let n=e.redirect?302:e.status??200,i=new Response(r,{headers:t,status:n});return e.redirect&&i.headers.set("Location",e.redirect),i}async function nu(e){let t=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map(e=>e.toString(16).padStart(2,"0")).join("").toString()}function nd(e){let t=e=>("0"+e.toString(16)).slice(-2);return Array.from(crypto.getRandomValues(new Uint8Array(e))).reduce((e,r)=>e+t(r),"")}async function nh({options:e,cookieValue:t,isPost:r,bodyValue:n}){if(t){let[i,a]=t.split("|");if(a===await nu(`${i}${e.secret}`))return{csrfTokenVerified:r&&i===n,csrfToken:i}}let i=nd(32),a=await nu(`${i}${e.secret}`);return{cookie:`${i}|${a}`,csrfToken:i}}function np(e,t){if(!t)throw new to(`CSRF token was missing during an action ${e}`)}function nf(e){return e&&"object"==typeof e&&!Array.isArray(e)}function ng(e,...t){if(!t.length)return e;let r=t.shift();if(nf(e)&&nf(r))for(let t in r)nf(r[t])?(e[t]||Object.assign(e,{[t]:{}}),ng(e[t],r[t])):Object.assign(e,{[t]:r[t]});return ng(e,...t)}let ny=e=>nw({id:e.sub??e.id??crypto.randomUUID(),name:e.name??e.nickname??e.preferred_username,email:e.email,image:e.picture}),nm=e=>nw({access_token:e.access_token,id_token:e.id_token,refresh_token:e.refresh_token,expires_at:e.expires_at,scope:e.scope,token_type:e.token_type,session_state:e.session_state});function nw(e){let t={};for(let[r,n]of Object.entries(e))void 0!==n&&(t[r]=n);return t}function nb(e,t){if(!e&&t)return;if("string"==typeof e)return{url:new URL(e)};let r=new URL(e?.url??"https://authjs.dev");if(e?.params!=null)for(let[t,n]of Object.entries(e.params))"claims"===t&&(n=JSON.stringify(n)),r.searchParams.set(t,String(n));return{url:r,request:e?.request,conform:e?.conform,...e?.clientPrivateKey?{clientPrivateKey:e?.clientPrivateKey}:null}}let nv={signIn:()=>!0,redirect:({url:e,baseUrl:t})=>e.startsWith("/")?`${t}${e}`:new URL(e).origin===t?e:t,session:({session:e})=>({user:{name:e.user?.name,email:e.user?.email,image:e.user?.image},expires:e.expires?.toISOString?.()??e.expires}),jwt:({token:e})=>e};async function n_({authOptions:e,providerId:t,action:r,url:n,cookies:i,callbackUrl:a,csrfToken:s,csrfDisabled:o,isPost:l}){var c;let{providers:u,provider:d}=function(e){let{providerId:t,options:r}=e,n=new URL(r.basePath??"/auth",e.url.origin),i=e.providers.map(e=>{let t="function"==typeof e?e():e,{options:i,...a}=t,s=i?.id??a.id,o=ng(a,i,{signinUrl:`${n}/signin/${s}`,callbackUrl:`${n}/callback/${s}`});return"oauth"===t.type||"oidc"===t.type?(o.redirectProxyUrl??(o.redirectProxyUrl=r.redirectProxyUrl),function(e){e.issuer&&(e.wellKnown??(e.wellKnown=`${e.issuer}/.well-known/openid-configuration`));let t=nb(e.authorization,e.issuer);t&&!t.url?.searchParams.has("scope")&&t.url.searchParams.set("scope","openid profile email");let r=nb(e.token,e.issuer),n=nb(e.userinfo,e.issuer),i=e.checks??["pkce"];return e.redirectProxyUrl&&(i.includes("state")||i.push("state"),e.redirectProxyUrl=`${e.redirectProxyUrl}/callback/${e.id}`),{...e,authorization:t,token:r,checks:i,userinfo:n,profile:e.profile??ny,account:e.account??nm}}(o)):o});return{providers:i,provider:i.find(({id:e})=>e===t)}}({providers:e.providers,url:n,providerId:t,options:e}),h=!1;if((d?.type==="oauth"||d?.type==="oidc")&&d.redirectProxyUrl)try{h=new URL(d.redirectProxyUrl).origin===n.origin}catch{throw TypeError(`redirectProxyUrl must be a valid URL. Received: ${d.redirectProxyUrl}`)}let p={debug:!1,pages:{},theme:{colorScheme:"auto",logo:"",brandColor:"",buttonText:""},...e,url:n,action:r,provider:d,cookies:ng(eK(e.useSecureCookies??"https:"===n.protocol),e.cookies),providers:u,session:{strategy:e.adapter?"database":"jwt",maxAge:2592e3,updateAge:86400,generateSessionToken:()=>crypto.randomUUID(),...e.session},jwt:{secret:e.secret,maxAge:e.session?.maxAge??2592e3,encode:r7,decode:ne,...e.jwt},events:Object.keys(c=e.events??{}).reduce((e,t)=>(e[t]=async(...e)=>{try{let r=c[t];return await r(...e)}catch(e){na.error(new eG(e))}},e),{}),adapter:function(e,t){if(e)return Object.keys(e).reduce((r,n)=>(r[n]=async(...r)=>{try{t.debug(`adapter_${n}`,{args:r});let i=e[n];return await i(...r)}catch(r){let e=new eJ(r);throw t.error(e),e}},r),{})}(e.adapter,na),callbacks:{...nv,...e.callbacks},logger:na,callbackUrl:n.origin,isOnRedirectProxy:h,experimental:{...e.experimental}},f=[];if(o)p.csrfTokenVerified=!0;else{let{csrfToken:e,cookie:t,csrfTokenVerified:r}=await nh({options:p,cookieValue:i?.[p.cookies.csrfToken.name],isPost:l,bodyValue:s});p.csrfToken=e,p.csrfTokenVerified=r,t&&f.push({name:p.cookies.csrfToken.name,value:t,options:p.cookies.csrfToken.options})}let{callbackUrl:g,callbackUrlCookie:y}=await nr({options:p,cookieValue:i?.[p.cookies.callbackUrl.name],paramValue:a});return p.callbackUrl=g,y&&f.push({name:p.cookies.callbackUrl.name,value:y,options:p.cookies.callbackUrl.options}),{options:p,cookies:f}}var nS,nk,nE,nT,nx,nA,nP,nC,nO,nR,nI,nj,nU,n$,nN,nL,nD,nM,nH,nK,nW,nB,nq={},nJ=[],nV=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function nF(e,t){for(var r in t)e[r]=t[r];return e}function nz(e){var t=e.parentNode;t&&t.removeChild(e)}function nG(e,t,r,n,i){var a={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++nK:i};return null==i&&null!=nH.vnode&&nH.vnode(a),a}function nX(e){return e.children}function nY(e,t){this.props=e,this.context=t}function nZ(e,t){if(null==t)return e.__?nZ(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?nZ(e):null}function nQ(e){(!e.__d&&(e.__d=!0)&&nW.push(e)&&!n0.__r++||nB!==nH.debounceRendering)&&((nB=nH.debounceRendering)||setTimeout)(n0)}function n0(){for(var e;n0.__r=nW.length;)e=nW.sort(function(e,t){return e.__v.__b-t.__v.__b}),nW=[],e.some(function(e){var t,r,n,i,a;e.__d&&(i=(n=e.__v).__e,(a=e.__P)&&(t=[],(r=nF({},n)).__v=n.__v+1,n8(a,n,r,e.__n,void 0!==a.ownerSVGElement,null!=n.__h?[i]:null,t,null==i?nZ(n):i,n.__h),n9(t,n),n.__e!=i&&function e(t){var r,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,r=0;r<t.__k.length;r++)if(null!=(n=t.__k[r])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return e(t)}}(n)))})}function n1(e,t,r,n,i,a,s,o,l,c){var u,d,h,p,f,g,y,m=n&&n.__k||nJ,w=m.length;for(r.__k=[],u=0;u<t.length;u++)if(null!=(p=r.__k[u]=null==(p=t[u])||"boolean"==typeof p?null:"string"==typeof p||"number"==typeof p||"bigint"==typeof p?nG(null,p,null,null,p):Array.isArray(p)?nG(nX,{children:p},null,null,null):p.__b>0?nG(p.type,p.props,p.key,p.ref?p.ref:null,p.__v):p)){if(p.__=r,p.__b=r.__b+1,null===(h=m[u])||h&&p.key==h.key&&p.type===h.type)m[u]=void 0;else for(d=0;d<w;d++){if((h=m[d])&&p.key==h.key&&p.type===h.type){m[d]=void 0;break}h=null}n8(e,p,h=h||nq,i,a,s,o,l,c),f=p.__e,(d=p.ref)&&h.ref!=d&&(y||(y=[]),h.ref&&y.push(h.ref,null,p),y.push(d,p.__c||f,p)),null!=f?(null==g&&(g=f),"function"==typeof p.type&&p.__k===h.__k?p.__d=l=function e(t,r,n){for(var i,a=t.__k,s=0;a&&s<a.length;s++)(i=a[s])&&(i.__=t,r="function"==typeof i.type?e(i,r,n):n2(n,i,i,a,i.__e,r));return r}(p,l,e):l=n2(e,p,h,m,f,l),"function"==typeof r.type&&(r.__d=l)):l&&h.__e==l&&l.parentNode!=e&&(l=nZ(h))}for(r.__e=g,u=w;u--;)null!=m[u]&&function e(t,r,n){var i,a;if(nH.unmount&&nH.unmount(t),(i=t.ref)&&(i.current&&i.current!==t.__e||n7(i,null,r)),null!=(i=t.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){nH.__e(e,r)}i.base=i.__P=null,t.__c=void 0}if(i=t.__k)for(a=0;a<i.length;a++)i[a]&&e(i[a],r,n||"function"!=typeof t.type);n||null==t.__e||nz(t.__e),t.__=t.__e=t.__d=void 0}(m[u],m[u]);if(y)for(u=0;u<y.length;u++)n7(y[u],y[++u],y[++u])}function n2(e,t,r,n,i,a){var s,o,l;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==r||i!=a||null==i.parentNode)e:if(null==a||a.parentNode!==e)e.appendChild(i),s=null;else{for(o=a,l=0;(o=o.nextSibling)&&l<n.length;l+=1)if(o==i)break e;e.insertBefore(i,a),s=a}return void 0!==s?s:i.nextSibling}function n3(e,t,r){"-"===t[0]?e.setProperty(t,r):e[t]=null==r?"":"number"!=typeof r||nV.test(t)?r:r+"px"}function n5(e,t,r,n,i){var a;e:if("style"===t){if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof n&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||n3(e.style,t,"");if(r)for(t in r)n&&r[t]===n[t]||n3(e.style,t,r[t])}}else if("o"===t[0]&&"n"===t[1])a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase() in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=r,r?n||e.addEventListener(t,a?n6:n4,a):e.removeEventListener(t,a?n6:n4,a);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null==r||!1===r&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,r))}}function n4(e){this.l[e.type+!1](nH.event?nH.event(e):e)}function n6(e){this.l[e.type+!0](nH.event?nH.event(e):e)}function n8(e,t,r,n,i,a,s,o,l){var c,u,d,h,p,f,g,y,m,w,b,v,_,S,k,E=t.type;if(void 0!==t.constructor)return null;null!=r.__h&&(l=r.__h,o=t.__e=r.__e,t.__h=null,a=[o]),(c=nH.__b)&&c(t);try{e:if("function"==typeof E){if(y=t.props,m=(c=E.contextType)&&n[c.__c],w=c?m?m.props.value:c.__:n,r.__c?g=(u=t.__c=r.__c).__=u.__E:("prototype"in E&&E.prototype.render?t.__c=u=new E(y,w):(t.__c=u=new nY(y,w),u.constructor=E,u.render=ie),m&&m.sub(u),u.props=y,u.state||(u.state={}),u.context=w,u.__n=n,d=u.__d=!0,u.__h=[],u._sb=[]),null==u.__s&&(u.__s=u.state),null!=E.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=nF({},u.__s)),nF(u.__s,E.getDerivedStateFromProps(y,u.__s))),h=u.props,p=u.state,d)null==E.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(null==E.getDerivedStateFromProps&&y!==h&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(y,w),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(y,u.__s,w)||t.__v===r.__v){for(u.props=y,u.state=u.__s,t.__v!==r.__v&&(u.__d=!1),u.__v=t,t.__e=r.__e,t.__k=r.__k,t.__k.forEach(function(e){e&&(e.__=t)}),b=0;b<u._sb.length;b++)u.__h.push(u._sb[b]);u._sb=[],u.__h.length&&s.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(y,u.__s,w),null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(h,p,f)})}if(u.context=w,u.props=y,u.__v=t,u.__P=e,v=nH.__r,_=0,"prototype"in E&&E.prototype.render){for(u.state=u.__s,u.__d=!1,v&&v(t),c=u.render(u.props,u.state,u.context),S=0;S<u._sb.length;S++)u.__h.push(u._sb[S]);u._sb=[]}else do u.__d=!1,v&&v(t),c=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++_<25);u.state=u.__s,null!=u.getChildContext&&(n=nF(nF({},n),u.getChildContext())),d||null==u.getSnapshotBeforeUpdate||(f=u.getSnapshotBeforeUpdate(h,p)),k=null!=c&&c.type===nX&&null==c.key?c.props.children:c,n1(e,Array.isArray(k)?k:[k],t,r,n,i,a,s,o,l),u.base=t.__e,t.__h=null,u.__h.length&&s.push(u),g&&(u.__E=u.__=null),u.__e=!1}else null==a&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=function(e,t,r,n,i,a,s,o){var l,c,u,d=r.props,h=t.props,p=t.type,f=0;if("svg"===p&&(i=!0),null!=a){for(;f<a.length;f++)if((l=a[f])&&"setAttribute"in l==!!p&&(p?l.localName===p:3===l.nodeType)){e=l,a[f]=null;break}}if(null==e){if(null===p)return document.createTextNode(h);e=i?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,h.is&&h),a=null,o=!1}if(null===p)d===h||o&&e.data===h||(e.data=h);else{if(a=a&&nM.call(e.childNodes),c=(d=r.props||nq).dangerouslySetInnerHTML,u=h.dangerouslySetInnerHTML,!o){if(null!=a)for(d={},f=0;f<e.attributes.length;f++)d[e.attributes[f].name]=e.attributes[f].value;(u||c)&&(u&&(c&&u.__html==c.__html||u.__html===e.innerHTML)||(e.innerHTML=u&&u.__html||""))}if(function(e,t,r,n,i){var a;for(a in r)"children"===a||"key"===a||a in t||n5(e,a,null,r[a],n);for(a in t)i&&"function"!=typeof t[a]||"children"===a||"key"===a||"value"===a||"checked"===a||r[a]===t[a]||n5(e,a,t[a],r[a],n)}(e,h,d,i,o),u)t.__k=[];else if(n1(e,Array.isArray(f=t.props.children)?f:[f],t,r,n,i&&"foreignObject"!==p,a,s,a?a[0]:r.__k&&nZ(r,0),o),null!=a)for(f=a.length;f--;)null!=a[f]&&nz(a[f]);o||("value"in h&&void 0!==(f=h.value)&&(f!==e.value||"progress"===p&&!f||"option"===p&&f!==d.value)&&n5(e,"value",f,d.value,!1),"checked"in h&&void 0!==(f=h.checked)&&f!==e.checked&&n5(e,"checked",f,d.checked,!1))}return e}(r.__e,t,r,n,i,a,s,l);(c=nH.diffed)&&c(t)}catch(e){t.__v=null,(l||null!=a)&&(t.__e=o,t.__h=!!l,a[a.indexOf(o)]=null),nH.__e(e,t,r)}}function n9(e,t){nH.__c&&nH.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){nH.__e(e,t.__v)}})}function n7(e,t,r){try{"function"==typeof e?e(t):e.current=t}catch(e){nH.__e(e,r)}}function ie(e,t,r){return this.constructor(e,r)}function it(e,t){var r,n,i,a;r=e,nH.__&&nH.__(r,t),i=(n="function"==typeof it)?null:it&&it.__k||t.__k,a=[],n8(t,r=(!n&&it||t).__k=function(e,t,r){var n,i,a,s={};for(a in t)"key"==a?n=t[a]:"ref"==a?i=t[a]:s[a]=t[a];if(arguments.length>2&&(s.children=arguments.length>3?nM.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===s[a]&&(s[a]=e.defaultProps[a]);return nG(e,s,n,i,null)}(nX,null,[r]),i||nq,nq,void 0!==t.ownerSVGElement,!n&&it?[it]:i?null:t.firstChild?nM.call(t.childNodes):null,a,!n&&it?it:i?i.__e:t.firstChild,n),n9(a,r)}nM=nJ.slice,nH={__e:function(e,t,r,n){for(var i,a,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((a=i.constructor)&&null!=a.getDerivedStateFromError&&(i.setState(a.getDerivedStateFromError(e)),s=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,n||{}),s=i.__d),s)return i.__E=i}catch(t){e=t}throw e}},nK=0,nY.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=nF({},this.state),"function"==typeof e&&(e=e(nF({},r),this.props)),e&&nF(r,e),null!=e&&this.__v&&(t&&this._sb.push(t),nQ(this))},nY.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),nQ(this))},nY.prototype.render=nX,nW=[],n0.__r=0;var ir=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,ii=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,ia=/[\s\n\\/='"\0<>]/,is=/^xlink:?./,io=/["&<]/;function il(e){if(!1===io.test(e+=""))return e;for(var t=0,r=0,n="",i="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;default:continue}r!==t&&(n+=e.slice(t,r)),n+=i,t=r+1}return r!==t&&(n+=e.slice(t,r)),n}var ic=function(e,t){return String(e).replace(/(\n+)/g,"$1"+(t||"	"))},iu=function(e,t,r){return String(e).length>(t||40)||!r&&-1!==String(e).indexOf("\n")||-1!==String(e).indexOf("<")},id={},ih=/([A-Z])/g;function ip(e){var t="";for(var r in e){var n=e[r];null!=n&&""!==n&&(t&&(t+=" "),t+="-"==r[0]?r:id[r]||(id[r]=r.replace(ih,"-$1").toLowerCase()),t="number"==typeof n&&!1===ir.test(r)?t+": "+n+"px;":t+": "+n+";")}return t||void 0}function ig(e,t){return Array.isArray(t)?t.reduce(ig,e):null!=t&&!1!==t&&e.push(t),e}function iy(){this.__d=!0}function im(e,t){return{__v:e,context:t,props:e.props,setState:iy,forceUpdate:iy,__d:!0,__h:[]}}function iw(e,t){var r=e.contextType,n=r&&t[r.__c];return null!=r?n?n.props.value:r.__:t}var ib=[],iv={shallow:!0};iS.render=iS;var i_=[];function iS(e,t,r){t=t||{};var n,i=nH.__s;return nH.__s=!0,n=r&&(r.pretty||r.voidElements||r.sortAttributes||r.shallow||r.allAttributes||r.xml||r.attributeHook)?function e(t,r,n,i,a,s){if(null==t||"boolean"==typeof t)return"";if("object"!=typeof t)return il(t);var o=n.pretty,l=o&&"string"==typeof o?o:"	";if(Array.isArray(t)){for(var c="",u=0;u<t.length;u++)o&&u>0&&(c+="\n"),c+=e(t[u],r,n,i,a,s);return c}var d,h=t.type,p=t.props,f=!1;if("function"==typeof h){if(f=!0,!n.shallow||!i&&!1!==n.renderRootComponent){if(h===nX){var g=[];return ig(g,t.props.children),e(g,r,n,!1!==n.shallowHighOrder,a,s)}var y,m=t.__c=im(t,r);nH.__b&&nH.__b(t);var w=nH.__r;if(h.prototype&&"function"==typeof h.prototype.render){var b=iw(h,r);(m=t.__c=new h(p,b)).__v=t,m._dirty=m.__d=!0,m.props=p,null==m.state&&(m.state={}),null==m._nextState&&null==m.__s&&(m._nextState=m.__s=m.state),m.context=b,h.getDerivedStateFromProps?m.state=Object.assign({},m.state,h.getDerivedStateFromProps(m.props,m.state)):m.componentWillMount&&(m.componentWillMount(),m.state=m._nextState!==m.state?m._nextState:m.__s!==m.state?m.__s:m.state),w&&w(t),y=m.render(m.props,m.state,m.context)}else for(var v=iw(h,r),_=0;m.__d&&_++<25;)m.__d=!1,w&&w(t),y=h.call(t.__c,p,v);return m.getChildContext&&(r=Object.assign({},r,m.getChildContext())),nH.diffed&&nH.diffed(t),e(y,r,n,!1!==n.shallowHighOrder,a,s)}h=(d=h).displayName||d!==Function&&d.name||function(e){var t=(Function.prototype.toString.call(e).match(/^\s*function\s+([^( ]+)/)||"")[1];if(!t){for(var r=-1,n=ib.length;n--;)if(ib[n]===e){r=n;break}r<0&&(r=ib.push(e)-1),t="UnnamedComponent"+r}return t}(d)}var S,k,E="<"+h;if(p){var T=Object.keys(p);n&&!0===n.sortAttributes&&T.sort();for(var x=0;x<T.length;x++){var A=T[x],P=p[A];if("children"!==A){if(!ia.test(A)&&(n&&n.allAttributes||"key"!==A&&"ref"!==A&&"__self"!==A&&"__source"!==A)){if("defaultValue"===A)A="value";else if("defaultChecked"===A)A="checked";else if("defaultSelected"===A)A="selected";else if("className"===A){if(void 0!==p.class)continue;A="class"}else a&&is.test(A)&&(A=A.toLowerCase().replace(/^xlink:?/,"xlink:"));if("htmlFor"===A){if(p.for)continue;A="for"}"style"===A&&P&&"object"==typeof P&&(P=ip(P)),"a"===A[0]&&"r"===A[1]&&"boolean"==typeof P&&(P=String(P));var C=n.attributeHook&&n.attributeHook(A,P,r,n,f);if(C||""===C)E+=C;else if("dangerouslySetInnerHTML"===A)k=P&&P.__html;else if("textarea"===h&&"value"===A)S=P;else if((P||0===P||""===P)&&"function"!=typeof P){if(!(!0!==P&&""!==P||(P=A,n&&n.xml))){E=E+" "+A;continue}if("value"===A){if("select"===h){s=P;continue}"option"===h&&s==P&&void 0===p.selected&&(E+=" selected")}E=E+" "+A+'="'+il(P)+'"'}}}else S=P}}if(o){var O=E.replace(/\n\s*/," ");O===E||~O.indexOf("\n")?o&&~E.indexOf("\n")&&(E+="\n"):E=O}if(E+=">",ia.test(h))throw Error(h+" is not a valid HTML tag name in "+E);var R,I=ii.test(h)||n.voidElements&&n.voidElements.test(h),j=[];if(k)o&&iu(k)&&(k="\n"+l+ic(k,l)),E+=k;else if(null!=S&&ig(R=[],S).length){for(var U=o&&~E.indexOf("\n"),$=!1,N=0;N<R.length;N++){var L=R[N];if(null!=L&&!1!==L){var D=e(L,r,n,!0,"svg"===h||"foreignObject"!==h&&a,s);if(o&&!U&&iu(D)&&(U=!0),D){if(o){var M=D.length>0&&"<"!=D[0];$&&M?j[j.length-1]+=D:j.push(D),$=M}else j.push(D)}}}if(o&&U)for(var H=j.length;H--;)j[H]="\n"+l+ic(j[H],l)}if(j.length||k)E+=j.join("");else if(n&&n.xml)return E.substring(0,E.length-1)+" />";return!I||R||k?(o&&~E.indexOf("\n")&&(E+="\n"),E=E+"</"+h+">"):E=E.replace(/>$/," />"),E}(e,t,r):function e(t,r,n,i){if(null==t||!0===t||!1===t||""===t)return"";if("object"!=typeof t)return il(t);if(ik(t)){for(var a="",s=0;s<t.length;s++)a+=e(t[s],r,n,i);return a}nH.__b&&nH.__b(t);var o=t.type,l=t.props;if("function"==typeof o){if(o===nX)return e(t.props.children,r,n,i);f=o.prototype&&"function"==typeof o.prototype.render?(c=r,d=iw(u=t.type,c),h=new u(t.props,d),t.__c=h,h.__v=t,h.__d=!0,h.props=t.props,null==h.state&&(h.state={}),null==h.__s&&(h.__s=h.state),h.context=d,u.getDerivedStateFromProps?h.state=iE({},h.state,u.getDerivedStateFromProps(h.props,h.state)):h.componentWillMount&&(h.componentWillMount(),h.state=h.__s!==h.state?h.__s:h.state),(p=nH.__r)&&p(t),h.render(h.props,h.state,h.context)):function(e,t){var r,n=im(e,t),i=iw(e.type,t);e.__c=n;for(var a=nH.__r,s=0;n.__d&&s++<25;)n.__d=!1,a&&a(e),r=e.type.call(n,e.props,i);return r}(t,r);var c,u,d,h,p,f,g=t.__c;g.getChildContext&&(r=iE({},r,g.getChildContext()));var y=e(f,r,n,i);return nH.diffed&&nH.diffed(t),y}var m,w,b="<";if(b+=o,l)for(var v in m=l.children,l){var _,S,k,E=l[v];if(!("key"===v||"ref"===v||"__self"===v||"__source"===v||"children"===v||"className"===v&&"class"in l||"htmlFor"===v&&"for"in l||ia.test(v))){if(S=v="className"===(_=v)?"class":"htmlFor"===_?"for":"defaultValue"===_?"value":"defaultChecked"===_?"checked":"defaultSelected"===_?"selected":n&&is.test(_)?_.toLowerCase().replace(/^xlink:?/,"xlink:"):_,k=E,E="style"===S&&null!=k&&"object"==typeof k?ip(k):"a"===S[0]&&"r"===S[1]&&"boolean"==typeof k?String(k):k,"dangerouslySetInnerHTML"===v)w=E&&E.__html;else if("textarea"===o&&"value"===v)m=E;else if((E||0===E||""===E)&&"function"!=typeof E){if(!0===E||""===E){E=v,b=b+" "+v;continue}if("value"===v){if("select"===o){i=E;continue}"option"!==o||i!=E||"selected"in l||(b+=" selected")}b=b+" "+v+'="'+il(E)+'"'}}}var T=b;if(b+=">",ia.test(o))throw Error(o+" is not a valid HTML tag name in "+b);var x="",A=!1;if(w)x+=w,A=!0;else if("string"==typeof m)x+=il(m),A=!0;else if(ik(m))for(var P=0;P<m.length;P++){var C=m[P];if(null!=C&&!1!==C){var O=e(C,r,"svg"===o||"foreignObject"!==o&&n,i);O&&(x+=O,A=!0)}}else if(null!=m&&!1!==m&&!0!==m){var R=e(m,r,"svg"===o||"foreignObject"!==o&&n,i);R&&(x+=R,A=!0)}if(nH.diffed&&nH.diffed(t),A)b+=x;else if(ii.test(o))return T+" />";return b+"</"+o+">"}(e,t,!1,void 0),nH.__c&&nH.__c(e,i_),nH.__s=i,i_.length=0,n}var ik=Array.isArray,iE=Object.assign;iS.shallowRender=function(e,t){return iS(e,t,iv)};var iT=0;function ix(e,t,r,n,i){var a,s,o={};for(s in t)"ref"==s?a=t[s]:o[s]=t[s];var l={type:e,props:o,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--iT,__source:i,__self:n};if("function"==typeof e&&(a=e.defaultProps))for(s in a)void 0===o[s]&&(o[s]=a[s]);return nH.vnode&&nH.vnode(l),l}async function iA(e,t){let r=window.SimpleWebAuthnBrowser;async function n(r){let n=new URL(`${e}/webauthn-options/${t}`);r&&n.searchParams.append("action",r),a().forEach(e=>{n.searchParams.append(e.name,e.value)});let i=await fetch(n);if(!i.ok){console.error("Failed to fetch options",i);return}return i.json()}function i(){let e=`#${t}-form`,r=document.querySelector(e);if(!r)throw Error(`Form '${e}' not found`);return r}function a(){return Array.from(i().querySelectorAll("input[data-form-field]"))}async function s(e,t){let r=i();if(e){let t=document.createElement("input");t.type="hidden",t.name="action",t.value=e,r.appendChild(t)}if(t){let e=document.createElement("input");e.type="hidden",e.name="data",e.value=JSON.stringify(t),r.appendChild(e)}return r.submit()}async function o(e,t){let n=await r.startAuthentication(e,t);return await s("authenticate",n)}async function l(e){a().forEach(e=>{if(e.required&&!e.value)throw Error(`Missing required field: ${e.name}`)});let t=await r.startRegistration(e);return await s("register",t)}async function c(){if(!r.browserSupportsWebAuthnAutofill())return;let e=await n("authenticate");if(!e){console.error("Failed to fetch option for autofill authentication");return}try{await o(e.options,!0)}catch(e){console.error(e)}}(async function(){let e=i();if(!r.browserSupportsWebAuthn()){e.style.display="none";return}e&&e.addEventListener("submit",async e=>{e.preventDefault();let t=await n(void 0);if(!t){console.error("Failed to fetch options for form submission");return}if("authenticate"===t.action)try{await o(t.options,!1)}catch(e){console.error(e)}else if("register"===t.action)try{await l(t.options)}catch(e){console.error(e)}})})(),c()}let iP={default:"Unable to sign in.",Signin:"Try signing in with a different account.",OAuthSignin:"Try signing in with a different account.",OAuthCallbackError:"Try signing in with a different account.",OAuthCreateAccount:"Try signing in with a different account.",EmailCreateAccount:"Try signing in with a different account.",Callback:"Try signing in with a different account.",OAuthAccountNotLinked:"To confirm your identity, sign in with the same account you used originally.",EmailSignin:"The e-mail could not be sent.",CredentialsSignin:"Sign in failed. Check the details you provided are correct.",SessionRequired:"Please sign in to access this page."},iC=`:root {
  --border-width: 1px;
  --border-radius: 0.5rem;
  --color-error: #c94b4b;
  --color-info: #157efb;
  --color-info-hover: #0f6ddb;
  --color-info-text: #fff;
}

.__next-auth-theme-auto,
.__next-auth-theme-light {
  --color-background: #ececec;
  --color-background-hover: rgba(236, 236, 236, 0.8);
  --color-background-card: #fff;
  --color-text: #000;
  --color-primary: #444;
  --color-control-border: #bbb;
  --color-button-active-background: #f9f9f9;
  --color-button-active-border: #aaa;
  --color-separator: #ccc;
}

.__next-auth-theme-dark {
  --color-background: #161b22;
  --color-background-hover: rgba(22, 27, 34, 0.8);
  --color-background-card: #0d1117;
  --color-text: #fff;
  --color-primary: #ccc;
  --color-control-border: #555;
  --color-button-active-background: #060606;
  --color-button-active-border: #666;
  --color-separator: #444;
}

@media (prefers-color-scheme: dark) {
  .__next-auth-theme-auto {
    --color-background: #161b22;
    --color-background-hover: rgba(22, 27, 34, 0.8);
    --color-background-card: #0d1117;
    --color-text: #fff;
    --color-primary: #ccc;
    --color-control-border: #555;
    --color-button-active-background: #060606;
    --color-button-active-border: #666;
    --color-separator: #444;
  }

  button,
  a.button {
    color: var(--provider-dark-color, var(--color-primary)) !important;
    background-color: var(
      --provider-dark-bg,
      var(--color-background)
    ) !important;
  }

    :is(button,a.button):hover {
      background-color: var(
        --provider-dark-bg-hover,
        var(--color-background-hover)
      ) !important;
    }

    :is(button,a.button) span {
      color: var(--provider-dark-bg) !important;
    }
}

html {
  box-sizing: border-box;
}

*,
*:before,
*:after {
  box-sizing: inherit;
  margin: 0;
  padding: 0;
}

body {
  background-color: var(--color-background);
  margin: 0;
  padding: 0;
  font-family:
    ui-sans-serif,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    "Helvetica Neue",
    Arial,
    "Noto Sans",
    sans-serif,
    "Apple Color Emoji",
    "Segoe UI Emoji",
    "Segoe UI Symbol",
    "Noto Color Emoji";
}

h1 {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  font-weight: 400;
  color: var(--color-text);
}

p {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  color: var(--color-text);
}

form {
  margin: 0;
  padding: 0;
}

label {
  font-weight: 500;
  text-align: left;
  margin-bottom: 0.25rem;
  display: block;
  color: var(--color-text);
}

input[type] {
  box-sizing: border-box;
  display: block;
  width: 100%;
  padding: 0.5rem 1rem;
  border: var(--border-width) solid var(--color-control-border);
  background: var(--color-background-card);
  font-size: 1rem;
  border-radius: var(--border-radius);
  color: var(--color-text);
}

p {
  font-size: 1.1rem;
  line-height: 2rem;
}

a.button {
  text-decoration: none;
  line-height: 1rem;
}

a.button:link,
  a.button:visited {
    background-color: var(--color-background);
    color: var(--color-primary);
  }

button span {
  flex-grow: 1;
}

button,
a.button {
  padding: 0.75rem 1rem;
  color: var(--provider-color, var(--color-primary));
  background-color: var(--provider-bg, var(--color-background));
  border: 1px solid #00000031;
  font-size: 0.9rem;
  height: 50px;
  border-radius: var(--border-radius);
  transition: background-color 250ms ease-in-out;
  font-weight: 300;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

:is(button,a.button):hover {
    background-color: var(--provider-bg-hover, var(--color-background-hover));
    cursor: pointer;
  }

:is(button,a.button):active {
    cursor: pointer;
  }

:is(button,a.button) span {
    color: #fff;
  }

:is(button,a.button) #provider-logo {
    width: 25px;
    display: block;
  }

#submitButton {
  color: var(--button-text-color, var(--color-info-text));
  background-color: var(--brand-color, var(--color-info));
  width: 100%;
}

#submitButton:hover {
    background-color: var(
      --button-hover-bg,
      var(--color-info-hover)
    ) !important;
  }

a.site {
  color: var(--color-primary);
  text-decoration: none;
  font-size: 1rem;
  line-height: 2rem;
}

a.site:hover {
    text-decoration: underline;
  }

.page {
  position: absolute;
  width: 100%;
  height: 100%;
  display: grid;
  place-items: center;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.page > div {
    text-align: center;
  }

.error a.button {
    padding-left: 2rem;
    padding-right: 2rem;
    margin-top: 0.5rem;
  }

.error .message {
    margin-bottom: 1.5rem;
  }

.signin input[type="text"] {
    margin-left: auto;
    margin-right: auto;
    display: block;
  }

.signin hr {
    display: block;
    border: 0;
    border-top: 1px solid var(--color-separator);
    margin: 2rem auto 1rem auto;
    overflow: visible;
  }

.signin hr::before {
      content: "or";
      background: var(--color-background-card);
      color: #888;
      padding: 0 0.4rem;
      position: relative;
      top: -0.7rem;
    }

.signin .error {
    background: #f5f5f5;
    font-weight: 500;
    border-radius: 0.3rem;
    background: var(--color-error);
  }

.signin .error p {
      text-align: left;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      line-height: 1.2rem;
      color: var(--color-info-text);
    }

.signin > div,
  .signin form {
    display: block;
  }

.signin > div input[type], .signin form input[type] {
      margin-bottom: 0.5rem;
    }

.signin > div button, .signin form button {
      width: 100%;
    }

.signin .provider + .provider {
    margin-top: 1rem;
  }

.logo {
  display: inline-block;
  max-width: 150px;
  margin: 1.25rem 0;
  max-height: 70px;
}

.card {
  background-color: var(--color-background-card);
  border-radius: 1rem;
  padding: 1.25rem 2rem;
}

.card .header {
    color: var(--color-primary);
  }

.card input[type]::-moz-placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type]::placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type] {
    background: color-mix(in srgb, var(--color-background-card) 95%, black);
  }

.section-header {
  color: var(--color-text);
}

@media screen and (min-width: 450px) {
  .card {
    margin: 2rem 0;
    width: 368px;
  }
}

@media screen and (max-width: 450px) {
  .card {
    margin: 1rem 0;
    width: 343px;
  }
}
`;function iO({html:e,title:t,status:r,cookies:n,theme:i,headTags:a}){return{cookies:n,status:r,headers:{"Content-Type":"text/html"},body:`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>${iC}</style><title>${t}</title>${a??""}</head><body class="__next-auth-theme-${i?.colorScheme??"auto"}"><div class="page">${iS(e)}</div></body></html>`}}function iR(e){let{url:t,theme:r,query:n,cookies:i,pages:a,providers:s}=e;return{csrf:(e,t,r)=>e?(t.logger.warn("csrf-disabled"),r.push({name:t.cookies.csrfToken.name,value:"",options:{...t.cookies.csrfToken.options,maxAge:0}}),{status:404,cookies:r}):{headers:{"Content-Type":"application/json"},body:{csrfToken:t.csrfToken},cookies:r},providers:e=>({headers:{"Content-Type":"application/json"},body:e.reduce((e,{id:t,name:r,type:n,signinUrl:i,callbackUrl:a})=>(e[t]={id:t,name:r,type:n,signinUrl:i,callbackUrl:a},e),{})}),signin(t,o){if(t)throw new tr("Unsupported action");if(a?.signIn){let t=`${a.signIn}${a.signIn.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:e.callbackUrl??"/"})}`;return o&&(t=`${t}&${new URLSearchParams({error:o})}`),{redirect:t,cookies:i}}let l=s?.find(e=>"webauthn"===e.type&&e.enableConditionalUI&&!!e.simpleWebAuthnBrowserVersion),c="";if(l){let{simpleWebAuthnBrowserVersion:e}=l;c=`<script src="https://unpkg.com/@simplewebauthn/browser@${e}/dist/bundle/index.umd.min.js" crossorigin="anonymous"></script>`}return iO({cookies:i,theme:r,html:function(e){let{csrfToken:t,providers:r=[],callbackUrl:n,theme:i,email:a,error:s}=e;"undefined"!=typeof document&&i?.brandColor&&document.documentElement.style.setProperty("--brand-color",i.brandColor),"undefined"!=typeof document&&i?.buttonText&&document.documentElement.style.setProperty("--button-text-color",i.buttonText);let o=s&&(iP[s]??iP.default),l=r.find(e=>"webauthn"===e.type&&e.enableConditionalUI)?.id;return ix("div",{className:"signin",children:[i?.brandColor&&ix("style",{dangerouslySetInnerHTML:{__html:`:root {--brand-color: ${i.brandColor}}`}}),i?.buttonText&&ix("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${i.buttonText}
        }
      `}}),ix("div",{className:"card",children:[o&&ix("div",{className:"error",children:ix("p",{children:o})}),i?.logo&&ix("img",{src:i.logo,alt:"Logo",className:"logo"}),r.map((e,i)=>{let s,o,l;("oauth"===e.type||"oidc"===e.type)&&({bg:s="#fff",brandColor:o,logo:l=`https://authjs.dev/img/providers/${e.id}.svg`}=e.style??{});let c=o??s??"#fff";return ix("div",{className:"provider",children:["oauth"===e.type||"oidc"===e.type?ix("form",{action:e.signinUrl,method:"POST",children:[ix("input",{type:"hidden",name:"csrfToken",value:t}),n&&ix("input",{type:"hidden",name:"callbackUrl",value:n}),ix("button",{type:"submit",className:"button",style:{"--provider-bg":"#fff","--provider-bg-hover":`color-mix(in srgb, ${c} 30%, #fff)`,"--provider-dark-bg":"#161b22","--provider-dark-bg-hover":`color-mix(in srgb, ${c} 30%, #000)`},tabIndex:0,children:[l&&ix("img",{loading:"lazy",height:24,width:24,id:"provider-logo",src:l}),ix("span",{style:{filter:"invert(1) grayscale(1) brightness(1.3) contrast(9000)","mix-blend-mode":"luminosity",opacity:.95},children:["Sign in with ",e.name]})]})]}):null,("email"===e.type||"credentials"===e.type||"webauthn"===e.type)&&i>0&&"email"!==r[i-1].type&&"credentials"!==r[i-1].type&&"webauthn"!==r[i-1].type&&ix("hr",{}),"email"===e.type&&ix("form",{action:e.signinUrl,method:"POST",children:[ix("input",{type:"hidden",name:"csrfToken",value:t}),ix("label",{className:"section-header",htmlFor:`input-email-for-${e.id}-provider`,children:"Email"}),ix("input",{id:`input-email-for-${e.id}-provider`,autoFocus:!0,type:"email",name:"email",value:a,placeholder:"email@example.com",required:!0}),ix("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),"credentials"===e.type&&ix("form",{action:e.callbackUrl,method:"POST",children:[ix("input",{type:"hidden",name:"csrfToken",value:t}),Object.keys(e.credentials).map(t=>ix("div",{children:[ix("label",{className:"section-header",htmlFor:`input-${t}-for-${e.id}-provider`,children:e.credentials[t].label??t}),ix("input",{name:t,id:`input-${t}-for-${e.id}-provider`,type:e.credentials[t].type??"text",placeholder:e.credentials[t].placeholder??"",...e.credentials[t]})]},`input-group-${e.id}`)),ix("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),"webauthn"===e.type&&ix("form",{action:e.callbackUrl,method:"POST",id:`${e.id}-form`,children:[ix("input",{type:"hidden",name:"csrfToken",value:t}),Object.keys(e.formFields).map(t=>ix("div",{children:[ix("label",{className:"section-header",htmlFor:`input-${t}-for-${e.id}-provider`,children:e.formFields[t].label??t}),ix("input",{name:t,"data-form-field":!0,id:`input-${t}-for-${e.id}-provider`,type:e.formFields[t].type??"text",placeholder:e.formFields[t].placeholder??"",...e.formFields[t]})]},`input-group-${e.id}`)),ix("button",{id:`submitButton-${e.id}`,type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),("email"===e.type||"credentials"===e.type||"webauthn"===e.type)&&i+1<r.length&&ix("hr",{})]},e.id)})]}),l&&ix(nX,{children:ix("script",{dangerouslySetInnerHTML:{__html:`
const currentURL = window.location.href;
const authURL = currentURL.substring(0, currentURL.lastIndexOf('/'));
(${iA})(authURL, "${l}");
`}})})]})}({csrfToken:e.csrfToken,providers:e.providers?.filter(e=>["email","oauth","oidc"].includes(e.type)||"credentials"===e.type&&e.credentials||"webauthn"===e.type&&e.formFields||!1),callbackUrl:e.callbackUrl,theme:e.theme,error:o,...n}),title:"Sign In",headTags:c})},signout:()=>a?.signOut?{redirect:a.signOut,cookies:i}:iO({cookies:i,theme:r,html:function(e){let{url:t,csrfToken:r,theme:n}=e;return ix("div",{className:"signout",children:[n?.brandColor&&ix("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${n.brandColor}
        }
      `}}),n?.buttonText&&ix("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${n.buttonText}
        }
      `}}),ix("div",{className:"card",children:[n?.logo&&ix("img",{src:n.logo,alt:"Logo",className:"logo"}),ix("h1",{children:"Signout"}),ix("p",{children:"Are you sure you want to sign out?"}),ix("form",{action:t?.toString(),method:"POST",children:[ix("input",{type:"hidden",name:"csrfToken",value:r}),ix("button",{id:"submitButton",type:"submit",children:"Sign out"})]})]})]})}({csrfToken:e.csrfToken,url:t,theme:r}),title:"Sign Out"}),verifyRequest:e=>a?.verifyRequest?{redirect:a.verifyRequest,cookies:i}:iO({cookies:i,theme:r,html:function(e){let{url:t,theme:r}=e;return ix("div",{className:"verify-request",children:[r.brandColor&&ix("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${r.brandColor}
        }
      `}}),ix("div",{className:"card",children:[r.logo&&ix("img",{src:r.logo,alt:"Logo",className:"logo"}),ix("h1",{children:"Check your email"}),ix("p",{children:"A sign in link has been sent to your email address."}),ix("p",{children:ix("a",{className:"site",href:t.origin,children:t.host})})]})]})}({url:t,theme:r,...e}),title:"Verify Request"}),error:e=>a?.error?{redirect:`${a.error}${a.error.includes("?")?"&":"?"}error=${e}`,cookies:i}:iO({cookies:i,theme:r,...function(e){let{url:t,error:r="default",theme:n}=e,i=`${t}/signin`,a={default:{status:200,heading:"Error",message:ix("p",{children:ix("a",{className:"site",href:t?.origin,children:t?.host})})},Configuration:{status:500,heading:"Server error",message:ix("div",{children:[ix("p",{children:"There is a problem with the server configuration."}),ix("p",{children:"Check the server logs for more information."})]})},AccessDenied:{status:403,heading:"Access Denied",message:ix("div",{children:[ix("p",{children:"You do not have permission to sign in."}),ix("p",{children:ix("a",{className:"button",href:i,children:"Sign in"})})]})},Verification:{status:403,heading:"Unable to sign in",message:ix("div",{children:[ix("p",{children:"The sign in link is no longer valid."}),ix("p",{children:"It may have been used already or it may have expired."})]}),signin:ix("a",{className:"button",href:i,children:"Sign in"})}},{status:s,heading:o,message:l,signin:c}=a[r]??a.default;return{status:s,html:ix("div",{className:"error",children:[n?.brandColor&&ix("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${n?.brandColor}
        }
      `}}),ix("div",{className:"card",children:[n?.logo&&ix("img",{src:n?.logo,alt:"Logo",className:"logo"}),ix("h1",{children:o}),ix("div",{className:"message",children:l}),c]})]})}}({url:t,theme:r,error:e}),title:"Error"})}}function iI(e,t=Date.now()){return new Date(t+1e3*e)}async function ij(e,t,r,n){if(!r?.providerAccountId||!r.type)throw Error("Missing or invalid provider account");if(!["email","oauth","oidc","webauthn"].includes(r.type))throw Error("Provider not supported");let{adapter:i,jwt:a,events:s,session:{strategy:o,generateSessionToken:l}}=n;if(!i)return{user:t,account:r};let c=r,{createUser:u,updateUser:d,getUser:h,getUserByAccount:p,getUserByEmail:f,linkAccount:g,createSession:y,getSessionAndUser:m,deleteSession:w}=i,b=null,v=null,_=!1,S="jwt"===o;if(e){if(S)try{let t=n.cookies.sessionToken.name;(b=await a.decode({...a,token:e,salt:t}))&&"sub"in b&&b.sub&&(v=await h(b.sub))}catch{}else{let t=await m(e);t&&(b=t.session,v=t.user)}}if("email"===c.type){let r=await f(t.email);return r?(v?.id!==r.id&&!S&&e&&await w(e),v=await d({id:r.id,emailVerified:new Date}),await s.updateUser?.({user:v})):(v=await u({...t,emailVerified:new Date}),await s.createUser?.({user:v}),_=!0),{session:b=S?{}:await y({sessionToken:l(),userId:v.id,expires:iI(n.session.maxAge)}),user:v,isNewUser:_}}if("webauthn"===c.type){let e=await p({providerAccountId:c.providerAccountId,provider:c.provider});if(e){if(v){if(e.id===v.id){let e={...c,userId:v.id};return{session:b,user:v,isNewUser:_,account:e}}throw new th("The account is already associated with another user",{provider:c.provider})}b=S?{}:await y({sessionToken:l(),userId:e.id,expires:iI(n.session.maxAge)});let t={...c,userId:e.id};return{session:b,user:e,isNewUser:_,account:t}}{if(v){await g({...c,userId:v.id}),await s.linkAccount?.({user:v,account:c,profile:t});let e={...c,userId:v.id};return{session:b,user:v,isNewUser:_,account:e}}if(t.email?await f(t.email):null)throw new th("Another account already exists with the same e-mail address",{provider:c.provider});v=await u({...t}),await s.createUser?.({user:v}),await g({...c,userId:v.id}),await s.linkAccount?.({user:v,account:c,profile:t}),b=S?{}:await y({sessionToken:l(),userId:v.id,expires:iI(n.session.maxAge)});let e={...c,userId:v.id};return{session:b,user:v,isNewUser:!0,account:e}}}let k=await p({providerAccountId:c.providerAccountId,provider:c.provider});if(k){if(v){if(k.id===v.id)return{session:b,user:v,isNewUser:_};throw new e4("The account is already associated with another user",{provider:c.provider})}return{session:b=S?{}:await y({sessionToken:l(),userId:k.id,expires:iI(n.session.maxAge)}),user:k,isNewUser:_}}{let{provider:e}=n,{type:r,provider:i,providerAccountId:a,userId:o,...d}=c;if(c=Object.assign(e.account(d)??{},{providerAccountId:a,provider:i,type:r,userId:o}),v)return await g({...c,userId:v.id}),await s.linkAccount?.({user:v,account:c,profile:t}),{session:b,user:v,isNewUser:_};let h=t.email?await f(t.email):null;if(h){let e=n.provider;if(e?.allowDangerousEmailAccountLinking)v=h;else throw new e4("Another account already exists with the same e-mail address",{provider:c.provider})}else v=await u({...t,emailVerified:null});return await s.createUser?.({user:v}),await g({...c,userId:v.id}),await s.linkAccount?.({user:v,account:c,profile:t}),{session:b=S?{}:await y({sessionToken:l(),userId:v.id,expires:iI(n.session.maxAge)}),user:v,isNewUser:!0}}}function iU(e,t){if(null==e)return!1;try{return e instanceof t||Object.getPrototypeOf(e)[Symbol.toStringTag]===t.prototype[Symbol.toStringTag]}catch{return!1}}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(s="oauth4webapi/v2.11.1");let i$=Symbol(),iN=Symbol(),iL=Symbol(),iD=(Symbol(),Symbol()),iM=new TextEncoder,iH=new TextDecoder;function iK(e){return"string"==typeof e?iM.encode(e):iH.decode(e)}function iW(e){return"string"==typeof e?function(e){try{let t=atob(e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}catch(e){throw new iV("The input to be decoded is not correctly encoded.",{cause:e})}}(e):function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));let t=[];for(let r=0;r<e.byteLength;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return btoa(t.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(e)}class iB{constructor(e){this.cache=new Map,this._cache=new Map,this.maxSize=e}get(e){let t=this.cache.get(e);return t||((t=this._cache.get(e))?(this.update(e,t),t):void 0)}has(e){return this.cache.has(e)||this._cache.has(e)}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this.update(e,t),this}delete(e){return this.cache.has(e)?this.cache.delete(e):!!this._cache.has(e)&&this._cache.delete(e)}update(e,t){this.cache.set(e,t),this.cache.size>=this.maxSize&&(this._cache=this.cache,this.cache=new Map)}}class iq extends Error{constructor(e){super(e??"operation not supported"),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class iJ extends Error{constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}let iV=iJ,iF=new iB(100);function iz(e){return e instanceof CryptoKey}function iG(e){return iz(e)&&"private"===e.type}function iX(e){try{let t=e.headers.get("dpop-nonce");t&&iF.set(new URL(e.url).origin,t)}catch{}return e}function iY(e){return!(null===e||"object"!=typeof e||Array.isArray(e))}function iZ(e){iU(e,Headers)&&(e=Object.fromEntries(e.entries()));let t=new Headers(e);if(s&&!t.has("user-agent")&&t.set("user-agent",s),t.has("authorization"))throw TypeError('"options.headers" must not include the "authorization" header name');if(t.has("dpop"))throw TypeError('"options.headers" must not include the "dpop" header name');return t}function iQ(e){if("function"==typeof e&&(e=e()),!(e instanceof AbortSignal))throw TypeError('"options.signal" must return or be an instance of AbortSignal');return e}async function i0(e,t){if(!(e instanceof URL))throw TypeError('"issuerIdentifier" must be an instance of URL');if("https:"!==e.protocol&&"http:"!==e.protocol)throw TypeError('"issuer.protocol" must be "https:" or "http:"');let r=new URL(e.href);switch(t?.algorithm){case void 0:case"oidc":r.pathname=`${r.pathname}/.well-known/openid-configuration`.replace("//","/");break;case"oauth2":"/"===r.pathname?r.pathname=".well-known/oauth-authorization-server":r.pathname=`.well-known/oauth-authorization-server/${r.pathname}`.replace("//","/");break;default:throw TypeError('"options.algorithm" must be "oidc" (default), or "oauth2"')}let n=iZ(t?.headers);return n.set("accept","application/json"),(t?.[iL]||fetch)(r.href,{headers:Object.fromEntries(n.entries()),method:"GET",redirect:"manual",signal:t?.signal?iQ(t.signal):null}).then(iX)}function i1(e){return"string"==typeof e&&0!==e.length}async function i2(e,t){let r;if(!(e instanceof URL))throw TypeError('"expectedIssuer" must be an instance of URL');if(!iU(t,Response))throw TypeError('"response" must be an instance of Response');if(200!==t.status)throw new iV('"response" is not a conform Authorization Server Metadata response');aL(t);try{r=await t.json()}catch(e){throw new iV('failed to parse "response" body as JSON',{cause:e})}if(!iY(r))throw new iV('"response" body must be a top level object');if(!i1(r.issuer))throw new iV('"response" body "issuer" property must be a non-empty string');if(new URL(r.issuer).href!==e.href)throw new iV('"response" body "issuer" does not match "expectedIssuer"');return r}function i3(){return iW(crypto.getRandomValues(new Uint8Array(32)))}async function i5(e){if(!i1(e))throw TypeError('"codeVerifier" must be a non-empty string');return iW(await crypto.subtle.digest("SHA-256",iK(e)))}function i4(e){return encodeURIComponent(e).replace(/%20/g,"+")}function i6(e){switch(e.algorithm.name){case"RSA-PSS":return function(e){switch(e.algorithm.hash.name){case"SHA-256":return"PS256";case"SHA-384":return"PS384";case"SHA-512":return"PS512";default:throw new iq("unsupported RsaHashedKeyAlgorithm hash name")}}(e);case"RSASSA-PKCS1-v1_5":return function(e){switch(e.algorithm.hash.name){case"SHA-256":return"RS256";case"SHA-384":return"RS384";case"SHA-512":return"RS512";default:throw new iq("unsupported RsaHashedKeyAlgorithm hash name")}}(e);case"ECDSA":return function(e){switch(e.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512";default:throw new iq("unsupported EcKeyAlgorithm namedCurve")}}(e);case"Ed25519":case"Ed448":return"EdDSA";default:throw new iq("unsupported CryptoKey algorithm name")}}function i8(e){let t=e?.[i$];return"number"==typeof t&&Number.isFinite(t)?t:0}function i9(e){let t=e?.[iN];return"number"==typeof t&&Number.isFinite(t)&&-1!==Math.sign(t)?t:30}function i7(){return Math.floor(Date.now()/1e3)}async function ae(e,t,r,n){return ao({alg:i6(r),kid:n},function(e,t){let r=i7()+i8(t);return{jti:i3(),aud:[e.issuer,e.token_endpoint],exp:r+60,iat:r,nbf:r,iss:t.client_id,sub:t.client_id}}(e,t),r)}function at(e){if("object"!=typeof e||null===e)throw TypeError('"as" must be an object');if(!i1(e.issuer))throw TypeError('"as.issuer" property must be a non-empty string');return!0}function ar(e){if("object"!=typeof e||null===e)throw TypeError('"client" must be an object');if(!i1(e.client_id))throw TypeError('"client.client_id" property must be a non-empty string');return!0}function an(e){if(!i1(e))throw TypeError('"client.client_secret" property must be a non-empty string');return e}function ai(e,t){if(void 0!==t)throw TypeError(`"options.clientPrivateKey" property must not be provided when ${e} client authentication method is used.`)}function aa(e,t){if(void 0!==t)throw TypeError(`"client.client_secret" property must not be provided when ${e} client authentication method is used.`)}async function as(e,t,r,n,i){switch(r.delete("client_secret"),r.delete("client_assertion_type"),r.delete("client_assertion"),t.token_endpoint_auth_method){case void 0:case"client_secret_basic":ai("client_secret_basic",i),n.set("authorization",function(e,t){let r=i4(e),n=i4(t),i=btoa(`${r}:${n}`);return`Basic ${i}`}(t.client_id,an(t.client_secret)));break;case"client_secret_post":ai("client_secret_post",i),r.set("client_id",t.client_id),r.set("client_secret",an(t.client_secret));break;case"private_key_jwt":{if(aa("private_key_jwt",t.client_secret),void 0===i)throw TypeError('"options.clientPrivateKey" must be provided when "client.token_endpoint_auth_method" is "private_key_jwt"');let{key:n,kid:a}=function(e){if(e instanceof CryptoKey)return{key:e};if(!(e?.key instanceof CryptoKey))return{};if(void 0!==e.kid&&!i1(e.kid))throw TypeError('"kid" must be a non-empty string');return{key:e.key,kid:e.kid}}(i);if(!iG(n))throw TypeError('"options.clientPrivateKey.key" must be a private CryptoKey');r.set("client_id",t.client_id),r.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),r.set("client_assertion",await ae(e,t,n,a));break}case"tls_client_auth":case"self_signed_tls_client_auth":case"none":aa(t.token_endpoint_auth_method,t.client_secret),ai(t.token_endpoint_auth_method,i),r.set("client_id",t.client_id);break;default:throw new iq("unsupported client token_endpoint_auth_method")}}async function ao(e,t,r){if(!r.usages.includes("sign"))throw TypeError('CryptoKey instances used for signing assertions must include "sign" in their "usages"');let n=`${iW(iK(JSON.stringify(e)))}.${iW(iK(JSON.stringify(t)))}`,i=iW(await crypto.subtle.sign(aH(r),r,iK(n)));return`${n}.${i}`}async function al(e,t,r,n,i,a){let{privateKey:s,publicKey:o,nonce:l=iF.get(r.origin)}=t;if(!iG(s))throw TypeError('"DPoP.privateKey" must be a private CryptoKey');if(!(iz(o)&&"public"===o.type))throw TypeError('"DPoP.publicKey" must be a public CryptoKey');if(void 0!==l&&!i1(l))throw TypeError('"DPoP.nonce" must be a non-empty string or undefined');if(!o.extractable)throw TypeError('"DPoP.publicKey.extractable" must be true');let c=i7()+i,u=await ao({alg:i6(s),typ:"dpop+jwt",jwk:await au(o)},{iat:c,jti:i3(),htm:n,nonce:l,htu:`${r.origin}${r.pathname}`,ath:a?iW(await crypto.subtle.digest("SHA-256",iK(a))):void 0},s);e.set("dpop",u)}async function ac(e){let{kty:t,e:r,n,x:i,y:a,crv:s}=await crypto.subtle.exportKey("jwk",e),l={kty:t,e:r,n,x:i,y:a,crv:s};return o.set(e,l),l}async function au(e){return o||(o=new WeakMap),o.get(e)||ac(e)}function ad(e,t,r){if("string"!=typeof e){if(r?.[iD])throw TypeError(`"as.mtls_endpoint_aliases.${t}" must be a string`);throw TypeError(`"as.${t}" must be a string`)}return new URL(e)}function ah(e,t,r){return r?.[iD]&&e.mtls_endpoint_aliases&&t in e.mtls_endpoint_aliases?ad(e.mtls_endpoint_aliases[t],t,r):ad(e[t],t)}function ap(e){return!("object"!=typeof e||Array.isArray(e))&&null!==e&&void 0!==e.error}let af=/((?:,|, )?[0-9a-zA-Z!#$%&'*+-.^_`|~]+=)/,ag=/(?:^|, ?)([0-9a-zA-Z!#$%&'*+\-.^_`|~]+)(?=$|[ ,])/g;async function ay(e,t,r,n,i,a){if(!i1(e))throw TypeError('"accessToken" must be a non-empty string');if(!(r instanceof URL))throw TypeError('"url" must be an instance of URL');return n=iZ(n),a?.DPoP===void 0?n.set("authorization",`Bearer ${e}`):(await al(n,a.DPoP,r,"GET",i8({[i$]:a?.[i$]}),e),n.set("authorization",`DPoP ${e}`)),(a?.[iL]||fetch)(r.href,{body:i,headers:Object.fromEntries(n.entries()),method:t,redirect:"manual",signal:a?.signal?iQ(a.signal):null}).then(iX)}async function am(e,t,r,n){at(e),ar(t);let i=ah(e,"userinfo_endpoint",n),a=iZ(n?.headers);return t.userinfo_signed_response_alg?a.set("accept","application/jwt"):(a.set("accept","application/json"),a.append("accept","application/jwt")),ay(r,"GET",i,a,null,{...n,[i$]:i8(t)})}let aw=Symbol();async function ab(e,t,r,n){let i;if(at(e),ar(t),!iU(n,Response))throw TypeError('"response" must be an instance of Response');if(200!==n.status)throw new iV('"response" is not a conform UserInfo Endpoint response');if("application/jwt"===n.headers.get("content-type")?.split(";")[0]){aL(n);let{claims:r}=await aW(await n.text(),aB.bind(void 0,t.userinfo_signed_response_alg,e.userinfo_signing_alg_values_supported),aK,i8(t),i9(t)).then(aT.bind(void 0,t.client_id)).then(aA.bind(void 0,e.issuer));i=r}else{if(t.userinfo_signed_response_alg)throw new iV("JWT UserInfo Response expected");aL(n);try{i=await n.json()}catch(e){throw new iV('failed to parse "response" body as JSON',{cause:e})}}if(!iY(i))throw new iV('"response" body must be a top level object');if(!i1(i.sub))throw new iV('"response" body "sub" property must be a non-empty string');if(r===aw);else{if(!i1(r))throw new iV('"expectedSubject" must be a non-empty string');if(i.sub!==r)throw new iV('unexpected "response" body "sub" value')}return i}async function av(e,t,r,n,i,a,s){return await as(e,t,i,a,s?.clientPrivateKey),a.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),(s?.[iL]||fetch)(n.href,{body:i,headers:Object.fromEntries(a.entries()),method:r,redirect:"manual",signal:s?.signal?iQ(s.signal):null}).then(iX)}async function a_(e,t,r,n,i){let a=ah(e,"token_endpoint",i);n.set("grant_type",r);let s=iZ(i?.headers);return s.set("accept","application/json"),i?.DPoP!==void 0&&await al(s,i.DPoP,a,"POST",i8(t)),av(e,t,"POST",a,n,s,i)}let aS=new WeakMap;function ak(e){if(!e.id_token)return;let t=aS.get(e);if(!t)throw TypeError('"ref" was already garbage collected or did not resolve from the proper sources');return t}async function aE(e,t,r,n=!1,i=!1){let a;if(at(e),ar(t),!iU(r,Response))throw TypeError('"response" must be an instance of Response');if(200!==r.status){let e;if(e=await aD(r))return e;throw new iV('"response" is not a conform Token Endpoint response')}aL(r);try{a=await r.json()}catch(e){throw new iV('failed to parse "response" body as JSON',{cause:e})}if(!iY(a))throw new iV('"response" body must be a top level object');if(!i1(a.access_token))throw new iV('"response" body "access_token" property must be a non-empty string');if(!i1(a.token_type))throw new iV('"response" body "token_type" property must be a non-empty string');if(a.token_type=a.token_type.toLowerCase(),"dpop"!==a.token_type&&"bearer"!==a.token_type)throw new iq("unsupported `token_type` value");if(void 0!==a.expires_in&&("number"!=typeof a.expires_in||a.expires_in<=0))throw new iV('"response" body "expires_in" property must be a positive number');if(!i&&void 0!==a.refresh_token&&!i1(a.refresh_token))throw new iV('"response" body "refresh_token" property must be a non-empty string');if(void 0!==a.scope&&"string"!=typeof a.scope)throw new iV('"response" body "scope" property must be a string');if(!n){if(void 0!==a.id_token&&!i1(a.id_token))throw new iV('"response" body "id_token" property must be a non-empty string');if(a.id_token){let{claims:r}=await aW(a.id_token,aB.bind(void 0,t.id_token_signed_response_alg,e.id_token_signing_alg_values_supported),aK,i8(t),i9(t)).then(aI.bind(void 0,["aud","exp","iat","iss","sub"])).then(aP.bind(void 0,e.issuer)).then(ax.bind(void 0,t.client_id));if(Array.isArray(r.aud)&&1!==r.aud.length&&r.azp!==t.client_id)throw new iV('unexpected ID Token "azp" (authorized party) claim value');if(void 0!==r.auth_time&&(!Number.isFinite(r.auth_time)||1!==Math.sign(r.auth_time)))throw new iV('ID Token "auth_time" (authentication time) must be a positive number');aS.set(a,r)}}return a}function aT(e,t){return void 0!==t.claims.aud?ax(e,t):t}function ax(e,t){if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e))throw new iV('unexpected JWT "aud" (audience) claim value')}else if(t.claims.aud!==e)throw new iV('unexpected JWT "aud" (audience) claim value');return t}function aA(e,t){return void 0!==t.claims.iss?aP(e,t):t}function aP(e,t){if(t.claims.iss!==e)throw new iV('unexpected JWT "iss" (issuer) claim value');return t}let aC=new WeakSet;async function aO(e,t,r,n,i,a){if(at(e),ar(t),!aC.has(r))throw TypeError('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()');if(!i1(n))throw TypeError('"redirectUri" must be a non-empty string');if(!i1(i))throw TypeError('"codeVerifier" must be a non-empty string');let s=aq(r,"code");if(!s)throw new iV('no authorization code in "callbackParameters"');let o=new URLSearchParams(a?.additionalParameters);return o.set("redirect_uri",n),o.set("code_verifier",i),o.set("code",s),a_(e,t,"authorization_code",o,a)}let aR={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation"};function aI(e,t){for(let r of e)if(void 0===t.claims[r])throw new iV(`JWT "${r}" (${aR[r]}) claim missing`);return t}let aj=Symbol(),aU=Symbol();async function a$(e,t,r,n,i){let a=await aE(e,t,r);if(ap(a))return a;if(!i1(a.id_token))throw new iV('"response" body "id_token" property must be a non-empty string');i??(i=t.default_max_age??aU);let s=ak(a);if((t.require_auth_time||i!==aU)&&void 0===s.auth_time)throw new iV('ID Token "auth_time" (authentication time) claim missing');if(i!==aU){if("number"!=typeof i||i<0)throw TypeError('"maxAge" must be a non-negative number');let e=i7()+i8(t),r=i9(t);if(s.auth_time+i<e-r)throw new iV("too much time has elapsed since the last End-User authentication")}switch(n){case void 0:case aj:if(void 0!==s.nonce)throw new iV('unexpected ID Token "nonce" claim value');break;default:if(!i1(n))throw TypeError('"expectedNonce" must be a non-empty string');if(void 0===s.nonce)throw new iV('ID Token "nonce" claim missing');if(s.nonce!==n)throw new iV('unexpected ID Token "nonce" claim value')}return a}async function aN(e,t,r){let n=await aE(e,t,r,!0);if(ap(n))return n;if(void 0!==n.id_token){if("string"==typeof n.id_token&&n.id_token.length)throw new iV("Unexpected ID Token returned, use processAuthorizationCodeOpenIDResponse() for OpenID Connect callback processing");delete n.id_token}return n}function aL(e){if(e.bodyUsed)throw TypeError('"response" body has been used already')}async function aD(e){if(e.status>399&&e.status<500){aL(e);try{let t=await e.json();if(iY(t)&&"string"==typeof t.error&&t.error.length)return void 0!==t.error_description&&"string"!=typeof t.error_description&&delete t.error_description,void 0!==t.error_uri&&"string"!=typeof t.error_uri&&delete t.error_uri,void 0!==t.algs&&"string"!=typeof t.algs&&delete t.algs,void 0!==t.scope&&"string"!=typeof t.scope&&delete t.scope,t}catch{}}}function aM(e){if("number"!=typeof e.modulusLength||e.modulusLength<2048)throw new iV(`${e.name} modulusLength must be at least 2048 bits`)}function aH(e){switch(e.algorithm.name){case"ECDSA":return{name:e.algorithm.name,hash:function(e){switch(e){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new iq}}(e.algorithm.namedCurve)};case"RSA-PSS":switch(aM(e.algorithm),e.algorithm.hash.name){case"SHA-256":case"SHA-384":case"SHA-512":return{name:e.algorithm.name,saltLength:parseInt(e.algorithm.hash.name.slice(-3),10)>>3};default:throw new iq}case"RSASSA-PKCS1-v1_5":return aM(e.algorithm),e.algorithm.name;case"Ed448":case"Ed25519":return e.algorithm.name}throw new iq}let aK=Symbol();async function aW(e,t,r,n,i){let a,s,o;let{0:l,1:c,2:u,length:d}=e.split(".");if(5===d)throw new iq("JWE structure JWTs are not supported");if(3!==d)throw new iV("Invalid JWT");try{a=JSON.parse(iK(iW(l)))}catch(e){throw new iV("failed to parse JWT Header body as base64url encoded JSON",{cause:e})}if(!iY(a))throw new iV("JWT Header must be a top level object");if(t(a),void 0!==a.crit)throw new iV('unexpected JWT "crit" header parameter');let h=iW(u);if(r!==aK){s=await r(a);let e=`${l}.${c}`;if(!await crypto.subtle.verify(aH(s),s,h,iK(e)))throw new iV("JWT signature verification failed")}try{o=JSON.parse(iK(iW(c)))}catch(e){throw new iV("failed to parse JWT Payload body as base64url encoded JSON",{cause:e})}if(!iY(o))throw new iV("JWT Payload must be a top level object");let p=i7()+n;if(void 0!==o.exp){if("number"!=typeof o.exp)throw new iV('unexpected JWT "exp" (expiration time) claim type');if(o.exp<=p-i)throw new iV('unexpected JWT "exp" (expiration time) claim value, timestamp is <= now()')}if(void 0!==o.iat&&"number"!=typeof o.iat)throw new iV('unexpected JWT "iat" (issued at) claim type');if(void 0!==o.iss&&"string"!=typeof o.iss)throw new iV('unexpected JWT "iss" (issuer) claim type');if(void 0!==o.nbf){if("number"!=typeof o.nbf)throw new iV('unexpected JWT "nbf" (not before) claim type');if(o.nbf>p+i)throw new iV('unexpected JWT "nbf" (not before) claim value, timestamp is > now()')}if(void 0!==o.aud&&"string"!=typeof o.aud&&!Array.isArray(o.aud))throw new iV('unexpected JWT "aud" (audience) claim type');return{header:a,claims:o,signature:h,key:s}}function aB(e,t,r){if(void 0!==e){if(r.alg!==e)throw new iV('unexpected JWT "alg" header parameter');return}if(Array.isArray(t)){if(!t.includes(r.alg))throw new iV('unexpected JWT "alg" header parameter');return}if("RS256"!==r.alg)throw new iV('unexpected JWT "alg" header parameter')}function aq(e,t){let{0:r,length:n}=e.getAll(t);if(n>1)throw new iV(`"${t}" parameter must be provided only once`);return r}let aJ=Symbol(),aV=Symbol();async function aF(e,t,r,n,i){let{cookies:a,logger:s}=n;s.debug(`CREATE_${e.toUpperCase()}`,{value:t,maxAge:r});let o=new Date;o.setTime(o.getTime()+1e3*r);let l={value:t};"state"===e&&i&&(l.data=i);let c=a[e].name;return{name:c,value:await r7({...n.jwt,maxAge:r,token:l,salt:c}),options:{...a[e].options,expires:o}}}let az={async create(e){let t=i3(),r=await i5(t);return{cookie:await aF("pkceCodeVerifier",t,900,e),value:r}},async use(e,t,r){let{provider:n}=r;if(!n?.checks?.includes("pkce"))return;let i=e?.[r.cookies.pkceCodeVerifier.name];if(!i)throw new eQ("PKCE code_verifier cookie was missing");let a=await ne({...r.jwt,token:i,salt:r.cookies.pkceCodeVerifier.name});if(!a?.value)throw new eQ("PKCE code_verifier value could not be parsed");return t.push({name:r.cookies.pkceCodeVerifier.name,value:"",options:{...r.cookies.pkceCodeVerifier.options,maxAge:0}}),a.value}};function aG(e){try{let t=new TextDecoder;return JSON.parse(t.decode(tH(e)))}catch{}}let aX={async create(e,t){let{provider:r}=e;if(!r.checks.includes("state")){if(t)throw new eQ("State data was provided but the provider is not configured to use state");return}let n=tD(JSON.stringify({...t,random:i3()}));return{cookie:await aF("state",n,900,e,t),value:n}},async use(e,t,r,n){let{provider:i}=r;if(!i.checks.includes("state"))return;let a=e?.[r.cookies.state.name];if(!a)throw new eQ("State cookie was missing");let s=await ne({...r.jwt,token:a,salt:r.cookies.state.name});if(!s?.value)throw new eQ("State (cookie) value could not be parsed");let o=aG(s.value);if(!o)throw new eQ("State (encoded) value could not be parsed");if(o.random!==n)throw new eQ(`Random state values did not match. Expected: ${o.random}. Got: ${n}`);return t.push({name:r.cookies.state.name,value:"",options:{...r.cookies.state.options,maxAge:0}}),s.value}},aY={async create(e){if(!e.provider.checks.includes("nonce"))return;let t=i3();return{cookie:await aF("nonce",t,900,e),value:t}},async use(e,t,r){let{provider:n}=r;if(!n?.checks?.includes("nonce"))return;let i=e?.[r.cookies.nonce.name];if(!i)throw new eQ("Nonce cookie was missing");let a=await ne({...r.jwt,token:i,salt:r.cookies.nonce.name});if(!a?.value)throw new eQ("Nonce value could not be parsed");return t.push({name:r.cookies.nonce.name,value:"",options:{...r.cookies.nonce.options,maxAge:0}}),a.value}},aZ={create:async(e,t,r)=>({cookie:await aF("webauthnChallenge",JSON.stringify({challenge:t,registerData:r}),900,e)}),async use(e,t,r){let n=t?.[e.cookies.webauthnChallenge.name];if(!n)throw new eQ("Challenge cookie missing");let i=await ne({...e.jwt,token:n,salt:e.cookies.webauthnChallenge.name});if(!i?.value)throw new eQ("Challenge value could not be parsed");let a={name:e.cookies.webauthnChallenge.name,value:"",options:{...e.cookies.webauthnChallenge.options,maxAge:0}};return r.push(a),JSON.parse(i.value)}};async function aQ(e,t,r,n){let i,a,s;let{logger:o,provider:l}=r,{token:c,userinfo:u}=l;if(c?.url&&"authjs.dev"!==c.url.host||u?.url&&"authjs.dev"!==u.url.host)i={issuer:l.issuer??"https://authjs.dev",token_endpoint:c?.url.toString(),userinfo_endpoint:u?.url.toString()};else{let e=new URL(l.issuer),t=await i0(e),r=await i2(e,t);if(!r.token_endpoint)throw TypeError("TODO: Authorization server did not provide a token endpoint.");if(!r.userinfo_endpoint)throw TypeError("TODO: Authorization server did not provide a userinfo endpoint.");i=r}let d={client_id:l.clientId,client_secret:l.clientSecret,...l.client},h=[],p=await aX.use(t,h,r,n),f=function(e,t,r,n){var i;if(at(e),ar(t),r instanceof URL&&(r=r.searchParams),!(r instanceof URLSearchParams))throw TypeError('"parameters" must be an instance of URLSearchParams, or URL');if(aq(r,"response"))throw new iV('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()');let a=aq(r,"iss"),s=aq(r,"state");if(!a&&e.authorization_response_iss_parameter_supported)throw new iV('response parameter "iss" (issuer) missing');if(a&&a!==e.issuer)throw new iV('unexpected "iss" (issuer) response parameter value');switch(n){case void 0:case aV:if(void 0!==s)throw new iV('unexpected "state" response parameter encountered');break;case aJ:break;default:if(!i1(n))throw new iV('"expectedState" must be a non-empty string');if(void 0===s)throw new iV('response parameter "state" missing');if(s!==n)throw new iV('unexpected "state" response parameter value')}let o=aq(r,"error");if(o)return{error:o,error_description:aq(r,"error_description"),error_uri:aq(r,"error_uri")};let l=aq(r,"id_token"),c=aq(r,"token");if(void 0!==l||void 0!==c)throw new iq("implicit and hybrid flows are not supported");return i=new URLSearchParams(r),aC.add(i),i}(i,d,new URLSearchParams(e),l.checks.includes("state")?p:aJ);if(ap(f)){let e={providerId:l.id,...f};throw o.debug("OAuthCallbackError",e),new e6("OAuth Provider returned an error",e)}let g=await az.use(t,h,r),y=l.callbackUrl;!r.isOnRedirectProxy&&l.redirectProxyUrl&&(y=l.redirectProxyUrl);let m=await aO(i,d,f,y,g??"auth",{[iL]:(...e)=>(!l.checks.includes("pkce")&&e[1]?.body instanceof URLSearchParams&&e[1].body.delete("code_verifier"),fetch(...e)),clientPrivateKey:l.token?.clientPrivateKey});if(l.token?.conform&&(m=await l.token.conform(m.clone())??m),a=function(e){if(!iU(e,Response))throw TypeError('"response" must be an instance of Response');let t=e.headers.get("www-authenticate");if(null===t)return;let r=[];for(let{1:e,index:n}of t.matchAll(ag))r.push([e,n]);if(r.length)return r.map(([e,r],n,i)=>{let a=i[n+1];return function(e,t){let r=t.split(af).slice(1);if(!r.length)return{scheme:e.toLowerCase(),parameters:{}};r[r.length-1]=r[r.length-1].replace(/,$/,"");let n={};for(let e=1;e<r.length;e+=2){var i;let t=e;if('"'===r[t][0])for(;'"'!==r[t].slice(-1)&&++e<r.length;)r[t]+=r[e];n[r[t-1].replace(/^(?:, ?)|=$/g,"").toLowerCase()]=(i=r[t]).length>=2&&'"'===i[0]&&'"'===i[i.length-1]?i.slice(1,-1):i}return{scheme:e.toLowerCase(),parameters:n}}(e,a?t.slice(r,a[1]):t.slice(r))})}(m)){for(let e of a)console.log("challenge",e);throw Error("TODO: Handle www-authenticate challenges as needed")}let w={};if("oidc"===l.type){let e=await aY.use(t,h,r),n=await a$(i,d,m,e??aj);if(ap(n))throw console.log("error",n),Error("TODO: Handle OIDC response body error");let a=ak(n);if(w=a,!1===l.idToken){let e=await am(i,d,n.access_token);w=await ab(i,d,a.sub,e)}s=n}else{let e=await aN(i,d,m);if(s=e,ap(e))throw console.log("error",e),Error("TODO: Handle OAuth 2.0 response body error");if(u?.request){let e=await u.request({tokens:s,provider:l});e instanceof Object&&(w=e)}else if(u?.url){let t=await am(i,d,e.access_token);w=await t.json()}else throw TypeError("No userinfo endpoint configured")}return s.expires_in&&(s.expires_at=Math.floor(Date.now()/1e3)+Number(s.expires_in)),{...await a0(w,l,s,o),profile:w,cookies:h}}async function a0(e,t,r,n){try{let n=await t.profile(e,r);return{user:{...n,id:crypto.randomUUID(),email:n.email?.toLowerCase()},account:{...r,provider:t.id,type:t.type,providerAccountId:n.id??crypto.randomUUID()}}}catch(r){n.debug("getProfile error details",e),n.error(new e8(r,{provider:t.id}))}}var a1=r(195).Buffer;async function a2(e,t,r,n){let i=await a8(e,t,r),{cookie:a}=await aZ.create(e,i.challenge,r);return{status:200,cookies:[...n??[],a],body:{action:"register",options:i},headers:{"Content-Type":"application/json"}}}async function a3(e,t,r,n){let i=await a6(e,t,r),{cookie:a}=await aZ.create(e,i.challenge);return{status:200,cookies:[...n??[],a],body:{action:"authenticate",options:i},headers:{"Content-Type":"application/json"}}}async function a5(e,t,r){let n;let{adapter:i,provider:a}=e,s=t.body&&"string"==typeof t.body.data?JSON.parse(t.body.data):void 0;if(!s||"object"!=typeof s||!("id"in s)||"string"!=typeof s.id)throw new eB("Invalid WebAuthn Authentication response");let o=se(a7(s.id)),l=await i.getAuthenticator(o);if(!l)throw new eB(`WebAuthn authenticator not found in database: ${JSON.stringify({credentialID:o})}`);let{challenge:c}=await aZ.use(e,t.cookies,r);try{let r=a.getRelayingParty(e,t);n=await a.simpleWebAuthn.verifyAuthenticationResponse({...a.verifyAuthenticationOptions,expectedChallenge:c,response:s,authenticator:{...l,credentialDeviceType:l.credentialDeviceType,transports:st(l.transports),credentialID:a7(l.credentialID),credentialPublicKey:a7(l.credentialPublicKey)},expectedOrigin:r.origin,expectedRPID:r.id})}catch(e){throw new td(e)}let{verified:u,authenticationInfo:d}=n;if(!u)throw new td("WebAuthn authentication response could not be verified");try{let{newCounter:e}=d;await i.updateAuthenticatorCounter(l.credentialID,e)}catch(e){throw new eJ(`Failed to update authenticator counter. This may cause future authentication attempts to fail. ${JSON.stringify({credentialID:o,oldCounter:l.counter,newCounter:d.newCounter})}`,e)}let h=await i.getAccount(l.providerAccountId,a.id);if(!h)throw new eB(`WebAuthn account not found in database: ${JSON.stringify({credentialID:o,providerAccountId:l.providerAccountId})}`);let p=await i.getUser(h.userId);if(!p)throw new eB(`WebAuthn user not found in database: ${JSON.stringify({credentialID:o,providerAccountId:l.providerAccountId,userID:h.userId})}`);return{account:h,user:p}}async function a4(e,t,r){var n;let i;let{provider:a}=e,s=t.body&&"string"==typeof t.body.data?JSON.parse(t.body.data):void 0;if(!s||"object"!=typeof s||!("id"in s)||"string"!=typeof s.id)throw new eB("Invalid WebAuthn Registration response");let{challenge:o,registerData:l}=await aZ.use(e,t.cookies,r);if(!l)throw new eB("Missing user registration data in WebAuthn challenge cookie");try{let r=a.getRelayingParty(e,t);i=await a.simpleWebAuthn.verifyRegistrationResponse({...a.verifyRegistrationOptions,expectedChallenge:o,response:s,expectedOrigin:r.origin,expectedRPID:r.id})}catch(e){throw new td(e)}if(!i.verified||!i.registrationInfo)throw new td("WebAuthn registration response could not be verified");let c={providerAccountId:se(i.registrationInfo.credentialID),provider:e.provider.id,type:a.type},u={providerAccountId:c.providerAccountId,counter:i.registrationInfo.counter,credentialID:se(i.registrationInfo.credentialID),credentialPublicKey:se(i.registrationInfo.credentialPublicKey),credentialBackedUp:i.registrationInfo.credentialBackedUp,credentialDeviceType:i.registrationInfo.credentialDeviceType,transports:(n=s.response.transports,n?.join(","))};return{user:l,account:c,authenticator:u}}async function a6(e,t,r){let{provider:n,adapter:i}=e,a=r&&r.id?await i.listAuthenticatorsByUserId(r.id):null,s=n.getRelayingParty(e,t);return await n.simpleWebAuthn.generateAuthenticationOptions({...n.authenticationOptions,rpID:s.id,allowCredentials:a?.map(e=>({id:a7(e.credentialID),type:"public-key",transports:st(e.transports)}))})}async function a8(e,t,r){let{provider:n,adapter:i}=e,a=r.id?await i.listAuthenticatorsByUserId(r.id):null,s=nd(32),o=n.getRelayingParty(e,t);return await n.simpleWebAuthn.generateRegistrationOptions({...n.registrationOptions,userID:s,userName:r.email,userDisplayName:r.name??void 0,rpID:o.id,rpName:o.name,excludeCredentials:a?.map(e=>({id:a7(e.credentialID),type:"public-key",transports:st(e.transports)}))})}function a9(e){let{provider:t,adapter:r}=e;if(!r)throw new e1("An adapter is required for the WebAuthn provider");if(!t||"webauthn"!==t.type)throw new ti("Provider must be WebAuthn");return{...e,provider:t,adapter:r}}function a7(e){return new Uint8Array(a1.from(e,"base64"))}function se(e){return a1.from(e).toString("base64")}function st(e){return e?e.split(","):void 0}async function sr(e,t,r,n){if(!t.provider)throw new ti("Callback route called without provider");let{query:i,body:a,method:s,headers:o}=e,{provider:l,adapter:c,url:u,callbackUrl:d,pages:h,jwt:p,events:f,callbacks:g,session:{strategy:y,maxAge:m},logger:w}=t,b="jwt"===y;try{if("oauth"===l.type||"oidc"===l.type){let s;let o=l.authorization?.url.searchParams.get("response_mode")==="form_post"?a:i,{proxyRedirect:y,randomState:v}=function(e,t,r){let n,i;if(t.redirectProxyUrl&&!e?.state)throw new eQ("Missing state in query, but required for redirect proxy");let a=aG(e?.state);if(n=a?.random,r){if(!a?.origin)return{randomState:n};i=`${a.origin}?${new URLSearchParams(e)}`}return{randomState:n,proxyRedirect:i}}(o,l,t.isOnRedirectProxy);if(y)return w.debug("proxy redirect",{proxyRedirect:y,randomState:v}),{redirect:y};let _=await aQ(o,e.cookies,t,v);_.cookies.length&&n.push(..._.cookies),w.debug("authorization result",_);let{user:S,account:k,profile:E}=_;if(!S||!k||!E)return{redirect:`${u}/signin`,cookies:n};if(c){let{getUserByAccount:e}=c;s=await e({providerAccountId:k.providerAccountId,provider:l.id})}let T=await sn({user:s??S,account:k,profile:E},t);if(T)return{redirect:T,cookies:n};let{user:x,session:A,isNewUser:P}=await ij(r.value,S,k,t);if(b){let e={name:x.name,email:x.email,picture:x.image,sub:x.id?.toString()},i=await g.jwt({token:e,user:x,account:k,profile:E,isNewUser:P,trigger:P?"signUp":"signIn"});if(null===i)n.push(...r.clean());else{let e=t.cookies.sessionToken.name,a=await p.encode({...p,token:i,salt:e}),s=new Date;s.setTime(s.getTime()+1e3*m);let o=r.chunk(a,{expires:s});n.push(...o)}}else n.push({name:t.cookies.sessionToken.name,value:A.sessionToken,options:{...t.cookies.sessionToken.options,expires:A.expires}});if(await f.signIn?.({user:x,account:k,profile:E,isNewUser:P}),P&&h.newUser)return{redirect:`${h.newUser}${h.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:d})}`,cookies:n};return{redirect:d,cookies:n}}if("email"===l.type){let e=i?.token,a=i?.email;if(!e||!a){let t=TypeError("Missing token or email. The sign-in URL was manually opened without token/identifier or the link was not sent correctly in the email.",{cause:{hasToken:!!e,hasEmail:!!a}});throw t.name="Configuration",t}let s=l.secret??t.secret,o=await c.useVerificationToken({identifier:a,token:await nu(`${e}${s}`)}),u=!!o,y=o?o.expires.valueOf()<Date.now():void 0;if(!u||y)throw new ts({hasInvite:u,expired:y});let w=await c.getUserByEmail(a)??{id:crypto.randomUUID(),email:a,emailVerified:null},v={providerAccountId:w.email,userId:w.id,type:"email",provider:l.id},_=await sn({user:w,account:v},t);if(_)return{redirect:_,cookies:n};let{user:S,session:k,isNewUser:E}=await ij(r.value,w,v,t);if(b){let e={name:S.name,email:S.email,picture:S.image,sub:S.id?.toString()},i=await g.jwt({token:e,user:S,account:v,isNewUser:E,trigger:E?"signUp":"signIn"});if(null===i)n.push(...r.clean());else{let e=t.cookies.sessionToken.name,a=await p.encode({...p,token:i,salt:e}),s=new Date;s.setTime(s.getTime()+1e3*m);let o=r.chunk(a,{expires:s});n.push(...o)}}else n.push({name:t.cookies.sessionToken.name,value:k.sessionToken,options:{...t.cookies.sessionToken.options,expires:k.expires}});if(await f.signIn?.({user:S,account:v,isNewUser:E}),E&&h.newUser)return{redirect:`${h.newUser}${h.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:d})}`,cookies:n};return{redirect:d,cookies:n}}if("credentials"===l.type&&"POST"===s){let e=a??{};Object.entries(i??{}).forEach(([e,t])=>u.searchParams.set(e,t));let c=await l.authorize(e,new Request(u,{headers:o,method:s,body:JSON.stringify(a)}));if(c)c.id=c.id?.toString()??crypto.randomUUID();else throw new eY;let h={providerAccountId:c.id,type:"credentials",provider:l.id},y=await sn({user:c,account:h,credentials:e},t);if(y)return{redirect:y,cookies:n};let w={name:c.name,email:c.email,picture:c.image,sub:c.id},b=await g.jwt({token:w,user:c,account:h,isNewUser:!1,trigger:"signIn"});if(null===b)n.push(...r.clean());else{let e=t.cookies.sessionToken.name,i=await p.encode({...p,token:b,salt:e}),a=new Date;a.setTime(a.getTime()+1e3*m);let s=r.chunk(i,{expires:a});n.push(...s)}return await f.signIn?.({user:c,account:h}),{redirect:d,cookies:n}}if("webauthn"===l.type&&"POST"===s){let i,a,s;let o=e.body?.action;if("string"!=typeof o||"authenticate"!==o&&"register"!==o)throw new eB("Invalid action parameter");let l=a9(t);switch(o){case"authenticate":{let t=await a5(l,e,n);i=t.user,a=t.account;break}case"register":{let r=await a4(t,e,n);i=r.user,a=r.account,s=r.authenticator}}await sn({user:i,account:a},t);let{user:c,isNewUser:u,session:y,account:w}=await ij(r.value,i,a,t);if(!w)throw new eB("Error creating or finding account");if(s&&c.id&&await l.adapter.createAuthenticator({...s,userId:c.id}),b){let e={name:c.name,email:c.email,picture:c.image,sub:c.id?.toString()},i=await g.jwt({token:e,user:c,account:w,isNewUser:u,trigger:u?"signUp":"signIn"});if(null===i)n.push(...r.clean());else{let e=t.cookies.sessionToken.name,a=await p.encode({...p,token:i,salt:e}),s=new Date;s.setTime(s.getTime()+1e3*m);let o=r.chunk(a,{expires:s});n.push(...o)}}else n.push({name:t.cookies.sessionToken.name,value:y.sessionToken,options:{...t.cookies.sessionToken.options,expires:y.expires}});if(await f.signIn?.({user:c,account:w,isNewUser:u}),u&&h.newUser)return{redirect:`${h.newUser}${h.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:d})}`,cookies:n};return{redirect:d,cookies:n}}throw new ti(`Callback for provider type (${l.type}) is not supported`)}catch(t){if(t instanceof eB)throw t;let e=new eF(t,{provider:l.id});throw w.debug("callback route error details",{method:s,query:i,body:a}),e}}async function sn(e,t){let r;let{signIn:n,redirect:i}=t.callbacks;try{r=await n(e)}catch(e){if(e instanceof eB)throw e;throw new eV(e)}if(!r)throw new eV("AccessDenied");if("string"==typeof r)return await i({url:r,baseUrl:t.url.origin})}async function si(e,t,r,n,i){let{adapter:a,jwt:s,events:o,callbacks:l,logger:c,session:{strategy:u,maxAge:d}}=e,h={body:null,headers:{"Content-Type":"application/json"},cookies:r},p=t.value;if(!p)return h;if("jwt"===u){try{let r=e.cookies.sessionToken.name,a=await s.decode({...s,token:p,salt:r});if(!a)throw Error("Invalid JWT");let c=await l.jwt({token:a,...n&&{trigger:"update"},session:i}),u=iI(d);if(null!==c){let e={user:{name:c.name,email:c.email,image:c.picture},expires:u.toISOString()},n=await l.session({session:e,token:c});h.body=n;let i=await s.encode({...s,token:c,salt:r}),a=t.chunk(i,{expires:u});h.cookies?.push(...a),await o.session?.({session:n,token:c})}else h.cookies?.push(...t.clean())}catch(e){c.error(new e0(e)),h.cookies?.push(...t.clean())}return h}try{let{getSessionAndUser:r,deleteSession:s,updateSession:c}=a,u=await r(p);if(u&&u.session.expires.valueOf()<Date.now()&&(await s(p),u=null),u){let{user:t,session:r}=u,a=e.session.updateAge,s=r.expires.valueOf()-1e3*d+1e3*a,f=iI(d);s<=Date.now()&&await c({sessionToken:p,expires:f});let g=await l.session({session:{...r,user:t},user:t,newSession:i,...n?{trigger:"update"}:{}});h.body=g,h.cookies?.push({name:e.cookies.sessionToken.name,value:p,options:{...e.cookies.sessionToken.options,expires:f}}),await o.session?.({session:g})}else p&&h.cookies?.push(...t.clean())}catch(e){c.error(new e9(e))}return h}async function sa(e,t){let r,n;let{logger:i,provider:a}=t,s=a.authorization?.url;if(!s||"authjs.dev"===s.host){let e=new URL(a.issuer),t=await i0(e),r=await i2(e,t);if(!r.authorization_endpoint)throw TypeError("Authorization server did not provide an authorization endpoint.");s=new URL(r.authorization_endpoint)}let o=s.searchParams,l=a.callbackUrl;!t.isOnRedirectProxy&&a.redirectProxyUrl&&(l=a.redirectProxyUrl,n={origin:a.callbackUrl},i.debug("using redirect proxy",{redirect_uri:l,data:n}));let c=Object.assign({response_type:"code",client_id:a.clientId,redirect_uri:l,...a.authorization?.params},Object.fromEntries(a.authorization?.url.searchParams??[]),e);for(let e in c)o.set(e,c[e]);let u=[],d=await aX.create(t,n);if(d&&(o.set("state",d.value),u.push(d.cookie)),a.checks?.includes("pkce")){if(r&&!r.code_challenge_methods_supported?.includes("S256"))"oidc"===a.type&&(a.checks=["nonce"]);else{let{value:e,cookie:r}=await az.create(t);o.set("code_challenge",e),o.set("code_challenge_method","S256"),u.push(r)}}let h=await aY.create(t);return h&&(o.set("nonce",h.value),u.push(h.cookie)),"oidc"!==a.type||s.searchParams.has("scope")||s.searchParams.set("scope","openid profile email"),i.debug("authorization url is ready",{url:s,cookies:u,provider:a}),{redirect:s.toString(),cookies:u}}async function ss(e,t){let r;let{body:n}=e,{provider:i,callbacks:a,adapter:s}=t,o=(i.normalizeIdentifier??function(e){if(!e)throw Error("Missing email from request body.");let[t,r]=e.toLowerCase().trim().split("@");return r=r.split(",")[0],`${t}@${r}`})(n?.email),l={id:crypto.randomUUID(),email:o,emailVerified:null},c=await s.getUserByEmail(o)??l,u={providerAccountId:o,userId:c.id,type:"email",provider:i.id};try{r=await a.signIn({user:c,account:u,email:{verificationRequest:!0}})}catch(e){throw new eV(e)}if(!r)throw new eV("AccessDenied");if("string"==typeof r)return{redirect:await a.redirect({url:r,baseUrl:t.url.origin})};let{callbackUrl:d,theme:h}=t,p=await i.generateVerificationToken?.()??nd(32),f=new Date(Date.now()+(i.maxAge??86400)*1e3),g=i.secret??t.secret,y=new URL(t.basePath,t.url.origin),m=i.sendVerificationRequest({identifier:o,token:p,expires:f,url:`${y}/callback/${i.id}?${new URLSearchParams({callbackUrl:d,token:p,email:o})}`,provider:i,theme:h,request:new Request(e.url,{headers:e.headers,method:e.method,body:"POST"===e.method?JSON.stringify(e.body??{}):void 0})}),w=s.createVerificationToken?.({identifier:o,token:await nu(`${p}${g}`),expires:f});return await Promise.all([m,w]),{redirect:`${y}/verify-request?${new URLSearchParams({provider:i.id,type:i.type})}`}}async function so(e,t,r){let n=`${r.url.origin}${r.basePath}/signin`;if(!r.provider)return{redirect:n,cookies:t};switch(r.provider.type){case"oauth":case"oidc":{let{redirect:n,cookies:i}=await sa(e.query,r);return i&&t.push(...i),{redirect:n,cookies:t}}case"email":return{...await ss(e,r),cookies:t};default:return{redirect:n,cookies:t}}}async function sl(e,t,r){let{jwt:n,events:i,callbackUrl:a,logger:s,session:o}=r,l=t.value;if(!l)return{redirect:a,cookies:e};try{if("jwt"===o.strategy){let e=r.cookies.sessionToken.name,t=await n.decode({...n,token:l,salt:e});await i.signOut?.({token:t})}else{let e=await r.adapter?.deleteSession(l);await i.signOut?.({session:e})}}catch(e){s.error(new tt(e))}return e.push(...t.clean()),{redirect:a,cookies:e}}async function sc(e,t){let{adapter:r,jwt:n,session:{strategy:i}}=e,a=t.value;if(!a)return null;if("jwt"===i){let t=e.cookies.sessionToken.name,r=await n.decode({...n,token:a,salt:t});if(r&&r.sub)return{id:r.sub,name:r.name,email:r.email,image:r.picture}}else{let e=await r?.getSessionAndUser(a);if(e)return e.user}return null}async function su(e,t,r,n){let i=a9(t),{provider:a}=i,{action:s}=e.query??{};if("register"!==s&&"authenticate"!==s&&void 0!==s)return{status:400,body:{error:"Invalid action"},cookies:n,headers:{"Content-Type":"application/json"}};let o=await sc(t,r),l=o?{user:o,exists:!0}:await a.getUserInfo(t,e),c=l?.user;switch(function(e,t,r){let{user:n,exists:i=!1}=r??{};switch(e){case"authenticate":return"authenticate";case"register":if(n&&t===i)return"register";break;case void 0:if(!t){if(!n||i)return"authenticate";return"register"}}return null}(s,!!o,l)){case"authenticate":return a3(i,e,c,n);case"register":if("string"==typeof c?.email)return a2(i,e,c,n);default:return{status:400,body:{error:"Invalid request"},cookies:n,headers:{"Content-Type":"application/json"}}}}async function sd(e,t){let{action:r,providerId:n,error:i,method:a}=e,s=t.skipCSRFCheck===sh,{options:o,cookies:l}=await n_({authOptions:t,action:r,providerId:n,url:e.url,callbackUrl:e.body?.callbackUrl??e.query?.callbackUrl,csrfToken:e.body?.csrfToken,cookies:e.cookies,isPost:"POST"===a,csrfDisabled:s}),c=new eW(o.cookies.sessionToken,e.cookies,o.logger);if("GET"===a){let t=iR({...o,query:e.query,cookies:l});switch(r){case"callback":return await sr(e,o,c,l);case"csrf":return t.csrf(s,o,l);case"error":return t.error(i);case"providers":return t.providers(o.providers);case"session":return await si(o,c,l);case"signin":return t.signin(n,i);case"signout":return t.signout();case"verify-request":return t.verifyRequest();case"webauthn-options":return await su(e,o,c,l)}}else{let{csrfTokenVerified:t}=o;switch(r){case"callback":return"credentials"===o.provider.type&&np(r,t),await sr(e,o,c,l);case"session":return np(r,t),await si(o,c,l,!0,e.body?.data);case"signin":return np(r,t),await so(e,l,o);case"signout":return np(r,t),await sl(l,c,o)}}throw new tr(`Cannot handle action: ${r}`)}let sh=Symbol("skip-csrf-check"),sp=Symbol("return-type-raw");function sf(e,t,r,n,i){let a,s=n.AUTH_URL??n.NEXTAUTH_URL;if(s)a=new URL(s),i&&"/"!==i&&"/"!==a.pathname&&(na.warn(a.pathname===i?"env-url-basepath-redundant":"env-url-basepath-mismatch"),a.pathname="/");else{let e=r.get("x-forwarded-host")??r.get("host"),n=r.get("x-forwarded-proto")??t??"https",i=n.endsWith(":")?n:n+":";a=new URL(`${i}//${e}`)}let o=a.toString().replace(/\/$/,"");if(i){let t=i?.replace(/(^\/|\/$)/g,"")??"";return new URL(`${o}/${t}/${e}`)}return new URL(`${o}/${e}`)}async function sg(e,t){!function(e={},t){t||(na.debug=()=>{}),e.error&&(na.error=e.error),e.warn&&(na.warn=e.warn),e.debug&&(na.debug=e.debug)}(t.logger,t.debug);let r=await nl(e,t);if(!r)return Response.json("Bad request.",{status:400});let n=function(e,t){let{url:r}=e,n=[];if(!tf&&t.debug&&n.push("debug-enabled"),!t.trustHost)return new ta(`Host must be trusted. URL was: ${e.url}`);if(!t.secret?.length)return new e5("Please define a `secret`");let i=e.query?.callbackUrl;if(i&&!tg(i,r.origin))return new eX(`Invalid callback URL. Received: ${i}`);let{callbackUrl:a}=eK(t.useSecureCookies??"https:"===r.protocol),s=e.cookies?.[t.cookies?.callbackUrl?.name??a.name];if(s&&!tg(s,r.origin))return new eX(`Invalid callback URL. Received: ${s}`);let o=!1;for(let e of t.providers){let t="function"==typeof e?e():e;if(("oauth"===t.type||"oidc"===t.type)&&!(t.issuer??t.options?.issuer)){let e;let{authorization:r,token:n,userinfo:i}=t;if("string"==typeof r||r?.url?"string"==typeof n||n?.url?"string"==typeof i||i?.url||(e="userinfo"):e="token":e="authorization",e)return new eZ(`Provider "${t.id}" is missing both \`issuer\` and \`${e}\` endpoint config. At least one of them is required`)}if("credentials"===t.type)ty=!0;else if("email"===t.type)tm=!0;else if("webauthn"===t.type){var l;if(tw=!0,t.simpleWebAuthnBrowserVersion&&(l=t.simpleWebAuthnBrowserVersion,!/^v\d+(?:\.\d+){0,2}$/.test(l)))return new eB(`Invalid provider config for "${t.id}": simpleWebAuthnBrowserVersion "${t.simpleWebAuthnBrowserVersion}" must be a valid semver string.`);if(t.enableConditionalUI){if(o)return new tc("Multiple webauthn providers have 'enableConditionalUI' set to True. Only one provider can have this option enabled at a time");if(o=!0,!Object.values(t.formFields).some(e=>e.autocomplete&&e.autocomplete.toString().indexOf("webauthn")>-1))return new tu(`Provider "${t.id}" has 'enableConditionalUI' set to True, but none of its formFields have 'webauthn' in their autocomplete param`)}}}if(ty){let e=t.session?.strategy==="database",r=!t.providers.some(e=>"credentials"!==("function"==typeof e?e():e).type);if(e&&r)return new tn("Signing in with credentials only supported if JWT strategy is enabled");if(t.providers.some(e=>{let t="function"==typeof e?e():e;return"credentials"===t.type&&!t.authorize}))return new e3("Must define an authorize() handler to use credentials authentication provider")}let{adapter:c,session:u}=t,d=[];if(tm||u?.strategy==="database"||!u?.strategy&&c){if(tm){if(!c)return new e1("Email login requires an adapter");d.push(...tb)}else{if(!c)return new e1("Database session requires an adapter");d.push(...tv)}}if(tw){if(!t.experimental?.enableWebAuthn)return new tp("WebAuthn is an experimental feature. To enable it, set `experimental.enableWebAuthn` to `true` in your config");if(n.push("experimental-webauthn"),!c)return new e1("WebAuthn requires an adapter");d.push(...t_)}if(c){let e=d.filter(e=>!(e in c));if(e.length)return new e2(`Required adapter methods were missing: ${e.join(", ")}`)}return tf||(tf=!0),n}(r,t);if(Array.isArray(n))n.forEach(na.warn);else if(n){if(na.error(n),!new Set(["signin","signout","error","verify-request"]).has(r.action)||"GET"!==r.method)return Response.json({message:"There was a problem with the server configuration. Check the server logs for more information."},{status:500});let{pages:e,theme:i}=t,a=e?.error&&r.url.searchParams.get("callbackUrl")?.startsWith(e.error);return!e?.error||a?(a&&na.error(new ez(`The error page ${e?.error} should not require authentication`)),nc(iR({theme:i}).error("Configuration"))):Response.redirect(`${e.error}?error=Configuration`)}let i=e.headers?.has("X-Auth-Return-Redirect"),a=t.raw===sp;try{let e=await sd(r,t);if(a)return e;let n=nc(e),s=n.headers.get("Location");if(!i||!s)return n;return Response.json({url:s},{headers:n.headers})}catch(d){na.error(d);let n=d instanceof eB;if(n&&a&&!i)throw d;if("POST"===e.method&&"session"===r.action)return Response.json(null,{status:400});let s=d instanceof eB&&tl.has(d.type)?d.type:"Configuration",o=new URLSearchParams({error:s});d instanceof eY&&o.set("code",d.code);let l=n&&d.kind||"error",c=t.pages?.[l]??`${t.basePath}/${l.toLowerCase()}`,u=`${r.url.origin}${c}?${o}`;if(i)return Response.json({url:u});return Response.redirect(u)}}function sy(e){let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return e;let{origin:r}=new URL(t),{href:n,origin:i}=e.nextUrl;return new G(n.replace(i,r),e)}function sm(e){try{e.secret??(e.secret=process.env.AUTH_SECRET??process.env.NEXTAUTH_SECRET);let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return;let{pathname:r}=new URL(t);if("/"===r)return;e.basePath||(e.basePath=r)}catch{}finally{e.basePath||(e.basePath="/api/auth"),function(e,t){try{let r=e.AUTH_URL;r&&!t.basePath&&(t.basePath=new URL(r).pathname)}catch{}finally{t.basePath??(t.basePath="/auth")}if(!t.secret?.length){t.secret=[];let r=e.AUTH_SECRET;for(let n of(r&&t.secret.push(r),[1,2,3])){let r=e[`AUTH_SECRET_${n}`];r&&t.secret.unshift(r)}}t.redirectProxyUrl??(t.redirectProxyUrl=e.AUTH_REDIRECT_PROXY_URL),t.trustHost??(t.trustHost=!!(e.AUTH_URL??e.AUTH_TRUST_HOST??e.VERCEL??e.CF_PAGES??"production"!==e.NODE_ENV)),t.providers=t.providers.map(t=>{let r="function"==typeof t?t({}):t,n=r.id.toUpperCase().replace(/-/g,"_");return"oauth"===r.type||"oidc"===r.type?(r.clientId??(r.clientId=e[`AUTH_${n}_ID`]),r.clientSecret??(r.clientSecret=e[`AUTH_${n}_SECRET`]),"oidc"===r.type&&(r.issuer??(r.issuer=e[`AUTH_${n}_ISSUER`]))):"email"===r.type&&(r.apiKey??(r.apiKey=e[`AUTH_${n}_KEY`])),r})}(process.env,e)}}r(254),"undefined"==typeof URLPattern||URLPattern;let sw=(0,em.P)();class sb extends Error{constructor(e){super("Dynamic server usage: "+e),this.description=e,this.digest="DYNAMIC_SERVER_USAGE"}}var sv=r(285);class s_ extends Error{constructor(...e){super(...e),this.code="NEXT_STATIC_GEN_BAILOUT"}}function sS(e,t){let{dynamic:r,link:n}=t||{};return"Page"+(r?' with `dynamic = "'+r+'"`':"")+" couldn't be rendered statically because it used `"+e+"`."+(n?" See more info here: "+n:"")}let sk=(e,t)=>{let{dynamic:r,link:n}=void 0===t?{}:t,i=sv.A.getStore();if(!i)return!1;if(i.forceStatic)return!0;if(i.dynamicShouldError)throw new s_(sS(e,{link:n,dynamic:null!=r?r:"error"}));let a=sS(e,{dynamic:r,link:"https://nextjs.org/docs/messages/dynamic-server-error"});if(null==i.postpone||i.postpone.call(i,e),i.revalidate=0,i.isStaticGeneration){let t=new sb(a);throw i.dynamicUsageDescription=e,i.dynamicUsageStack=t.stack,t}return!1};function sE(){if(sk("headers",{link:"https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering"}))return ec.seal(new Headers({}));let e=ew.getStore();if(!e)throw Error("Invariant: headers() expects to have requestAsyncStorage, none available.");return e.headers}function sT(){if(sk("cookies",{link:"https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering"}))return ed.seal(new F.RequestCookies(new Headers({})));let e=ew.getStore();if(!e)throw Error("Invariant: cookies() expects to have requestAsyncStorage, none available.");let t=sw.getStore();return t&&(t.isAction||t.isAppRoute)?e.mutableCookies:e.cookies}async function sx(e,t){let r=sf("session",e.get("x-forwarded-proto"),e,process.env,t.basePath);return sg(new Request(r,{headers:{cookie:e.get("cookie")??""}}),{...t,callbacks:{...t.callbacks,async session(...e){let r=await t.callbacks?.session?.(...e)??{...e[0].session,expires:e[0].session.expires?.toISOString?.()??e[0].session.expires};return{user:e[0].user??e[0].token,...r}}}})}function sA(e){return"function"==typeof e}function sP(e,t){return"function"==typeof e?async(...r)=>{if(!r.length){let r=sE(),n=await e(void 0);return t?.(n),sx(r,n).then(e=>e.json())}if(r[0]instanceof Request){let n=r[0],i=r[1],a=await e(n);return t?.(a),sC([n,i],a)}if(sA(r[0])){let n=r[0];return async(...r)=>{let i=await e(r[0]);return t?.(i),sC(r,i,n)}}let n="req"in r[0]?r[0].req:r[0],i="res"in r[0]?r[0].res:r[1],a=await e(n);return t?.(a),sx(new Headers(n.headers),a).then(async e=>{let t=await e.json();for(let t of e.headers.getSetCookie())"headers"in i?i.headers.append("set-cookie",t):i.appendHeader("set-cookie",t);return t})}:(...t)=>{if(!t.length)return sx(sE(),e).then(e=>e.json());if(t[0]instanceof Request)return sC([t[0],t[1]],e);if(sA(t[0])){let r=t[0];return async(...t)=>sC(t,e,r).then(e=>e)}let r="req"in t[0]?t[0].req:t[0],n="res"in t[0]?t[0].res:t[1];return sx(new Headers(r.headers),e).then(async e=>{let t=await e.json();for(let t of e.headers.getSetCookie())"headers"in n?n.headers.append("set-cookie",t):n.appendHeader("set-cookie",t);return t})}}async function sC(e,t,r){let n=sy(e[0]),i=await sx(n.headers,t),a=await i.json(),s=!0;t.callbacks?.authorized&&(s=await t.callbacks.authorized({request:n,auth:a}));let o=Q.next?.();if(s instanceof Response){o=s;let e=s.headers.get("Location"),{pathname:r}=n.nextUrl;e&&function(e,t,r){let n=t.replace(`${e}/`,""),i=Object.values(r.pages??{});return(sO.has(n)||i.includes(t))&&t===e}(r,new URL(e).pathname,t)&&(s=!0)}else if(r)n.auth=a,o=await r(n,e[1])??Q.next();else if(!s){let e=t.pages?.signIn??`${t.basePath}/signin`;if(n.nextUrl.pathname!==e){let t=n.nextUrl.clone();t.pathname=e,t.searchParams.set("callbackUrl",n.nextUrl.href),o=Q.redirect(t)}}let l=new Response(o?.body,o);for(let e of i.headers.getSetCookie())l.headers.append("set-cookie",e);return l}let sO=new Set(["providers","session","csrf","signin","signout","callback","verify-request","error"]);r(211),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(c||(c={}));let sR="NEXT_REDIRECT";function sI(e,t){void 0===t&&(t="replace");let r=sw.getStore();throw function(e,t,r){void 0===r&&(r=c.TemporaryRedirect);let n=Error(sR);n.digest=sR+";"+t+";"+e+";"+r+";";let i=ew.getStore();return i&&(n.mutableCookies=i.mutableCookies),n}(e,t,(null==r?void 0:r.isAction)?c.SeeOther:c.TemporaryRedirect)}!function(e){e.push="push",e.replace="replace"}(u||(u={})),Symbol("internal for urlsearchparams readonly");async function sj(e,t={},r,n){let i=new Headers(sE()),{redirect:a=!0,redirectTo:s,...o}=t instanceof FormData?Object.fromEntries(t):t,l=s?.toString()??i.get("Referer")??"/",c=sf("signin",i.get("x-forwarded-proto"),i,process.env,n.basePath);if(!e)return c.searchParams.append("callbackUrl",l),a&&sI(c.toString()),c.toString();let u=`${c}/${e}?${new URLSearchParams(r)}`,d={};for(let t of n.providers){let{options:r,...n}="function"==typeof t?t():t,i=r?.id??n.id;if(i===e){d={id:i,type:r?.type??n.type};break}}if(!d.id){let e=`${c}?${new URLSearchParams({callbackUrl:l})}`;return a&&sI(e),e}"credentials"===d.type&&(u=u.replace("signin","callback")),i.set("Content-Type","application/x-www-form-urlencoded");let h=new URLSearchParams({...o,callbackUrl:l}),p=new Request(u,{method:"POST",headers:i,body:h}),f=await sg(p,{...n,raw:sp,skipCSRFCheck:sh});for(let e of f?.cookies??[])sT().set(e.name,e.value,e.options);let g=(f instanceof Response?f.headers.get("Location"):f.redirect)??u;return a?sI(g):g}async function sU(e,t){let r=new Headers(sE());r.set("Content-Type","application/x-www-form-urlencoded");let n=sf("signout",r.get("x-forwarded-proto"),r,process.env,t.basePath),i=e?.redirectTo??r.get("Referer")??"/",a=new URLSearchParams({callbackUrl:i}),s=new Request(n,{method:"POST",headers:r,body:a}),o=await sg(s,{...t,raw:sp,skipCSRFCheck:sh});for(let e of o?.cookies??[])sT().set(e.name,e.value,e.options);return e?.redirect??!0?sI(o.redirect):o}async function s$(e,t){let r=new Headers(sE());r.set("Content-Type","application/json");let n=sf("session",r.get("x-forwarded-proto"),r,process.env,t.basePath),i=JSON.stringify({data:e}),a=new Request(n,{method:"POST",headers:r,body:i}),s=await sg(a,{...t,raw:sp,skipCSRFCheck:sh});for(let e of s?.cookies??[])sT().set(e.name,e.value,e.options);return s.body}Symbol.iterator;let sN=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,981)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)};class sL extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class sD extends sL{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class sM extends sL{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class sH extends sL{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(d||(d={}));class sK{constructor(e,{headers:t={},customFetch:r,region:n=d.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=sN(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r,n,i,a,s;return n=this,i=void 0,a=void 0,s=function*(){try{let n;let{headers:i,method:a,body:s}=t,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&("undefined"!=typeof Blob&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",n=s):"string"==typeof s?(o["Content-Type"]="text/plain",n=s):"undefined"!=typeof FormData&&s instanceof FormData?n=s:(o["Content-Type"]="application/json",n=JSON.stringify(s)));let c=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:n}).catch(e=>{throw new sD(e)}),u=c.headers.get("x-relay-error");if(u&&"true"===u)throw new sM(c);if(!c.ok)throw new sH(c);let d=(null!==(r=c.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return{data:"application/json"===d?yield c.json():"application/octet-stream"===d?yield c.blob():"multipart/form-data"===d?yield c.formData():yield c.text(),error:null}}catch(e){return{data:null,error:e}}},new(a||(a=Promise))(function(e,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):((n=t.value)instanceof a?n:new a(function(e){e(n)})).then(r,o)}l((s=s.apply(n,i||[])).next())})}}var sW=r(981);class sB extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class sq{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=sW.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,n;let i=null,a=null,s=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){let t=await e.text();""===t||(a="text/csv"===this.headers.Accept?t:this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}let n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");n&&c&&c.length>1&&(s=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(i={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,s=null,o=406,l="Not Acceptable"):a=1===a.length?a[0]:null)}else{let t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(a=[],i=null,o=200,l="OK")}catch(r){404===e.status&&""===t?(o=204,l="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(n=null==i?void 0:i.details)||void 0===n?void 0:n.includes("0 rows"))&&(i=null,o=200,l="OK"),i&&this.shouldThrowOnError)throw new sB(i)}return{error:i,data:a,count:s,status:o,statusText:l}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,n;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(n=null==e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}}class sJ extends sq{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){let a=i?`${i}.order`:"order",s=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){let i=void 0===n?"offset":`${n}.offset`,a=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var s;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(s=this.headers.Accept)&&void 0!==s?s:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class sV extends sJ{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";"plain"===n?i="pl":"phrase"===n?i="ph":"websearch"===n&&(i="w");let a=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}class sF{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=t,this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){let n=!1,i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer=`count=${r}`),new sV({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){let n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new sV({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){let a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new sV({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new sV({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new sV({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}let sz={"X-Client-Info":"postgrest-js/1.15.1"};class sG{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},sz),t),this.schemaName=r,this.fetch=n}from(e){return new sF(new URL(`${this.url}/${e}`),{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new sG(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:i}={}){let a,s;let o=new URL(`${this.url}/rpc/${e}`);r?(a="HEAD",Object.entries(t).filter(([e,t])=>void 0!==t).forEach(([e,t])=>{o.searchParams.append(e,`${t}`)})):n?(a="GET",Object.entries(t).filter(([e,t])=>void 0!==t).forEach(([e,t])=>{o.searchParams.append(e,`${t}`)})):(a="POST",s=t);let l=Object.assign({},this.headers);return i&&(l.Prefer=`count=${i}`),new sV({method:a,url:o,headers:l,schema:this.schemaName,body:s,fetch:this.fetch,allowEmpty:!1})}}let sX={"X-Client-Info":"realtime-js/2.9.3"};!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(h||(h={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(p||(p={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(f||(f={})),(g||(g={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(y||(y={}));class sY{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class sZ{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let n=t.getUint8(1),i=t.getUint8(2),a=this.HEADER_LENGTH+2,s=r.decode(e.slice(a,a+n));a+=n;let o=r.decode(e.slice(a,a+i));return a+=i,{ref:null,topic:s,event:o,payload:JSON.parse(r.decode(e.slice(a,e.byteLength)))}}}class sQ{constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(m||(m={}));class s0{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=s0.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=s0.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=s0.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){let i=this.cloneDeep(e),a=this.transformState(t),s={},o={};return this.map(i,(e,t)=>{a[e]||(o[e]=t)}),this.map(a,(e,t)=>{let r=i[e];if(r){let n=t.map(e=>e.presence_ref),i=r.map(e=>e.presence_ref),a=t.filter(e=>0>i.indexOf(e.presence_ref)),l=r.filter(e=>0>n.indexOf(e.presence_ref));a.length>0&&(s[e]=a),l.length>0&&(o[e]=l)}else s[e]=t}),this.syncDiff(i,{joins:s,leaves:o},r,n)}static syncDiff(e,t,r,n){let{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(t,n)=>{var i;let a=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(n),a.length>0){let r=e[t].map(e=>e.presence_ref),n=a.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...n)}r(t,a,n)}),this.map(a,(t,r)=>{let i=e[t];if(!i)return;let a=r.map(e=>e.presence_ref);i=i.filter(e=>0>a.indexOf(e.presence_ref)),e[t]=i,n(t,i,r),0===i.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let n=e[r];return"metas"in n?t[r]=n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(w||(w={}));let s1=(e,t,r={})=>{var n;let i=null!==(n=r.skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce((r,n)=>(r[n]=s2(n,e,t,i),r),{})},s2=(e,t,r,n)=>{let i=t.find(t=>t.name===e),a=null==i?void 0:i.type,s=r[e];return a&&!n.includes(a)?s3(a,s):s5(s)},s3=(e,t)=>{if("_"===e.charAt(0))return s9(t,e.slice(1,e.length));switch(e){case w.bool:return s4(t);case w.float4:case w.float8:case w.int2:case w.int4:case w.int8:case w.numeric:case w.oid:return s6(t);case w.json:case w.jsonb:return s8(t);case w.timestamp:return s7(t);case w.abstime:case w.date:case w.daterange:case w.int4range:case w.int8range:case w.money:case w.reltime:case w.text:case w.time:case w.timestamptz:case w.timetz:case w.tsrange:case w.tstzrange:default:return s5(t)}},s5=e=>e,s4=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},s6=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},s8=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},s9=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;let i=e.slice(1,r);try{n=JSON.parse("["+i+"]")}catch(e){n=i?i.split(","):[]}return n.map(e=>s3(t,e))}return e},s7=e=>"string"==typeof e?e.replace(" ","T"):e;!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(b||(b={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes"}(v||(v={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(_||(_={}));class oe{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=p.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new sQ(this,f.join,this.params,this.timeout),this.rejoinTimer=new sY(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=p.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=p.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this._on(f.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new s0(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:i,presence:a}}=this.params;this._onError(t=>e&&e("CHANNEL_ERROR",t)),this._onClose(()=>e&&e("CLOSED"));let s={},o={broadcast:i,presence:a,postgres_changes:null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==n?n:[]};this.socket.accessToken&&(s.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:o},s)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:t})=>{var r;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0===t){e&&e("SUBSCRIBED");return}{let n=this.bindings.postgres_changes,i=null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0,a=[];for(let r=0;r<i;r++){let i=n[r],{filter:{event:s,schema:o,table:l,filter:c}}=i,u=t&&t[r];if(u&&u.event===s&&u.schema===o&&u.table===l&&u.filter===c)a.push(Object.assign(Object.assign({},i),{id:u.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=a,e&&e("SUBSCRIBED");return}}).receive("error",t=>{e&&e("CHANNEL_ERROR",Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var n,i,a;let s=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(a=null===(i=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===i?void 0:i.broadcast)||void 0===a?void 0:a.ack)||r("ok"),s.receive("ok",()=>r("ok")),s.receive("timeout",()=>r("timed out"))});{let{event:i,payload:a}=e,s={method:"POST",headers:{apikey:null!==(r=this.socket.apiKey)&&void 0!==r?r:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a}]})};try{if((await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(n=t.timeout)&&void 0!==n?n:this.timeout)).ok)return"ok";return"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=p.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(f.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{let n=new sQ(this,f.leave,{},e);n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return(e=(e=e.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,t,r){let n=new AbortController,i=setTimeout(()=>n.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new sQ(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;let a=e.toLocaleLowerCase(),{close:s,error:o,leave:l,join:c}=f;if(r&&[s,o,l,c].indexOf(a)>=0&&r!==this._joinRef())return;let u=this._onMessage(a,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,r,n;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===a}).map(e=>e.callback(u,r)):null===(i=this.bindings[a])||void 0===i||i.filter(e=>{var r,n,i,s,o,l;if(!["broadcast","presence","postgres_changes"].includes(a))return e.type.toLocaleLowerCase()===a;if("id"in e){let a=e.id,s=null===(r=e.filter)||void 0===r?void 0:r.event;return a&&(null===(n=t.ids)||void 0===n?void 0:n.includes(a))&&("*"===s||(null==s?void 0:s.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{let r=null===(o=null===(s=null==e?void 0:e.filter)||void 0===s?void 0:s.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof u&&"ids"in u){let e=u.data,{schema:t,table:r,commit_timestamp:n,type:i,errors:a}=e;u=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:n,eventType:i,new:{},old:{},errors:a}),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===p.closed}_isJoined(){return this.state===p.joined}_isJoining(){return this.state===p.joining}_isLeaving(){return this.state===p.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&oe.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(f.close,{},e)}_onError(e){this._on(f.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=p.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=s1(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=s1(e.columns,e.old_record)),t}}let ot=()=>{},or="undefined"!=typeof WebSocket;class on{constructor(e,t){var n;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=sX,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=ot,this.conn=null,this.sendBuffer=[],this.serializer=new sZ,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,981)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${g.websocket}`,(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);let i=null===(n=null==t?void 0:t.params)||void 0===n?void 0:n.apikey;i&&(this.accessToken=i,this.apiKey=i),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new sY(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(or){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new oi(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Promise.resolve().then(r.t.bind(r,576,23)).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case h.connecting:return y.Connecting;case h.open:return y.Open;case h.closing:return y.Closing;default:return y.Closed}}isConnected(){return this.connectionState()===y.Open}channel(e,t={config:{}}){let r=new oe(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){let{topic:t,event:r,payload:n,ref:i}=e,a=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(f.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:r,payload:n,ref:i}=e;(i&&i===this.pendingHeartbeatRef||r===(null==n?void 0:n.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${r} ${i&&"("+i+")"||""}`,n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,i)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(f.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class oi{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=h.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class oa extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function os(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class oo extends oa{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ol extends oa{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let oc=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,981)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},ou=()=>(function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(r.bind(r,981))).Response:Response});var od=function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};let oh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),op=(e,t)=>od(void 0,void 0,void 0,function*(){e instanceof(yield ou())?e.json().then(r=>{t(new oo(oh(r),e.status||500))}).catch(e=>{t(new ol(oh(e),e))}):t(new ol(oh(e),e))}),of=(e,t,r,n)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};function og(e,t,r,n,i,a){return od(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,of(t,n,i,a)).then(e=>{if(!e.ok)throw e;return(null==n?void 0:n.noResolveJson)?e:e.json()}).then(e=>s(e)).catch(e=>op(e,o))})})}function oy(e,t,r,n){return od(this,void 0,void 0,function*(){return og(e,"GET",t,r,n)})}function om(e,t,r,n,i){return od(this,void 0,void 0,function*(){return og(e,"POST",t,n,i,r)})}function ow(e,t,r,n,i){return od(this,void 0,void 0,function*(){return og(e,"DELETE",t,n,i,r)})}var ob=function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};let ov={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},o_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class oS{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=oc(n)}uploadOrUpdate(e,t,r,n){return ob(this,void 0,void 0,function*(){try{let i;let a=Object.assign(Object.assign({},o_),n),s=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(a.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((i=new FormData).append("cacheControl",a.cacheControl),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(i=r).append("cacheControl",a.cacheControl):(i=r,s["cache-control"]=`max-age=${a.cacheControl}`,s["content-type"]=a.contentType);let o=this._removeEmptyFolders(t),l=this._getFinalPath(o),c=yield this.fetch(`${this.url}/object/${l}`,Object.assign({method:e,body:i,headers:s},(null==a?void 0:a.duplex)?{duplex:a.duplex}:{})),u=yield c.json();if(c.ok)return{data:{path:o,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(e){if(os(e))return{data:null,error:e};throw e}})}upload(e,t,r){return ob(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return ob(this,void 0,void 0,function*(){let i=this._removeEmptyFolders(e),a=this._getFinalPath(i),s=new URL(this.url+`/object/upload/sign/${a}`);s.searchParams.set("token",t);try{let e;let t=Object.assign({upsert:o_.upsert},n),a=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,a["cache-control"]=`max-age=${t.cacheControl}`,a["content-type"]=t.contentType);let o=yield this.fetch(s.toString(),{method:"PUT",body:e,headers:a}),l=yield o.json();if(o.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(e){if(os(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e){return ob(this,void 0,void 0,function*(){try{let t=this._getFinalPath(e),r=yield om(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:this.headers}),n=new URL(this.url+r.url),i=n.searchParams.get("token");if(!i)throw new oa("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:i},error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}update(e,t,r){return ob(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return ob(this,void 0,void 0,function*(){try{return{data:yield om(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}copy(e,t){return ob(this,void 0,void 0,function*(){try{return{data:{path:(yield om(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers})).Key},error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return ob(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield om(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),a=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return ob(this,void 0,void 0,function*(){try{let n=yield om(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null})),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}download(e,t){return ob(this,void 0,void 0,function*(){let r=void 0!==(null==t?void 0:t.transform),n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=n?`?${n}`:"";try{let t=this._getFinalPath(e),n=yield oy(this.fetch,`${this.url}/${r?"render/image/authenticated":"object"}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),n=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&n.push(i);let a=void 0!==(null==t?void 0:t.transform),s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==s&&n.push(s);let o=n.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${a?"render/image":"object"}/public/${r}${o}`)}}}remove(e){return ob(this,void 0,void 0,function*(){try{return{data:yield ow(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}list(e,t,r){return ob(this,void 0,void 0,function*(){try{let n=Object.assign(Object.assign(Object.assign({},ov),t),{prefix:e||""});return{data:yield om(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let ok={"X-Client-Info":"storage-js/2.5.5"};var oE=function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};class oT{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},ok),t),this.fetch=oc(r)}listBuckets(){return oE(this,void 0,void 0,function*(){try{return{data:yield oy(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}getBucket(e){return oE(this,void 0,void 0,function*(){try{return{data:yield oy(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return oE(this,void 0,void 0,function*(){try{return{data:yield om(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return oE(this,void 0,void 0,function*(){try{return{data:yield function(e,t,r,n,i){return od(this,void 0,void 0,function*(){return og(e,"PUT",t,n,void 0,r)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}emptyBucket(e){return oE(this,void 0,void 0,function*(){try{return{data:yield om(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}deleteBucket(e){return oE(this,void 0,void 0,function*(){try{return{data:yield ow(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(os(e))return{data:null,error:e};throw e}})}}class ox extends oT{constructor(e,t={},r){super(e,t,r)}from(e){return new oS(this.url,this.headers,e,this.fetch)}}let oA="";oA="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let oP={headers:{"X-Client-Info":`supabase-js-${oA}/2.42.1`}},oC={schema:"public"},oO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},oR={},oI=e=>{let t;return t=e||("undefined"==typeof fetch?sW.default:fetch),(...e)=>t(...e)},oj=()=>"undefined"==typeof Headers?sW.Headers:Headers,oU=(e,t,r)=>{let n=oI(r),i=oj();return(r,a)=>(function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){var s;let o=null!==(s=yield t())&&void 0!==s?s:e,l=new i(null==a?void 0:a.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),n(r,Object.assign(Object.assign({},a),{headers:l}))})},o$="2.63.0",oN={"X-Client-Info":`gotrue-js/${o$}`},oL="X-Supabase-Api-Version",oD={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},oM=()=>"undefined"!=typeof document,oH={tested:!1,writable:!1},oK=()=>{if(!oM())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(oH.tested)return oH.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),oH.tested=!0,oH.writable=!0}catch(e){oH.tested=!0,oH.writable=!1}return oH.writable};function oW(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}let oB=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,981)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},oq=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,oJ=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},oV=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},oF=async(e,t)=>{await e.removeItem(t)};class oz{constructor(){this.promise=new oz.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function oG(e){let t=e.split(".");if(3!==t.length)throw Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw Error("JWT is not valid: payload is not in base64url format");return JSON.parse(function(e){let t,r,n,i,a,s,o;let l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",u=0;for(e=e.replace("-","+").replace("_","/");u<e.length;)i=l.indexOf(e.charAt(u++)),a=l.indexOf(e.charAt(u++)),s=l.indexOf(e.charAt(u++)),o=l.indexOf(e.charAt(u++)),t=i<<2|a>>4,r=(15&a)<<4|s>>2,n=(3&s)<<6|o,c+=String.fromCharCode(t),64!=s&&0!=r&&(c+=String.fromCharCode(r)),64!=o&&0!=n&&(c+=String.fromCharCode(n));return c}(t[1]))}async function oX(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function oY(e){return("0"+e.toString(16)).substr(-2)}async function oZ(e){let t=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map(e=>String.fromCharCode(e)).join("")}async function oQ(e){return"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder?btoa(await oZ(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function o0(e,t,r=!1){let n=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,oY).join("")}(),i=n;r&&(i+="/PASSWORD_RECOVERY"),await oJ(e,`${t}-code-verifier`,i);let a=await oQ(n),s=n===a?"plain":"s256";return[a,s]}oz.promiseConstructor=Promise;let o1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class o2 extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function o3(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class o5 extends o2{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class o4 extends o2{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class o6 extends o2{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class o8 extends o6{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class o9 extends o6{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class o7 extends o6{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class le extends o6{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lt extends o6{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lr extends o6{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ln(e){return o3(e)&&"AuthRetryableFetchError"===e.name}class li extends o6{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var la=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};let ls=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),lo=[502,503,504];async function ll(e){var t;let r,n;if(!oq(e))throw new lr(ls(e),0);if(lo.includes(e.status))throw new lr(ls(e),e.status);try{r=await e.json()}catch(e){throw new o4(ls(e),e)}let i=function(e){let t=e.headers.get(oL);if(!t||!t.match(o1))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(i&&i.getTime()>=oD["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?n=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(n=r.error_code),n){if("weak_password"===n)throw new li(ls(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[])}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new li(ls(r),e.status,r.weak_password.reasons);throw new o5(ls(r),e.status||500,n)}let lc=(e,t,r,n)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function lu(e,t,r,n){var i;let a=Object.assign({},null==n?void 0:n.headers);a[oL]||(a[oL]=oD["2024-01-01"].name),(null==n?void 0:n.jwt)&&(a.Authorization=`Bearer ${n.jwt}`);let s=null!==(i=null==n?void 0:n.query)&&void 0!==i?i:{};(null==n?void 0:n.redirectTo)&&(s.redirect_to=n.redirectTo);let o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await ld(e,t,r+o,{headers:a,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function ld(e,t,r,n,i,a){let s;let o=lc(t,n,i,a);try{s=await e(r,Object.assign(Object.assign({},o),{cache:"no-store"}))}catch(e){throw console.error(e),new lr(ls(e),0)}if(s.ok||await ll(s),null==n?void 0:n.noResolveJson)return s;try{return await s.json()}catch(e){await ll(e)}}function lh(e){var t,r;let n=null;return e.access_token&&e.refresh_token&&e.expires_in&&(n=Object.assign({},e),!e.expires_at)&&(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)),{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function lp(e){let t=lh(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function lf(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function lg(e){return{data:e,error:null}}function ly(e){let{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a},user:Object.assign({},la(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function lm(e){return e}var lw=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class lb{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=oB(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await lu(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(o3(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await lu(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:lf})}catch(e){if(o3(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=lw(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await lu(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:ly,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(o3(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await lu(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:lf})}catch(e){if(o3(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,n,i,a,s,o;try{let l={nextPage:null,lastPage:0,total:0},c=await lu(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(i=null===(n=null==e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==i?i:""},xform:lm});if(c.error)throw c.error;let u=await c.json(),d=null!==(a=c.headers.get("x-total-count"))&&void 0!==a?a:0,h=null!==(o=null===(s=c.headers.get("link"))||void 0===s?void 0:s.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(e){if(o3(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await lu(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:lf})}catch(e){if(o3(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await lu(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:lf})}catch(e){if(o3(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await lu(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:lf})}catch(e){if(o3(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{let{data:t,error:r}=await lu(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(o3(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{return{data:await lu(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(o3(e))return{data:null,error:e};throw e}}}let lv={getItem:e=>oK()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{oK()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{oK()&&globalThis.localStorage.removeItem(e)}};function l_(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let lS={debug:!!(globalThis&&oK()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class lk extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class lE extends lk{}async function lT(e,t,r){lS.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),lS.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(n){lS.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{lS.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(0===t)throw lS.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new lE(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(lS.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let lx={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:oN,flowType:"implicit",debug:!1};async function lA(e,t,r){return await r()}class lP{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.insecureGetSessionWarningShown=!1,this.instanceID=lP.nextInstanceID,lP.nextInstanceID+=1,this.instanceID>0&&oM()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let n=Object.assign(Object.assign({},lx),e);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new lb({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=oB(n.fetch),this.lock=n.lock||lA,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,n.lock?this.lock=n.lock:oM()&&(null===(t=null==globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=lT:this.lock=lA,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:oK()?this.storage=lv:(this.memoryStorage={},this.storage=l_(this.memoryStorage)):(this.memoryStorage={},this.storage=l_(this.memoryStorage)),oM()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${o$}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){try{let e=!!oM()&&await this._isPKCEFlow();if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){let{data:t,error:r}=await this._getSessionFromURL(e);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),(null==r?void 0:r.message)==="Identity is already linked"||(null==r?void 0:r.message)==="Identity is already linked to another user")return{error:r};return await this._removeSession(),{error:r}}let{session:n,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(o3(e))return{error:e};return{error:new o4("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{await this._removeSession();let{data:i,error:a}=await lu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:lh});if(a||!i)return{data:{user:null,session:null},error:a};let s=i.session,o=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:o,session:s},error:null}}catch(e){if(o3(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,r,n;try{let i;if(await this._removeSession(),"email"in e){let{email:r,password:n,options:a}=e,s=null,o=null;"pkce"===this.flowType&&([s,o]=await o0(this.storage,this.storageKey)),i=await lu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==a?void 0:a.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:s,code_challenge_method:o},xform:lh})}else if("phone"in e){let{phone:t,password:a,options:s}=e;i=await lu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:a,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},channel:null!==(n=null==s?void 0:s.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:lh})}else throw new o7("You must provide either an email or phone number and a password");let{data:a,error:s}=i;if(s||!a)return{data:{user:null,session:null},error:s};let o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(o3(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if(await this._removeSession(),"email"in e){let{email:r,password:n,options:i}=e;t=await lu(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:lp})}else if("phone"in e){let{phone:r,password:n,options:i}=e;t=await lu(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:lp})}else throw new o7("You must provide either an email or phone number and a password");let{data:r,error:n}=t;if(n)return{data:{user:null,session:null},error:n};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new o9};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}}catch(e){if(o3(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,n,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let t=await oV(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!=t?t:"").split("/"),{data:i,error:a}=await lu(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:lh});return(await oF(this.storage,`${this.storageKey}-code-verifier`),a)?{data:{user:null,session:null,redirectType:null},error:a}:i&&i.session&&i.user?(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:null!=n?n:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new o9}}async signInWithIdToken(e){await this._removeSession();try{let{options:t,provider:r,token:n,access_token:i,nonce:a}=e,{data:s,error:o}=await lu(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:lh});if(o)return{data:{user:null,session:null},error:o};if(!s||!s.session||!s.user)return{data:{user:null,session:null},error:new o9};return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:o}}catch(e){if(o3(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,n,i,a;try{if(await this._removeSession(),"email"in e){let{email:n,options:i}=e,a=null,s=null;"pkce"===this.flowType&&([a,s]=await o0(this.storage,this.storageKey));let{error:o}=await lu(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(r=null==i?void 0:i.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:s},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:t,options:r}=e,{data:s,error:o}=await lu(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null==r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(i=null==r?void 0:r.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(a=null==r?void 0:r.channel)&&void 0!==a?a:"sms"}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:o}}throw new o7("You must provide either an email or phone number.")}catch(e){if(o3(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let n,i;"email_change"!==e.type&&"phone_change"!==e.type&&await this._removeSession(),"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(r=e.options)||void 0===r?void 0:r.captchaToken);let{data:a,error:s}=await lu(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:lh});if(s)throw s;if(!a)throw Error("An error occurred on token verification.");let o=a.session,l=a.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(o3(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,n;try{await this._removeSession();let i=null,a=null;return"pkce"===this.flowType&&([i,a]=await o0(this.storage,this.storageKey)),await lu(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:lg})}catch(e){if(o3(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new o8;let{error:n}=await lu(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(o3(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{"email_change"!=e.type&&"phone_change"!=e.type&&await this._removeSession();let t=`${this.url}/resend`;if("email"in e){let{email:r,type:n,options:i}=e,{error:a}=await lu(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){let{phone:r,type:n,options:i}=e,{data:a,error:s}=await lu(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:s}}throw new o7("You must provide either an email or phone number and a type")}catch(e){if(o3(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){await this.initializePromise;let e=await this._acquireLock(-1,async()=>this._useSession(async e=>e));return e.data&&this.storage.isServer&&!this.insecureGetSessionWarningShown&&(console.warn("Using supabase.auth.getSession() is potentially insecure as it loads data directly from the storage medium (typically cookies) which may not be authentic. Prefer using supabase.auth.getUser() instead. To suppress this warning call supabase.auth.getUser() before you call supabase.auth.getSession()."),this.insecureGetSessionWarningShown=!0),e}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await oV(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let t=e.user;delete e.user,Object.defineProperty(e,"user",{enumerable:!0,get:()=>(e.__suppressUserWarning||console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t),set:e=>{t=e}})}return{data:{session:e},error:null}}let{session:n,error:i}=await this._callRefreshToken(e.refresh_token);if(i)return{data:{session:null},error:i};return{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;let t=await this._acquireLock(-1,async()=>await this._getUser());return t.data&&this.storage.isServer&&(this.insecureGetSessionWarningShown=!0),t}async _getUser(e){try{if(e)return await lu(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:lf});return await this._useSession(async e=>{var t,r;let{data:n,error:i}=e;if(i)throw i;return await lu(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(t=n.session)||void 0===t?void 0:t.access_token)&&void 0!==r?r:void 0,xform:lf})})}catch(e){if(o3(e))return{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new o8;let a=n.session,s=null,o=null;"pkce"===this.flowType&&null!=e.email&&([s,o]=await o0(this.storage,this.storageKey));let{data:l,error:c}=await lu(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:o}),jwt:a.access_token,xform:lf});if(c)throw c;return a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(e){if(o3(e))return{data:{user:null},error:e};throw e}}_decodeJWT(e){return oG(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new o8;let t=Date.now()/1e3,r=t,n=!0,i=null,a=oG(e.access_token);if(a.exp&&(n=(r=a.exp)<=t),n){let{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};i=t}else{let{data:n,error:a}=await this._getUser(e.access_token);if(a)throw a;i={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(e){if(o3(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:n,error:i}=t;if(i)throw i;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new o8;let{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(o3(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e){try{if(!oM())throw new le("No browser detected.");if("implicit"!==this.flowType||this._isImplicitGrantFlow()){if("pkce"==this.flowType&&!e)throw new lt("Not a valid PKCE flow url.")}else throw new le("Not a valid implicit grant flow url.");let t=oW(window.location.href);if(e){if(!t.code)throw new lt("No code detected.");let{data:e,error:r}=await this._exchangeCodeForSession(t.code);if(r)throw r;let n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:e.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new le(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});let{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:s,expires_at:o,token_type:l}=t;if(!i||!s||!a||!l)throw new le("No session defined in URL");let c=Math.round(Date.now()/1e3),u=parseInt(s),d=c+u;o&&(d=parseInt(o));let h=d-c;1e3*h<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${u}s`);let p=d-u;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,d,c);let{data:f,error:g}=await this._getUser(i);if(g)throw g;let y={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:u,expires_at:d,refresh_token:a,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(e){if(o3(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantFlow(){let e=oW(window.location.href);return!!(oM()&&(e.access_token||e.error_description))}async _isPKCEFlow(){let e=oW(window.location.href),t=await oV(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:n,error:i}=t;if(i)return{error:i};let a=null===(r=n.session)||void 0===r?void 0:r.access_token;if(a){let{error:t}=await this.admin.signOut(a,e);if(t&&!(o3(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await oF(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{let{data:{session:n},error:i}=t;if(i)throw i;await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(t){await (null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;"pkce"===this.flowType&&([r,n]=await o0(this.storage,this.storageKey,!0));try{return await lu(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(o3(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(o3(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:r,error:n}=await this._useSession(async t=>{var r,n,i,a,s;let{data:o,error:l}=t;if(l)throw l;let c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await lu(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(s=null===(a=o.session)||void 0===a?void 0:a.access_token)&&void 0!==s?s:void 0})});if(n)throw n;return!oM()||(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(o3(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;let{data:i,error:a}=t;if(a)throw a;return await lu(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0})})}catch(e){if(o3(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,n;let i=Date.now();return await (r=async r=>(await oX(200*r),this._debug(t,"refreshing attempt",r),await lu(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:lh})),n=(e,t,r)=>r&&r.error&&ln(r.error)&&Date.now()+(e+1)*200-i<3e4,new Promise((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{let t=await r(i);if(!n(i,null,t)){e(t);return}}catch(e){if(!n(i,e)){t(e);return}}})()}))}catch(e){if(this._debug(t,"error",e),o3(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),oM()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let r=await oV(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),null!==r&&await this._removeSession();return}let n=Math.round(Date.now()/1e3),i=(null!==(e=r.expires_at)&&void 0!==e?e:1/0)<n+10;if(this._debug(t,`session has${i?"":" not"} expired with margin of 10s`),i){if(this.autoRefreshToken&&r.refresh_token){let{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),ln(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){this._debug(t,"error",e),console.error(e);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new o8;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new oz;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new o8;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(e){if(this._debug(n,"error",e),o3(e)){let r={session:null,error:e};return ln(e)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(r),r}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){let n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let n=[],i=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){n.push(e)}});if(await Promise.all(i),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await oJ(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await oF(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&oM()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let n=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof lk)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!oM()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let n=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await o0(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;return i?{data:null,error:i}:await lu(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(e){if(o3(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;let{data:i,error:a}=t;if(a)return{data:null,error:a};let{data:s,error:o}=await lu(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:((null===(n=null==s?void 0:s.totp)||void 0===n?void 0:n.qr_code)&&(s.totp.qr_code=`data:image/svg+xml;utf-8,${s.totp.qr_code}`),{data:s,error:null})})}catch(e){if(o3(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;if(i)return{data:null,error:i};let{data:a,error:s}=await lu(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:s})})}catch(e){if(o3(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;return i?{data:null,error:i}:await lu(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(e){if(o3(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let r=(null==e?void 0:e.factors)||[],n=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let a=this._decodeJWT(n.access_token),s=null;a.aal&&(s=a.aal);let o=s;return(null!==(r=null===(t=n.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(o="aal2"),{data:{currentLevel:s,nextLevel:o,currentAuthenticationMethods:a.amr||[]},error:null}}))}}lP.nextInstanceID=0;let lC=lP;class lO extends lC{constructor(e){super(e)}}class lR{constructor(e,t,r){var n,i,a,s,o,l,c,u;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");let d=e.replace(/\/$/,"");this.realtimeUrl=`${d}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${d}/auth/v1`,this.storageUrl=`${d}/storage/v1`,this.functionsUrl=`${d}/functions/v1`;let h=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,p=function(e,t){let{db:r,auth:n,realtime:i,global:a}=e,{db:s,auth:o,realtime:l,global:c}=t;return{db:Object.assign(Object.assign({},s),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),a)}}(null!=r?r:{},{db:oC,realtime:oR,auth:Object.assign(Object.assign({},oO),{storageKey:h}),global:oP});this.storageKey=null!==(i=null===(n=p.auth)||void 0===n?void 0:n.storageKey)&&void 0!==i?i:"",this.headers=null!==(s=null===(a=p.global)||void 0===a?void 0:a.headers)&&void 0!==s?s:{},this.auth=this._initSupabaseAuthClient(null!==(o=p.auth)&&void 0!==o?o:{},this.headers,null===(l=p.global)||void 0===l?void 0:l.fetch),this.fetch=oU(t,this._getAccessToken.bind(this),null===(c=p.global)||void 0===c?void 0:c.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},p.realtime)),this.rest=new sG(`${d}/rest/v1`,{headers:this.headers,schema:null===(u=p.db)||void 0===u?void 0:u.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new sK(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ox(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,n,i,a;return r=this,n=void 0,i=void 0,a=function*(){let{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null},new(i||(i=Promise))(function(e,t){function s(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(s,o)}l((a=a.apply(r,n||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:i,flowType:a,debug:s},o,l){let c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lO({url:this.authUrl,headers:Object.assign(Object.assign({},c),o),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:a,debug:s,fetch:l})}_initRealtimeClient(e){return new on(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.realtime.setAuth(null!=r?r:null),this.changedAccessToken=r):"SIGNED_OUT"===e&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}let lI=new lR(process.env.SUPABASE_URL,process.env.SUPABASE_KEY,void 0);async function lj(e){let{data:t,error:r}=await lI.from("guests").select("*").eq("email",e).single();return t}async function lU(e){let{data:t,error:r}=await lI.from("guests").insert([e]);if(r)throw console.error(r),Error("Guest could not be created");return t}let{auth:l$,signIn:lN,signOut:lL,handlers:{GET:lD,POST:lM}}=function(e){if("function"==typeof e){let t=async t=>{let r=await e(t);return sm(r),sg(sy(t),r)};return{handlers:{GET:t,POST:t},auth:sP(e,e=>sm(e)),signIn:async(t,r,n)=>{let i=await e(void 0);return sm(i),sj(t,r,n,i)},signOut:async t=>{let r=await e(void 0);return sm(r),sU(t,r)},unstable_update:async t=>{let r=await e(void 0);return sm(r),s$(t,r)}}}sm(e);let t=t=>sg(sy(t),e);return{handlers:{GET:t,POST:t},auth:sP(e),signIn:(t,r,n)=>sj(t,r,n,e),signOut:t=>sU(t,e),unstable_update:t=>s$(t,e)}}({providers:[{id:"google",name:"Google",type:"oidc",issuer:"https://accounts.google.com",style:{brandColor:"#1a73e8"},options:{clientId:process.env.AUTH_GOOGLE_ID,clientSecret:process.env.AUTH_GOOGLE_SECRET}}],callbacks:{authorized:({auth:e,request:t})=>!!e?.user,async signIn({user:e,account:t,profile:r}){try{return await lj(e.email)||await lU({email:e.email,fullName:e.name}),!0}catch{return!1}},async session({session:e,user:t}){let r=await lj(e.user.email);return e.user.guestId=r.id,e}},pages:{signIn:"/login"}}),lH=l$,lK={matcher:["/account"]},lW={...S},lB=lW.middleware||lW.default,lq="/middleware";if("function"!=typeof lB)throw Error(`The Middleware "${lq}" must export a \`middleware\` or a \`default\` function`);function lJ(e){return eD({...e,page:lq,handler:lB})}},981:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Headers:()=>s,Request:()=>o,Response:()=>l,default:()=>a,fetch:()=>i});var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw Error("unable to locate global object")}();let i=n.fetch,a=n.fetch.bind(n),s=n.Headers,o=n.Request,l=n.Response},868:(e,t)=>{"use strict";/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */t.Q=function(e,t){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var r={},n=(t||{}).decode||i,a=0;a<e.length;){var s=e.indexOf("=",a);if(-1===s)break;var o=e.indexOf(";",a);if(-1===o)o=e.length;else if(o<s){a=e.lastIndexOf(";",s-1)+1;continue}var l=e.slice(a,s).trim();if(void 0===r[l]){var c=e.slice(s+1,o).trim();34===c.charCodeAt(0)&&(c=c.slice(1,-1)),r[l]=function(e,t){try{return t(e)}catch(t){return e}}(c,n)}a=o+1}return r},t.q=function(e,t,i){var s=i||{},o=s.encode||a;if("function"!=typeof o)throw TypeError("option encode is invalid");if(!n.test(e))throw TypeError("argument name is invalid");var l=o(t);if(l&&!n.test(l))throw TypeError("argument val is invalid");var c=e+"="+l;if(null!=s.maxAge){var u=s.maxAge-0;if(isNaN(u)||!isFinite(u))throw TypeError("option maxAge is invalid");c+="; Max-Age="+Math.floor(u)}if(s.domain){if(!n.test(s.domain))throw TypeError("option domain is invalid");c+="; Domain="+s.domain}if(s.path){if(!n.test(s.path))throw TypeError("option path is invalid");c+="; Path="+s.path}if(s.expires){var d=s.expires;if("[object Date]"!==r.call(d)&&!(d instanceof Date)||isNaN(d.valueOf()))throw TypeError("option expires is invalid");c+="; Expires="+d.toUTCString()}if(s.httpOnly&&(c+="; HttpOnly"),s.secure&&(c+="; Secure"),s.partitioned&&(c+="; Partitioned"),s.priority)switch("string"==typeof s.priority?s.priority.toLowerCase():s.priority){case"low":c+="; Priority=Low";break;case"medium":c+="; Priority=Medium";break;case"high":c+="; Priority=High";break;default:throw TypeError("option priority is invalid")}if(s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"none":c+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return c};var r=Object.prototype.toString,n=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function i(e){return -1!==e.indexOf("%")?decodeURIComponent(e):e}function a(e){return encodeURIComponent(e)}},283:e=>{"use strict";var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,a={};function s(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean);return`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}; ${r.join("; ")}`}function o(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[n,i]=[r.slice(0,e),r.slice(e+1)];try{t.set(n,decodeURIComponent(null!=i?i:"true"))}catch{}}return t}function l(e){var t,r;if(!e)return;let[[n,i],...a]=o(e),{domain:s,expires:l,httponly:d,maxage:h,path:p,samesite:f,secure:g,partitioned:y,priority:m}=Object.fromEntries(a.map(([e,t])=>[e.toLowerCase(),t]));return function(e){let t={};for(let r in e)e[r]&&(t[r]=e[r]);return t}({name:n,value:decodeURIComponent(i),domain:s,...l&&{expires:new Date(l)},...d&&{httpOnly:!0},..."string"==typeof h&&{maxAge:Number(h)},path:p,...f&&{sameSite:c.includes(t=(t=f).toLowerCase())?t:void 0},...g&&{secure:!0},...m&&{priority:u.includes(r=(r=m).toLowerCase())?r:void 0},...y&&{partitioned:!0}})}((e,r)=>{for(var n in r)t(e,n,{get:r[n],enumerable:!0})})(a,{RequestCookies:()=>d,ResponseCookies:()=>h,parseCookie:()=>o,parseSetCookie:()=>l,stringifyCookie:()=>s}),e.exports=((e,a,s,o)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let s of n(a))i.call(e,s)||void 0===s||t(e,s,{get:()=>a[s],enumerable:!(o=r(a,s))||o.enumerable});return e})(t({},"__esModule",{value:!0}),a);var c=["strict","lax","none"],u=["low","medium","high"],d=class{constructor(e){this._parsed=new Map,this._headers=e;let t=e.get("cookie");if(t)for(let[e,r]of o(t))this._parsed.set(e,{name:e,value:r})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===n).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,n=this._parsed;return n.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(n).map(([e,t])=>s(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>s(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},h=class{constructor(e){var t,r,n;this._parsed=new Map,this._headers=e;let i=null!=(n=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?n:[];for(let e of Array.isArray(i)?i:function(e){if(!e)return[];var t,r,n,i,a,s=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,a=!1;l();)if(","===(r=e.charAt(o))){for(n=o,o+=1,l(),i=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(a=!0,o=i,s.push(e.substring(t,n)),t=o):o=n+1}else o+=1;(!a||o>=e.length)&&s.push(e.substring(t,e.length))}return s}(i)){let t=l(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===n)}has(e){return this._parsed.has(e)}set(...e){let[t,r,n]=1===e.length?[e[0].name,e[0].value,e[0]]:e,i=this._parsed;return i.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...n})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=s(r);t.append("set-cookie",e)}}(i,this._headers),this}delete(...e){let[t,r,n]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0].path,e[0].domain];return this.set({name:t,path:r,domain:n,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(s).join("; ")}}},38:(e,t,r)=>{(()=>{"use strict";var t={491:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextAPI=void 0;let n=r(223),i=r(172),a=r(930),s="context",o=new n.NoopContextManager;class l{constructor(){}static getInstance(){return this._instance||(this._instance=new l),this._instance}setGlobalContextManager(e){return(0,i.registerGlobal)(s,e,a.DiagAPI.instance())}active(){return this._getContextManager().active()}with(e,t,r,...n){return this._getContextManager().with(e,t,r,...n)}bind(e,t){return this._getContextManager().bind(e,t)}_getContextManager(){return(0,i.getGlobal)(s)||o}disable(){this._getContextManager().disable(),(0,i.unregisterGlobal)(s,a.DiagAPI.instance())}}t.ContextAPI=l},930:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagAPI=void 0;let n=r(56),i=r(912),a=r(957),s=r(172);class o{constructor(){function e(e){return function(...t){let r=(0,s.getGlobal)("diag");if(r)return r[e](...t)}}let t=this;t.setLogger=(e,r={logLevel:a.DiagLogLevel.INFO})=>{var n,o,l;if(e===t){let e=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(n=e.stack)&&void 0!==n?n:e.message),!1}"number"==typeof r&&(r={logLevel:r});let c=(0,s.getGlobal)("diag"),u=(0,i.createLogLevelDiagLogger)(null!==(o=r.logLevel)&&void 0!==o?o:a.DiagLogLevel.INFO,e);if(c&&!r.suppressOverrideMessage){let e=null!==(l=Error().stack)&&void 0!==l?l:"<failed to generate stacktrace>";c.warn(`Current logger will be overwritten from ${e}`),u.warn(`Current logger will overwrite one already registered from ${e}`)}return(0,s.registerGlobal)("diag",u,t,!0)},t.disable=()=>{(0,s.unregisterGlobal)("diag",t)},t.createComponentLogger=e=>new n.DiagComponentLogger(e),t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}static instance(){return this._instance||(this._instance=new o),this._instance}}t.DiagAPI=o},653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsAPI=void 0;let n=r(660),i=r(172),a=r(930),s="metrics";class o{constructor(){}static getInstance(){return this._instance||(this._instance=new o),this._instance}setGlobalMeterProvider(e){return(0,i.registerGlobal)(s,e,a.DiagAPI.instance())}getMeterProvider(){return(0,i.getGlobal)(s)||n.NOOP_METER_PROVIDER}getMeter(e,t,r){return this.getMeterProvider().getMeter(e,t,r)}disable(){(0,i.unregisterGlobal)(s,a.DiagAPI.instance())}}t.MetricsAPI=o},181:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PropagationAPI=void 0;let n=r(172),i=r(874),a=r(194),s=r(277),o=r(369),l=r(930),c="propagation",u=new i.NoopTextMapPropagator;class d{constructor(){this.createBaggage=o.createBaggage,this.getBaggage=s.getBaggage,this.getActiveBaggage=s.getActiveBaggage,this.setBaggage=s.setBaggage,this.deleteBaggage=s.deleteBaggage}static getInstance(){return this._instance||(this._instance=new d),this._instance}setGlobalPropagator(e){return(0,n.registerGlobal)(c,e,l.DiagAPI.instance())}inject(e,t,r=a.defaultTextMapSetter){return this._getGlobalPropagator().inject(e,t,r)}extract(e,t,r=a.defaultTextMapGetter){return this._getGlobalPropagator().extract(e,t,r)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,n.unregisterGlobal)(c,l.DiagAPI.instance())}_getGlobalPropagator(){return(0,n.getGlobal)(c)||u}}t.PropagationAPI=d},997:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceAPI=void 0;let n=r(172),i=r(846),a=r(139),s=r(607),o=r(930),l="trace";class c{constructor(){this._proxyTracerProvider=new i.ProxyTracerProvider,this.wrapSpanContext=a.wrapSpanContext,this.isSpanContextValid=a.isSpanContextValid,this.deleteSpan=s.deleteSpan,this.getSpan=s.getSpan,this.getActiveSpan=s.getActiveSpan,this.getSpanContext=s.getSpanContext,this.setSpan=s.setSpan,this.setSpanContext=s.setSpanContext}static getInstance(){return this._instance||(this._instance=new c),this._instance}setGlobalTracerProvider(e){let t=(0,n.registerGlobal)(l,this._proxyTracerProvider,o.DiagAPI.instance());return t&&this._proxyTracerProvider.setDelegate(e),t}getTracerProvider(){return(0,n.getGlobal)(l)||this._proxyTracerProvider}getTracer(e,t){return this.getTracerProvider().getTracer(e,t)}disable(){(0,n.unregisterGlobal)(l,o.DiagAPI.instance()),this._proxyTracerProvider=new i.ProxyTracerProvider}}t.TraceAPI=c},277:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBaggage=t.setBaggage=t.getActiveBaggage=t.getBaggage=void 0;let n=r(491),i=(0,r(780).createContextKey)("OpenTelemetry Baggage Key");function a(e){return e.getValue(i)||void 0}t.getBaggage=a,t.getActiveBaggage=function(){return a(n.ContextAPI.getInstance().active())},t.setBaggage=function(e,t){return e.setValue(i,t)},t.deleteBaggage=function(e){return e.deleteValue(i)}},993:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaggageImpl=void 0;class r{constructor(e){this._entries=e?new Map(e):new Map}getEntry(e){let t=this._entries.get(e);if(t)return Object.assign({},t)}getAllEntries(){return Array.from(this._entries.entries()).map(([e,t])=>[e,t])}setEntry(e,t){let n=new r(this._entries);return n._entries.set(e,t),n}removeEntry(e){let t=new r(this._entries);return t._entries.delete(e),t}removeEntries(...e){let t=new r(this._entries);for(let r of e)t._entries.delete(r);return t}clear(){return new r}}t.BaggageImpl=r},830:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataSymbol=void 0,t.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},369:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataFromString=t.createBaggage=void 0;let n=r(930),i=r(993),a=r(830),s=n.DiagAPI.instance();t.createBaggage=function(e={}){return new i.BaggageImpl(new Map(Object.entries(e)))},t.baggageEntryMetadataFromString=function(e){return"string"!=typeof e&&(s.error(`Cannot create baggage metadata from unknown type: ${typeof e}`),e=""),{__TYPE__:a.baggageEntryMetadataSymbol,toString:()=>e}}},67:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.context=void 0;let n=r(491);t.context=n.ContextAPI.getInstance()},223:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=void 0;let n=r(780);class i{active(){return n.ROOT_CONTEXT}with(e,t,r,...n){return t.call(r,...n)}bind(e,t){return t}enable(){return this}disable(){return this}}t.NoopContextManager=i},780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ROOT_CONTEXT=t.createContextKey=void 0,t.createContextKey=function(e){return Symbol.for(e)};class r{constructor(e){let t=this;t._currentContext=e?new Map(e):new Map,t.getValue=e=>t._currentContext.get(e),t.setValue=(e,n)=>{let i=new r(t._currentContext);return i._currentContext.set(e,n),i},t.deleteValue=e=>{let n=new r(t._currentContext);return n._currentContext.delete(e),n}}}t.ROOT_CONTEXT=new r},506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.diag=void 0;let n=r(930);t.diag=n.DiagAPI.instance()},56:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagComponentLogger=void 0;let n=r(172);class i{constructor(e){this._namespace=e.namespace||"DiagComponentLogger"}debug(...e){return a("debug",this._namespace,e)}error(...e){return a("error",this._namespace,e)}info(...e){return a("info",this._namespace,e)}warn(...e){return a("warn",this._namespace,e)}verbose(...e){return a("verbose",this._namespace,e)}}function a(e,t,r){let i=(0,n.getGlobal)("diag");if(i)return r.unshift(t),i[e](...r)}t.DiagComponentLogger=i},972:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagConsoleLogger=void 0;let r=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];class n{constructor(){for(let e=0;e<r.length;e++)this[r[e].n]=function(e){return function(...t){if(console){let r=console[e];if("function"!=typeof r&&(r=console.log),"function"==typeof r)return r.apply(console,t)}}}(r[e].c)}}t.DiagConsoleLogger=n},912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLogLevelDiagLogger=void 0;let n=r(957);t.createLogLevelDiagLogger=function(e,t){function r(r,n){let i=t[r];return"function"==typeof i&&e>=n?i.bind(t):function(){}}return e<n.DiagLogLevel.NONE?e=n.DiagLogLevel.NONE:e>n.DiagLogLevel.ALL&&(e=n.DiagLogLevel.ALL),t=t||{},{error:r("error",n.DiagLogLevel.ERROR),warn:r("warn",n.DiagLogLevel.WARN),info:r("info",n.DiagLogLevel.INFO),debug:r("debug",n.DiagLogLevel.DEBUG),verbose:r("verbose",n.DiagLogLevel.VERBOSE)}}},957:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagLogLevel=void 0,function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(t.DiagLogLevel||(t.DiagLogLevel={}))},172:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unregisterGlobal=t.getGlobal=t.registerGlobal=void 0;let n=r(200),i=r(521),a=r(130),s=i.VERSION.split(".")[0],o=Symbol.for(`opentelemetry.js.api.${s}`),l=n._globalThis;t.registerGlobal=function(e,t,r,n=!1){var a;let s=l[o]=null!==(a=l[o])&&void 0!==a?a:{version:i.VERSION};if(!n&&s[e]){let t=Error(`@opentelemetry/api: Attempted duplicate registration of API: ${e}`);return r.error(t.stack||t.message),!1}if(s.version!==i.VERSION){let t=Error(`@opentelemetry/api: Registration of version v${s.version} for ${e} does not match previously registered API v${i.VERSION}`);return r.error(t.stack||t.message),!1}return s[e]=t,r.debug(`@opentelemetry/api: Registered a global for ${e} v${i.VERSION}.`),!0},t.getGlobal=function(e){var t,r;let n=null===(t=l[o])||void 0===t?void 0:t.version;if(n&&(0,a.isCompatible)(n))return null===(r=l[o])||void 0===r?void 0:r[e]},t.unregisterGlobal=function(e,t){t.debug(`@opentelemetry/api: Unregistering a global for ${e} v${i.VERSION}.`);let r=l[o];r&&delete r[e]}},130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCompatible=t._makeCompatibilityCheck=void 0;let n=r(521),i=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function a(e){let t=new Set([e]),r=new Set,n=e.match(i);if(!n)return()=>!1;let a={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=a.prerelease)return function(t){return t===e};function s(e){return r.add(e),!1}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;let n=e.match(i);if(!n)return s(e);let o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};return null!=o.prerelease||a.major!==o.major?s(e):0===a.major?a.minor===o.minor&&a.patch<=o.patch?(t.add(e),!0):s(e):a.minor<=o.minor?(t.add(e),!0):s(e)}}t._makeCompatibilityCheck=a,t.isCompatible=a(n.VERSION)},886:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.metrics=void 0;let n=r(653);t.metrics=n.MetricsAPI.getInstance()},901:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValueType=void 0,function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(t.ValueType||(t.ValueType={}))},102:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopMeter=t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=t.NOOP_OBSERVABLE_GAUGE_METRIC=t.NOOP_OBSERVABLE_COUNTER_METRIC=t.NOOP_UP_DOWN_COUNTER_METRIC=t.NOOP_HISTOGRAM_METRIC=t.NOOP_COUNTER_METRIC=t.NOOP_METER=t.NoopObservableUpDownCounterMetric=t.NoopObservableGaugeMetric=t.NoopObservableCounterMetric=t.NoopObservableMetric=t.NoopHistogramMetric=t.NoopUpDownCounterMetric=t.NoopCounterMetric=t.NoopMetric=t.NoopMeter=void 0;class r{constructor(){}createHistogram(e,r){return t.NOOP_HISTOGRAM_METRIC}createCounter(e,r){return t.NOOP_COUNTER_METRIC}createUpDownCounter(e,r){return t.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(e,r){return t.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(e,r){return t.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(e,r){return t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(e,t){}removeBatchObservableCallback(e){}}t.NoopMeter=r;class n{}t.NoopMetric=n;class i extends n{add(e,t){}}t.NoopCounterMetric=i;class a extends n{add(e,t){}}t.NoopUpDownCounterMetric=a;class s extends n{record(e,t){}}t.NoopHistogramMetric=s;class o{addCallback(e){}removeCallback(e){}}t.NoopObservableMetric=o;class l extends o{}t.NoopObservableCounterMetric=l;class c extends o{}t.NoopObservableGaugeMetric=c;class u extends o{}t.NoopObservableUpDownCounterMetric=u,t.NOOP_METER=new r,t.NOOP_COUNTER_METRIC=new i,t.NOOP_HISTOGRAM_METRIC=new s,t.NOOP_UP_DOWN_COUNTER_METRIC=new a,t.NOOP_OBSERVABLE_COUNTER_METRIC=new l,t.NOOP_OBSERVABLE_GAUGE_METRIC=new c,t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new u,t.createNoopMeter=function(){return t.NOOP_METER}},660:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_METER_PROVIDER=t.NoopMeterProvider=void 0;let n=r(102);class i{getMeter(e,t,r){return n.NOOP_METER}}t.NoopMeterProvider=i,t.NOOP_METER_PROVIDER=new i},200:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(46),t)},651:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._globalThis=void 0,t._globalThis="object"==typeof globalThis?globalThis:r.g},46:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(651),t)},939:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.propagation=void 0;let n=r(181);t.propagation=n.PropagationAPI.getInstance()},874:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTextMapPropagator=void 0;class r{inject(e,t){}extract(e,t){return e}fields(){return[]}}t.NoopTextMapPropagator=r},194:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTextMapSetter=t.defaultTextMapGetter=void 0,t.defaultTextMapGetter={get(e,t){if(null!=e)return e[t]},keys:e=>null==e?[]:Object.keys(e)},t.defaultTextMapSetter={set(e,t,r){null!=e&&(e[t]=r)}}},845:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.trace=void 0;let n=r(997);t.trace=n.TraceAPI.getInstance()},403:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonRecordingSpan=void 0;let n=r(476);class i{constructor(e=n.INVALID_SPAN_CONTEXT){this._spanContext=e}spanContext(){return this._spanContext}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return!1}recordException(e,t){}}t.NonRecordingSpan=i},614:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracer=void 0;let n=r(491),i=r(607),a=r(403),s=r(139),o=n.ContextAPI.getInstance();class l{startSpan(e,t,r=o.active()){if(null==t?void 0:t.root)return new a.NonRecordingSpan;let n=r&&(0,i.getSpanContext)(r);return"object"==typeof n&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&(0,s.isSpanContextValid)(n)?new a.NonRecordingSpan(n):new a.NonRecordingSpan}startActiveSpan(e,t,r,n){let a,s,l;if(arguments.length<2)return;2==arguments.length?l=t:3==arguments.length?(a=t,l=r):(a=t,s=r,l=n);let c=null!=s?s:o.active(),u=this.startSpan(e,a,c),d=(0,i.setSpan)(c,u);return o.with(d,l,void 0,u)}}t.NoopTracer=l},124:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracerProvider=void 0;let n=r(614);class i{getTracer(e,t,r){return new n.NoopTracer}}t.NoopTracerProvider=i},125:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracer=void 0;let n=new(r(614)).NoopTracer;class i{constructor(e,t,r,n){this._provider=e,this.name=t,this.version=r,this.options=n}startSpan(e,t,r){return this._getTracer().startSpan(e,t,r)}startActiveSpan(e,t,r,n){let i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)}_getTracer(){if(this._delegate)return this._delegate;let e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):n}}t.ProxyTracer=i},846:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracerProvider=void 0;let n=r(125),i=new(r(124)).NoopTracerProvider;class a{getTracer(e,t,r){var i;return null!==(i=this.getDelegateTracer(e,t,r))&&void 0!==i?i:new n.ProxyTracer(this,e,t,r)}getDelegate(){var e;return null!==(e=this._delegate)&&void 0!==e?e:i}setDelegate(e){this._delegate=e}getDelegateTracer(e,t,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getTracer(e,t,r)}}t.ProxyTracerProvider=a},996:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SamplingDecision=void 0,function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(t.SamplingDecision||(t.SamplingDecision={}))},607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpanContext=t.setSpanContext=t.deleteSpan=t.setSpan=t.getActiveSpan=t.getSpan=void 0;let n=r(780),i=r(403),a=r(491),s=(0,n.createContextKey)("OpenTelemetry Context Key SPAN");function o(e){return e.getValue(s)||void 0}function l(e,t){return e.setValue(s,t)}t.getSpan=o,t.getActiveSpan=function(){return o(a.ContextAPI.getInstance().active())},t.setSpan=l,t.deleteSpan=function(e){return e.deleteValue(s)},t.setSpanContext=function(e,t){return l(e,new i.NonRecordingSpan(t))},t.getSpanContext=function(e){var t;return null===(t=o(e))||void 0===t?void 0:t.spanContext()}},325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceStateImpl=void 0;let n=r(564);class i{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){let r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r}unset(e){let t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,t)=>(e.push(t+"="+this.get(t)),e),[]).join(",")}_parse(e){!(e.length>512)&&(this._internalState=e.split(",").reverse().reduce((e,t)=>{let r=t.trim(),i=r.indexOf("=");if(-1!==i){let a=r.slice(0,i),s=r.slice(i+1,t.length);(0,n.validateKey)(a)&&(0,n.validateValue)(s)&&e.set(a,s)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new i;return e._internalState=new Map(this._internalState),e}}t.TraceStateImpl=i},564:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateValue=t.validateKey=void 0;let r="[_0-9a-z-*/]",n=`[a-z]${r}{0,255}`,i=`[a-z0-9]${r}{0,240}@[a-z]${r}{0,13}`,a=RegExp(`^(?:${n}|${i})$`),s=/^[ -~]{0,255}[!-~]$/,o=/,|=/;t.validateKey=function(e){return a.test(e)},t.validateValue=function(e){return s.test(e)&&!o.test(e)}},98:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTraceState=void 0;let n=r(325);t.createTraceState=function(e){return new n.TraceStateImpl(e)}},476:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0;let n=r(475);t.INVALID_SPANID="0000000000000000",t.INVALID_TRACEID="00000000000000000000000000000000",t.INVALID_SPAN_CONTEXT={traceId:t.INVALID_TRACEID,spanId:t.INVALID_SPANID,traceFlags:n.TraceFlags.NONE}},357:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanKind=void 0,function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(t.SpanKind||(t.SpanKind={}))},139:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapSpanContext=t.isSpanContextValid=t.isValidSpanId=t.isValidTraceId=void 0;let n=r(476),i=r(403),a=/^([0-9a-f]{32})$/i,s=/^[0-9a-f]{16}$/i;function o(e){return a.test(e)&&e!==n.INVALID_TRACEID}function l(e){return s.test(e)&&e!==n.INVALID_SPANID}t.isValidTraceId=o,t.isValidSpanId=l,t.isSpanContextValid=function(e){return o(e.traceId)&&l(e.spanId)},t.wrapSpanContext=function(e){return new i.NonRecordingSpan(e)}},847:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanStatusCode=void 0,function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(t.SpanStatusCode||(t.SpanStatusCode={}))},475:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlags=void 0,function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(t.TraceFlags||(t.TraceFlags={}))},521:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="1.6.0"}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}},s=!0;try{t[e].call(a.exports,a,a.exports,i),s=!1}finally{s&&delete n[e]}return a.exports}i.ab="//";var a={};(()=>{Object.defineProperty(a,"__esModule",{value:!0}),a.trace=a.propagation=a.metrics=a.diag=a.context=a.INVALID_SPAN_CONTEXT=a.INVALID_TRACEID=a.INVALID_SPANID=a.isValidSpanId=a.isValidTraceId=a.isSpanContextValid=a.createTraceState=a.TraceFlags=a.SpanStatusCode=a.SpanKind=a.SamplingDecision=a.ProxyTracerProvider=a.ProxyTracer=a.defaultTextMapSetter=a.defaultTextMapGetter=a.ValueType=a.createNoopMeter=a.DiagLogLevel=a.DiagConsoleLogger=a.ROOT_CONTEXT=a.createContextKey=a.baggageEntryMetadataFromString=void 0;var e=i(369);Object.defineProperty(a,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return e.baggageEntryMetadataFromString}});var t=i(780);Object.defineProperty(a,"createContextKey",{enumerable:!0,get:function(){return t.createContextKey}}),Object.defineProperty(a,"ROOT_CONTEXT",{enumerable:!0,get:function(){return t.ROOT_CONTEXT}});var r=i(972);Object.defineProperty(a,"DiagConsoleLogger",{enumerable:!0,get:function(){return r.DiagConsoleLogger}});var n=i(957);Object.defineProperty(a,"DiagLogLevel",{enumerable:!0,get:function(){return n.DiagLogLevel}});var s=i(102);Object.defineProperty(a,"createNoopMeter",{enumerable:!0,get:function(){return s.createNoopMeter}});var o=i(901);Object.defineProperty(a,"ValueType",{enumerable:!0,get:function(){return o.ValueType}});var l=i(194);Object.defineProperty(a,"defaultTextMapGetter",{enumerable:!0,get:function(){return l.defaultTextMapGetter}}),Object.defineProperty(a,"defaultTextMapSetter",{enumerable:!0,get:function(){return l.defaultTextMapSetter}});var c=i(125);Object.defineProperty(a,"ProxyTracer",{enumerable:!0,get:function(){return c.ProxyTracer}});var u=i(846);Object.defineProperty(a,"ProxyTracerProvider",{enumerable:!0,get:function(){return u.ProxyTracerProvider}});var d=i(996);Object.defineProperty(a,"SamplingDecision",{enumerable:!0,get:function(){return d.SamplingDecision}});var h=i(357);Object.defineProperty(a,"SpanKind",{enumerable:!0,get:function(){return h.SpanKind}});var p=i(847);Object.defineProperty(a,"SpanStatusCode",{enumerable:!0,get:function(){return p.SpanStatusCode}});var f=i(475);Object.defineProperty(a,"TraceFlags",{enumerable:!0,get:function(){return f.TraceFlags}});var g=i(98);Object.defineProperty(a,"createTraceState",{enumerable:!0,get:function(){return g.createTraceState}});var y=i(139);Object.defineProperty(a,"isSpanContextValid",{enumerable:!0,get:function(){return y.isSpanContextValid}}),Object.defineProperty(a,"isValidTraceId",{enumerable:!0,get:function(){return y.isValidTraceId}}),Object.defineProperty(a,"isValidSpanId",{enumerable:!0,get:function(){return y.isValidSpanId}});var m=i(476);Object.defineProperty(a,"INVALID_SPANID",{enumerable:!0,get:function(){return m.INVALID_SPANID}}),Object.defineProperty(a,"INVALID_TRACEID",{enumerable:!0,get:function(){return m.INVALID_TRACEID}}),Object.defineProperty(a,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return m.INVALID_SPAN_CONTEXT}});let w=i(67);Object.defineProperty(a,"context",{enumerable:!0,get:function(){return w.context}});let b=i(506);Object.defineProperty(a,"diag",{enumerable:!0,get:function(){return b.diag}});let v=i(886);Object.defineProperty(a,"metrics",{enumerable:!0,get:function(){return v.metrics}});let _=i(939);Object.defineProperty(a,"propagation",{enumerable:!0,get:function(){return _.propagation}});let S=i(845);Object.defineProperty(a,"trace",{enumerable:!0,get:function(){return S.trace}}),a.default={context:w.context,diag:b.diag,metrics:v.metrics,propagation:_.propagation,trace:S.trace}})(),e.exports=a})()},578:e=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab="//");var t={};(()=>{/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */t.parse=function(t,r){if("string"!=typeof t)throw TypeError("argument str must be a string");for(var i={},a=t.split(n),s=(r||{}).decode||e,o=0;o<a.length;o++){var l=a[o],c=l.indexOf("=");if(!(c<0)){var u=l.substr(0,c).trim(),d=l.substr(++c,l.length).trim();'"'==d[0]&&(d=d.slice(1,-1)),void 0==i[u]&&(i[u]=function(e,t){try{return t(e)}catch(t){return e}}(d,s))}}return i},t.serialize=function(e,t,n){var a=n||{},s=a.encode||r;if("function"!=typeof s)throw TypeError("option encode is invalid");if(!i.test(e))throw TypeError("argument name is invalid");var o=s(t);if(o&&!i.test(o))throw TypeError("argument val is invalid");var l=e+"="+o;if(null!=a.maxAge){var c=a.maxAge-0;if(isNaN(c)||!isFinite(c))throw TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(c)}if(a.domain){if(!i.test(a.domain))throw TypeError("option domain is invalid");l+="; Domain="+a.domain}if(a.path){if(!i.test(a.path))throw TypeError("option path is invalid");l+="; Path="+a.path}if(a.expires){if("function"!=typeof a.expires.toUTCString)throw TypeError("option expires is invalid");l+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(l+="; HttpOnly"),a.secure&&(l+="; Secure"),a.sameSite)switch("string"==typeof a.sameSite?a.sameSite.toLowerCase():a.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return l};var e=decodeURIComponent,r=encodeURIComponent,n=/; */,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),e.exports=t})()},254:(e,t,r)=>{var n;(()=>{var i={226:function(i,a){!function(s,o){"use strict";var l="function",c="undefined",u="object",d="string",h="major",p="model",f="name",g="type",y="vendor",m="version",w="architecture",b="console",v="mobile",_="tablet",S="smarttv",k="wearable",E="embedded",T="Amazon",x="Apple",A="ASUS",P="BlackBerry",C="Browser",O="Chrome",R="Firefox",I="Google",j="Huawei",U="Microsoft",$="Motorola",N="Opera",L="Samsung",D="Sharp",M="Sony",H="Xiaomi",K="Zebra",W="Facebook",B="Chromium OS",q="Mac OS",J=function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r},V=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},F=function(e,t){return typeof e===d&&-1!==z(t).indexOf(z(e))},z=function(e){return e.toLowerCase()},G=function(e,t){if(typeof e===d)return e=e.replace(/^\s\s*/,""),typeof t===c?e:e.substring(0,350)},X=function(e,t){for(var r,n,i,a,s,c,d=0;d<t.length&&!s;){var h=t[d],p=t[d+1];for(r=n=0;r<h.length&&!s&&h[r];)if(s=h[r++].exec(e))for(i=0;i<p.length;i++)c=s[++n],typeof(a=p[i])===u&&a.length>0?2===a.length?typeof a[1]==l?this[a[0]]=a[1].call(this,c):this[a[0]]=a[1]:3===a.length?typeof a[1]!==l||a[1].exec&&a[1].test?this[a[0]]=c?c.replace(a[1],a[2]):o:this[a[0]]=c?a[1].call(this,c,a[2]):o:4===a.length&&(this[a[0]]=c?a[3].call(this,c.replace(a[1],a[2])):o):this[a]=c||o;d+=2}},Y=function(e,t){for(var r in t)if(typeof t[r]===u&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(F(t[r][n],e))return"?"===r?o:r}else if(F(t[r],e))return"?"===r?o:r;return e},Z={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,m],[/opios[\/ ]+([\w\.]+)/i],[m,[f,N+" Mini"]],[/\bopr\/([\w\.]+)/i],[m,[f,N]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[f,m],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[f,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[m,[f,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[m,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[f,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[f,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+C],m],[/\bfocus\/([\w\.]+)/i],[m,[f,R+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[f,N+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[f,N+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[f,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[m,[f,R]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 "+C]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 "+C],m],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[f,m],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,W],m],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[f,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[f,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[f,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[f,O+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,O+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[f,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[f,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[m,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[f,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[f,R+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[f,m],[/(cobalt)\/([\w\.]+)/i],[f,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[w,"amd64"]],[/(ia32(?=;))/i],[[w,z]],[/((?:i[346]|x)86)[;\)]/i],[[w,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[w,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[w,"armhf"]],[/windows (ce|mobile); ppc;/i],[[w,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[w,/ower/,"",z]],[/(sun4\w)[;\)]/i],[[w,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[w,z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[p,[y,L],[g,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[p,[y,L],[g,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[p,[y,x],[g,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[p,[y,x],[g,_]],[/(macintosh);/i],[p,[y,x]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[p,[y,D],[g,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[p,[y,j],[g,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[p,[y,j],[g,v]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[p,/_/g," "],[y,H],[g,v]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[p,/_/g," "],[y,H],[g,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[p,[y,"OPPO"],[g,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[p,[y,"Vivo"],[g,v]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[p,[y,"Realme"],[g,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[p,[y,$],[g,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[p,[y,$],[g,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[p,[y,"LG"],[g,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[p,[y,"LG"],[g,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[p,[y,"Lenovo"],[g,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[p,/_/g," "],[y,"Nokia"],[g,v]],[/(pixel c)\b/i],[p,[y,I],[g,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[p,[y,I],[g,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[p,[y,M],[g,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[p,"Xperia Tablet"],[y,M],[g,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[p,[y,"OnePlus"],[g,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[p,[y,T],[g,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[p,/(.+)/g,"Fire Phone $1"],[y,T],[g,v]],[/(playbook);[-\w\),; ]+(rim)/i],[p,y,[g,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[p,[y,P],[g,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[p,[y,A],[g,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[p,[y,A],[g,v]],[/(nexus 9)/i],[p,[y,"HTC"],[g,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[y,[p,/_/g," "],[g,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[p,[y,"Acer"],[g,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[p,[y,"Meizu"],[g,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[y,p,[g,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[y,p,[g,_]],[/(surface duo)/i],[p,[y,U],[g,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[p,[y,"Fairphone"],[g,v]],[/(u304aa)/i],[p,[y,"AT&T"],[g,v]],[/\bsie-(\w*)/i],[p,[y,"Siemens"],[g,v]],[/\b(rct\w+) b/i],[p,[y,"RCA"],[g,_]],[/\b(venue[\d ]{2,7}) b/i],[p,[y,"Dell"],[g,_]],[/\b(q(?:mv|ta)\w+) b/i],[p,[y,"Verizon"],[g,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[p,[y,"Barnes & Noble"],[g,_]],[/\b(tm\d{3}\w+) b/i],[p,[y,"NuVision"],[g,_]],[/\b(k88) b/i],[p,[y,"ZTE"],[g,_]],[/\b(nx\d{3}j) b/i],[p,[y,"ZTE"],[g,v]],[/\b(gen\d{3}) b.+49h/i],[p,[y,"Swiss"],[g,v]],[/\b(zur\d{3}) b/i],[p,[y,"Swiss"],[g,_]],[/\b((zeki)?tb.*\b) b/i],[p,[y,"Zeki"],[g,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[y,"Dragon Touch"],p,[g,_]],[/\b(ns-?\w{0,9}) b/i],[p,[y,"Insignia"],[g,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[p,[y,"NextBook"],[g,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[y,"Voice"],p,[g,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[y,"LvTel"],p,[g,v]],[/\b(ph-1) /i],[p,[y,"Essential"],[g,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[p,[y,"Envizen"],[g,_]],[/\b(trio[-\w\. ]+) b/i],[p,[y,"MachSpeed"],[g,_]],[/\btu_(1491) b/i],[p,[y,"Rotor"],[g,_]],[/(shield[\w ]+) b/i],[p,[y,"Nvidia"],[g,_]],[/(sprint) (\w+)/i],[y,p,[g,v]],[/(kin\.[onetw]{3})/i],[[p,/\./g," "],[y,U],[g,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[p,[y,K],[g,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[p,[y,K],[g,v]],[/smart-tv.+(samsung)/i],[y,[g,S]],[/hbbtv.+maple;(\d+)/i],[[p,/^/,"SmartTV"],[y,L],[g,S]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[y,"LG"],[g,S]],[/(apple) ?tv/i],[y,[p,x+" TV"],[g,S]],[/crkey/i],[[p,O+"cast"],[y,I],[g,S]],[/droid.+aft(\w)( bui|\))/i],[p,[y,T],[g,S]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[p,[y,D],[g,S]],[/(bravia[\w ]+)( bui|\))/i],[p,[y,M],[g,S]],[/(mitv-\w{5}) bui/i],[p,[y,H],[g,S]],[/Hbbtv.*(technisat) (.*);/i],[y,p,[g,S]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[y,G],[p,G],[g,S]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[g,S]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[y,p,[g,b]],[/droid.+; (shield) bui/i],[p,[y,"Nvidia"],[g,b]],[/(playstation [345portablevi]+)/i],[p,[y,M],[g,b]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[p,[y,U],[g,b]],[/((pebble))app/i],[y,p,[g,k]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[p,[y,x],[g,k]],[/droid.+; (glass) \d/i],[p,[y,I],[g,k]],[/droid.+; (wt63?0{2,3})\)/i],[p,[y,K],[g,k]],[/(quest( 2| pro)?)/i],[p,[y,W],[g,k]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[y,[g,E]],[/(aeobc)\b/i],[p,[y,T],[g,E]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[p,[g,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[p,[g,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[g,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[g,v]],[/(android[-\w\. ]{0,9});.+buil/i],[p,[y,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[f,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,m],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[f,[m,Y,Z]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,"Windows"],[m,Y,Z]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,q],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,m],[/\(bb(10);/i],[m,[f,P]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[f,R+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[f,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[f,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[f,O+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[f,B],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,m],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[f,m]]},ee=function(e,t){if(typeof e===u&&(t=e,e=o),!(this instanceof ee))return new ee(e,t).getResult();var r=typeof s!==c&&s.navigator?s.navigator:o,n=e||(r&&r.userAgent?r.userAgent:""),i=r&&r.userAgentData?r.userAgentData:o,a=t?J(Q,t):Q,b=r&&r.userAgent==n;return this.getBrowser=function(){var e,t={};return t[f]=o,t[m]=o,X.call(t,n,a.browser),t[h]=typeof(e=t[m])===d?e.replace(/[^\d\.]/g,"").split(".")[0]:o,b&&r&&r.brave&&typeof r.brave.isBrave==l&&(t[f]="Brave"),t},this.getCPU=function(){var e={};return e[w]=o,X.call(e,n,a.cpu),e},this.getDevice=function(){var e={};return e[y]=o,e[p]=o,e[g]=o,X.call(e,n,a.device),b&&!e[g]&&i&&i.mobile&&(e[g]=v),b&&"Macintosh"==e[p]&&r&&typeof r.standalone!==c&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[p]="iPad",e[g]=_),e},this.getEngine=function(){var e={};return e[f]=o,e[m]=o,X.call(e,n,a.engine),e},this.getOS=function(){var e={};return e[f]=o,e[m]=o,X.call(e,n,a.os),b&&!e[f]&&i&&"Unknown"!=i.platform&&(e[f]=i.platform.replace(/chrome os/i,B).replace(/macos/i,q)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===d&&e.length>350?G(e,350):e,this},this.setUA(n),this};ee.VERSION="1.0.35",ee.BROWSER=V([f,m,h]),ee.CPU=V([w]),ee.DEVICE=V([p,y,g,b,v,S,_,k,E]),ee.ENGINE=ee.OS=V([f,m]),typeof a!==c?(i.exports&&(a=i.exports=ee),a.UAParser=ee):r.amdO?void 0!==(n=(function(){return ee}).call(t,r,t,e))&&(e.exports=n):typeof s!==c&&(s.UAParser=ee);var et=typeof s!==c&&(s.jQuery||s.Zepto);if(et&&!et.ua){var er=new ee;et.ua=er.getResult(),et.ua.get=function(){return er.getUA()},et.ua.set=function(e){er.setUA(e);var t=er.getResult();for(var r in t)et.ua[r]=t[r]}}}("object"==typeof window?window:this)}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}},n=!0;try{i[e].call(r.exports,r,r.exports,s),n=!1}finally{n&&delete a[e]}return r.exports}s.ab="//";var o=s(226);e.exports=o})()},686:(e,t,r)=>{"use strict";r.r(t),r.d(t,{bailoutToClientRendering:()=>a});class n extends Error{constructor(e){super("Bail out to client-side rendering: "+e),this.reason=e,this.digest="BAILOUT_TO_CLIENT_SIDE_RENDERING"}}var i=r(285);function a(e){let t=i.A.getStore();if((null==t||!t.forceStatic)&&(null==t?void 0:t.isStaticGeneration))throw new n(e)}},285:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(151).P)()},253:e=>{"use strict";e.exports=["chrome 64","edge 79","firefox 67","opera 51","safari 12"]},122:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{withRequest:function(){return a},getTestReqInfo:function(){return s}});let n=new(r(67)).AsyncLocalStorage;function i(e,t){let r=t.header(e,"next-test-proxy-port");if(r)return{url:t.url(e),proxyPort:Number(r),testData:t.header(e,"next-test-data")||""}}function a(e,t,r){let a=i(e,t);return a?n.run(a,r):r()}function s(e,t){return n.getStore()||(e&&t?i(e,t):void 0)}},131:(e,t,r)=>{"use strict";var n=r(195).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{reader:function(){return a},handleFetch:function(){return o},interceptFetch:function(){return l}});let i=r(122),a={url:e=>e.url,header:(e,t)=>e.headers.get(t)};async function s(e,t){let{url:r,method:i,headers:a,body:s,cache:o,credentials:l,integrity:c,mode:u,redirect:d,referrer:h,referrerPolicy:p}=t;return{testData:e,api:"fetch",request:{url:r,method:i,headers:[...Array.from(a),["next-test-stack",function(){let e=(Error().stack??"").split("\n");for(let t=1;t<e.length;t++)if(e[t].length>0){e=e.slice(t);break}return(e=(e=(e=e.filter(e=>!e.includes("/next/dist/"))).slice(0,5)).map(e=>e.replace("webpack-internal:///(rsc)/","").trim())).join("    ")}()]],body:s?n.from(await t.arrayBuffer()).toString("base64"):null,cache:o,credentials:l,integrity:c,mode:u,redirect:d,referrer:h,referrerPolicy:p}}}async function o(e,t){let r=(0,i.getTestReqInfo)(t,a);if(!r)throw Error(`No test info for ${t.method} ${t.url}`);let{testData:o,proxyPort:l}=r,c=await s(o,t),u=await e(`http://localhost:${l}`,{method:"POST",body:JSON.stringify(c),next:{internal:!0}});if(!u.ok)throw Error(`Proxy request failed: ${u.status}`);let d=await u.json(),{api:h}=d;switch(h){case"continue":return e(t);case"abort":case"unhandled":throw Error(`Proxy request aborted [${t.method} ${t.url}]`)}return function(e){let{status:t,headers:r,body:i}=e.response;return new Response(i?n.from(i,"base64"):null,{status:t,headers:new Headers(r)})}(d)}function l(e){return r.g.fetch=function(t,r){var n;return(null==r?void 0:null==(n=r.next)?void 0:n.internal)?e(t,r):o(e,new Request(t,r))},()=>{r.g.fetch=e}}},895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{interceptTestApis:function(){return a},wrapRequestHandler:function(){return s}});let n=r(122),i=r(131);function a(){return(0,i.interceptFetch)(r.g.fetch)}function s(e){return(t,r)=>(0,n.withRequest)(t,i.reader,()=>e(t,r))}},255:(e,t)=>{"use strict";/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,y={};function m(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||f}function w(){}function b(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||f}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=m.prototype;var v=b.prototype=new w;v.constructor=b,g(v,m.prototype),v.isPureReactComponent=!0;var _=Array.isArray,S=Object.prototype.hasOwnProperty,k={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,n){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)S.call(t,i)&&!E.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:r,type:e,key:s,ref:o,props:a,_owner:k.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var A=/\/+/g;function P(e,t){var r,n;return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36)}function C(e,t,i){if(null==e)return e;var a=[],s=0;return!function e(t,i,a,s,o){var l,c,u,d=typeof t;("undefined"===d||"boolean"===d)&&(t=null);var h=!1;if(null===t)h=!0;else switch(d){case"string":case"number":h=!0;break;case"object":switch(t.$$typeof){case r:case n:h=!0}}if(h)return o=o(h=t),t=""===s?"."+P(h,0):s,_(o)?(a="",null!=t&&(a=t.replace(A,"$&/")+"/"),e(o,i,a,"",function(e){return e})):null!=o&&(x(o)&&(l=o,c=a+(!o.key||h&&h.key===o.key?"":(""+o.key).replace(A,"$&/")+"/")+t,o={$$typeof:r,type:l.type,key:c,ref:l.ref,props:l.props,_owner:l._owner}),i.push(o)),1;if(h=0,s=""===s?".":s+":",_(t))for(var f=0;f<t.length;f++){var g=s+P(d=t[f],f);h+=e(d,i,a,g,o)}else if("function"==typeof(g=null===(u=t)||"object"!=typeof u?null:"function"==typeof(u=p&&u[p]||u["@@iterator"])?u:null))for(t=g.call(t),f=0;!(d=t.next()).done;)g=s+P(d=d.value,f++),h+=e(d,i,a,g,o);else if("object"===d)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(i=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return h}(e,a,"","",function(e){return t.call(i,e,s++)}),a}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},I={transition:null};t.Children={map:C,forEach:function(e,t,r){C(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return C(e,function(){t++}),t},toArray:function(e){return C(e,function(e){return e})||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:I,ReactCurrentOwner:k},t.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:r,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,r){return R.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,r){return R.current.useReducer(e,t,r)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return R.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},211:(e,t,r)=>{"use strict";e.exports=r(255)},576:e=>{"use strict";e.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},151:(e,t,r)=>{"use strict";r.d(t,{P:()=>s});let n=Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available");class i{disable(){throw n}getStore(){}run(){throw n}exit(){throw n}enterWith(){throw n}}let a=globalThis.AsyncLocalStorage;function s(){return a?new a:new i}}},e=>{var t=e(e.s=803);(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES).middleware_middleware=t}]);
//# sourceMappingURL=middleware.js.map